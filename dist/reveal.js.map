{"version":3,"file":"reveal.js","sources":["../js/utils/util.js","../js/utils/device.js","../node_modules/fitty/dist/fitty.module.js","../js/controllers/slidecontent.js","../js/controllers/slidenumber.js","../js/controllers/jumptoslide.js","../js/utils/color.js","../js/controllers/backgrounds.js","../js/utils/constants.js","../js/controllers/autoanimate.js","../js/controllers/fragments.js","../js/controllers/overview.js","../js/controllers/keyboard.js","../js/controllers/location.js","../js/controllers/controls.js","../js/controllers/progress.js","../js/controllers/pointer.js","../js/utils/loader.js","../js/controllers/plugins.js","../js/controllers/print.js","../js/controllers/touch.js","../js/controllers/focus.js","../js/controllers/notes.js","../js/components/playback.js","../js/config.js","../js/reveal.js","../node_modules/@firebase/util/dist/index.esm2017.js","../node_modules/@firebase/component/dist/esm/index.esm2017.js","../node_modules/@firebase/logger/dist/esm/index.esm2017.js","../node_modules/idb/build/wrap-idb-value.js","../node_modules/idb/build/index.js","../node_modules/@firebase/app/dist/esm/index.esm2017.js","../node_modules/firebase/app/dist/esm/index.esm.js","../node_modules/@firebase/installations/node_modules/idb/build/wrap-idb-value.js","../node_modules/@firebase/installations/node_modules/idb/build/index.js","../node_modules/@firebase/installations/dist/esm/index.esm2017.js","../node_modules/@firebase/analytics/dist/esm/index.esm2017.js","../js/index.js"],"sourcesContent":["/**\n * Extend object a with the properties of object b.\n * If there's a conflict, object b takes precedence.\n *\n * @param {object} a\n * @param {object} b\n */\nexport const extend = ( a, b ) => {\n\n\tfor( let i in b ) {\n\t\ta[ i ] = b[ i ];\n\t}\n\n\treturn a;\n\n}\n\n/**\n * querySelectorAll but returns an Array.\n */\nexport const queryAll = ( el, selector ) => {\n\n\treturn Array.from( el.querySelectorAll( selector ) );\n\n}\n\n/**\n * classList.toggle() with cross browser support\n */\nexport const toggleClass = ( el, className, value ) => {\n\tif( value ) {\n\t\tel.classList.add( className );\n\t}\n\telse {\n\t\tel.classList.remove( className );\n\t}\n}\n\n/**\n * Utility for deserializing a value.\n *\n * @param {*} value\n * @return {*}\n */\nexport const deserialize = ( value ) => {\n\n\tif( typeof value === 'string' ) {\n\t\tif( value === 'null' ) return null;\n\t\telse if( value === 'true' ) return true;\n\t\telse if( value === 'false' ) return false;\n\t\telse if( value.match( /^-?[\\d\\.]+$/ ) ) return parseFloat( value );\n\t}\n\n\treturn value;\n\n}\n\n/**\n * Measures the distance in pixels between point a\n * and point b.\n *\n * @param {object} a point with x/y properties\n * @param {object} b point with x/y properties\n *\n * @return {number}\n */\nexport const distanceBetween = ( a, b ) => {\n\n\tlet dx = a.x - b.x,\n\t\tdy = a.y - b.y;\n\n\treturn Math.sqrt( dx*dx + dy*dy );\n\n}\n\n/**\n * Applies a CSS transform to the target element.\n *\n * @param {HTMLElement} element\n * @param {string} transform\n */\nexport const transformElement = ( element, transform ) => {\n\n\telement.style.transform = transform;\n\n}\n\n/**\n * Element.matches with IE support.\n *\n * @param {HTMLElement} target The element to match\n * @param {String} selector The CSS selector to match\n * the element against\n *\n * @return {Boolean}\n */\nexport const matches = ( target, selector ) => {\n\n\tlet matchesMethod = target.matches || target.matchesSelector || target.msMatchesSelector;\n\n\treturn !!( matchesMethod && matchesMethod.call( target, selector ) );\n\n}\n\n/**\n * Find the closest parent that matches the given\n * selector.\n *\n * @param {HTMLElement} target The child element\n * @param {String} selector The CSS selector to match\n * the parents against\n *\n * @return {HTMLElement} The matched parent or null\n * if no matching parent was found\n */\nexport const closest = ( target, selector ) => {\n\n\t// Native Element.closest\n\tif( typeof target.closest === 'function' ) {\n\t\treturn target.closest( selector );\n\t}\n\n\t// Polyfill\n\twhile( target ) {\n\t\tif( matches( target, selector ) ) {\n\t\t\treturn target;\n\t\t}\n\n\t\t// Keep searching\n\t\ttarget = target.parentNode;\n\t}\n\n\treturn null;\n\n}\n\n/**\n * Handling the fullscreen functionality via the fullscreen API\n *\n * @see http://fullscreen.spec.whatwg.org/\n * @see https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode\n */\nexport const enterFullscreen = element => {\n\n\telement = element || document.documentElement;\n\n\t// Check which implementation is available\n\tlet requestMethod = element.requestFullscreen ||\n\t\t\t\t\t\telement.webkitRequestFullscreen ||\n\t\t\t\t\t\telement.webkitRequestFullScreen ||\n\t\t\t\t\t\telement.mozRequestFullScreen ||\n\t\t\t\t\t\telement.msRequestFullscreen;\n\n\tif( requestMethod ) {\n\t\trequestMethod.apply( element );\n\t}\n\n}\n\n/**\n * Creates an HTML element and returns a reference to it.\n * If the element already exists the existing instance will\n * be returned.\n *\n * @param {HTMLElement} container\n * @param {string} tagname\n * @param {string} classname\n * @param {string} innerHTML\n *\n * @return {HTMLElement}\n */\nexport const createSingletonNode = ( container, tagname, classname, innerHTML='' ) => {\n\n\t// Find all nodes matching the description\n\tlet nodes = container.querySelectorAll( '.' + classname );\n\n\t// Check all matches to find one which is a direct child of\n\t// the specified container\n\tfor( let i = 0; i < nodes.length; i++ ) {\n\t\tlet testNode = nodes[i];\n\t\tif( testNode.parentNode === container ) {\n\t\t\treturn testNode;\n\t\t}\n\t}\n\n\t// If no node was found, create it now\n\tlet node = document.createElement( tagname );\n\tnode.className = classname;\n\tnode.innerHTML = innerHTML;\n\tcontainer.appendChild( node );\n\n\treturn node;\n\n}\n\n/**\n * Injects the given CSS styles into the DOM.\n *\n * @param {string} value\n */\nexport const createStyleSheet = ( value ) => {\n\n\tlet tag = document.createElement( 'style' );\n\ttag.type = 'text/css';\n\n\tif( value && value.length > 0 ) {\n\t\tif( tag.styleSheet ) {\n\t\t\ttag.styleSheet.cssText = value;\n\t\t}\n\t\telse {\n\t\t\ttag.appendChild( document.createTextNode( value ) );\n\t\t}\n\t}\n\n\tdocument.head.appendChild( tag );\n\n\treturn tag;\n\n}\n\n/**\n * Returns a key:value hash of all query params.\n */\nexport const getQueryHash = () => {\n\n\tlet query = {};\n\n\tlocation.search.replace( /[A-Z0-9]+?=([\\w\\.%-]*)/gi, a => {\n\t\tquery[ a.split( '=' ).shift() ] = a.split( '=' ).pop();\n\t} );\n\n\t// Basic deserialization\n\tfor( let i in query ) {\n\t\tlet value = query[ i ];\n\n\t\tquery[ i ] = deserialize( unescape( value ) );\n\t}\n\n\t// Do not accept new dependencies via query config to avoid\n\t// the potential of malicious script injection\n\tif( typeof query['dependencies'] !== 'undefined' ) delete query['dependencies'];\n\n\treturn query;\n\n}\n\n/**\n * Returns the remaining height within the parent of the\n * target element.\n *\n * remaining height = [ configured parent height ] - [ current parent height ]\n *\n * @param {HTMLElement} element\n * @param {number} [height]\n */\nexport const getRemainingHeight = ( element, height = 0 ) => {\n\n\tif( element ) {\n\t\tlet newHeight, oldHeight = element.style.height;\n\n\t\t// Change the .stretch element height to 0 in order find the height of all\n\t\t// the other elements\n\t\telement.style.height = '0px';\n\n\t\t// In Overview mode, the parent (.slide) height is set of 700px.\n\t\t// Restore it temporarily to its natural height.\n\t\telement.parentNode.style.height = 'auto';\n\n\t\tnewHeight = height - element.parentNode.offsetHeight;\n\n\t\t// Restore the old height, just in case\n\t\telement.style.height = oldHeight + 'px';\n\n\t\t// Clear the parent (.slide) height. .removeProperty works in IE9+\n\t\telement.parentNode.style.removeProperty('height');\n\n\t\treturn newHeight;\n\t}\n\n\treturn height;\n\n}\n\nconst fileExtensionToMimeMap = {\n\t'mp4': 'video/mp4',\n\t'm4a': 'video/mp4',\n\t'ogv': 'video/ogg',\n\t'mpeg': 'video/mpeg',\n\t'webm': 'video/webm'\n}\n\n/**\n * Guess the MIME type for common file formats.\n */\nexport const getMimeTypeFromFile = ( filename='' ) => {\n\treturn fileExtensionToMimeMap[filename.split('.').pop()]\n}\n\n/**\n * Encodes a string for RFC3986-compliant URL format.\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/encodeURI#encoding_for_rfc3986\n *\n * @param {string} url\n */\nexport const encodeRFC3986URI = ( url='' ) => {\n\treturn encodeURI(url)\n\t  .replace(/%5B/g, \"[\")\n\t  .replace(/%5D/g, \"]\")\n\t  .replace(\n\t\t/[!'()*]/g,\n\t\t(c) => `%${c.charCodeAt(0).toString(16).toUpperCase()}`\n\t  );\n}","const UA = navigator.userAgent;\n\nexport const isMobile = /(iphone|ipod|ipad|android)/gi.test( UA ) ||\n\t\t\t\t\t\t( navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1 ); // iPadOS\n\nexport const isChrome = /chrome/i.test( UA ) && !/edge/i.test( UA );\n\nexport const isAndroid = /android/gi.test( UA );","/*\n * fitty v2.3.3 - Snugly resizes text to fit its parent container\n * Copyright (c) 2020 Rik Schennink <rik@pqina.nl> (https://pqina.nl/)\n */\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = function (w) {\n\n  // no window, early exit\n  if (!w) return;\n\n  // node list to array helper method\n  var toArray = function toArray(nl) {\n    return [].slice.call(nl);\n  };\n\n  // states\n  var DrawState = {\n    IDLE: 0,\n    DIRTY_CONTENT: 1,\n    DIRTY_LAYOUT: 2,\n    DIRTY: 3\n  };\n\n  // all active fitty elements\n  var fitties = [];\n\n  // group all redraw calls till next frame, we cancel each frame request when a new one comes in. If no support for request animation frame, this is an empty function and supports for fitty stops.\n  var redrawFrame = null;\n  var requestRedraw = 'requestAnimationFrame' in w ? function () {\n    w.cancelAnimationFrame(redrawFrame);\n    redrawFrame = w.requestAnimationFrame(function () {\n      return redraw(fitties.filter(function (f) {\n        return f.dirty && f.active;\n      }));\n    });\n  } : function () {};\n\n  // sets all fitties to dirty so they are redrawn on the next redraw loop, then calls redraw\n  var redrawAll = function redrawAll(type) {\n    return function () {\n      fitties.forEach(function (f) {\n        return f.dirty = type;\n      });\n      requestRedraw();\n    };\n  };\n\n  // redraws fitties so they nicely fit their parent container\n  var redraw = function redraw(fitties) {\n\n    // getting info from the DOM at this point should not trigger a reflow, let's gather as much intel as possible before triggering a reflow\n\n    // check if styles of all fitties have been computed\n    fitties.filter(function (f) {\n      return !f.styleComputed;\n    }).forEach(function (f) {\n      f.styleComputed = computeStyle(f);\n    });\n\n    // restyle elements that require pre-styling, this triggers a reflow, please try to prevent by adding CSS rules (see docs)\n    fitties.filter(shouldPreStyle).forEach(applyStyle);\n\n    // we now determine which fitties should be redrawn\n    var fittiesToRedraw = fitties.filter(shouldRedraw);\n\n    // we calculate final styles for these fitties\n    fittiesToRedraw.forEach(calculateStyles);\n\n    // now we apply the calculated styles from our previous loop\n    fittiesToRedraw.forEach(function (f) {\n      applyStyle(f);\n      markAsClean(f);\n    });\n\n    // now we dispatch events for all restyled fitties\n    fittiesToRedraw.forEach(dispatchFitEvent);\n  };\n\n  var markAsClean = function markAsClean(f) {\n    return f.dirty = DrawState.IDLE;\n  };\n\n  var calculateStyles = function calculateStyles(f) {\n\n    // get available width from parent node\n    f.availableWidth = f.element.parentNode.clientWidth;\n\n    // the space our target element uses\n    f.currentWidth = f.element.scrollWidth;\n\n    // remember current font size\n    f.previousFontSize = f.currentFontSize;\n\n    // let's calculate the new font size\n    f.currentFontSize = Math.min(Math.max(f.minSize, f.availableWidth / f.currentWidth * f.previousFontSize), f.maxSize);\n\n    // if allows wrapping, only wrap when at minimum font size (otherwise would break container)\n    f.whiteSpace = f.multiLine && f.currentFontSize === f.minSize ? 'normal' : 'nowrap';\n  };\n\n  // should always redraw if is not dirty layout, if is dirty layout, only redraw if size has changed\n  var shouldRedraw = function shouldRedraw(f) {\n    return f.dirty !== DrawState.DIRTY_LAYOUT || f.dirty === DrawState.DIRTY_LAYOUT && f.element.parentNode.clientWidth !== f.availableWidth;\n  };\n\n  // every fitty element is tested for invalid styles\n  var computeStyle = function computeStyle(f) {\n\n    // get style properties\n    var style = w.getComputedStyle(f.element, null);\n\n    // get current font size in pixels (if we already calculated it, use the calculated version)\n    f.currentFontSize = parseFloat(style.getPropertyValue('font-size'));\n\n    // get display type and wrap mode\n    f.display = style.getPropertyValue('display');\n    f.whiteSpace = style.getPropertyValue('white-space');\n  };\n\n  // determines if this fitty requires initial styling, can be prevented by applying correct styles through CSS\n  var shouldPreStyle = function shouldPreStyle(f) {\n\n    var preStyle = false;\n\n    // if we already tested for prestyling we don't have to do it again\n    if (f.preStyleTestCompleted) return false;\n\n    // should have an inline style, if not, apply\n    if (!/inline-/.test(f.display)) {\n      preStyle = true;\n      f.display = 'inline-block';\n    }\n\n    // to correctly calculate dimensions the element should have whiteSpace set to nowrap\n    if (f.whiteSpace !== 'nowrap') {\n      preStyle = true;\n      f.whiteSpace = 'nowrap';\n    }\n\n    // we don't have to do this twice\n    f.preStyleTestCompleted = true;\n\n    return preStyle;\n  };\n\n  // apply styles to single fitty\n  var applyStyle = function applyStyle(f) {\n    f.element.style.whiteSpace = f.whiteSpace;\n    f.element.style.display = f.display;\n    f.element.style.fontSize = f.currentFontSize + 'px';\n  };\n\n  // dispatch a fit event on a fitty\n  var dispatchFitEvent = function dispatchFitEvent(f) {\n    f.element.dispatchEvent(new CustomEvent('fit', {\n      detail: {\n        oldValue: f.previousFontSize,\n        newValue: f.currentFontSize,\n        scaleFactor: f.currentFontSize / f.previousFontSize\n      }\n    }));\n  };\n\n  // fit method, marks the fitty as dirty and requests a redraw (this will also redraw any other fitty marked as dirty)\n  var fit = function fit(f, type) {\n    return function () {\n      f.dirty = type;\n      if (!f.active) return;\n      requestRedraw();\n    };\n  };\n\n  var init = function init(f) {\n\n    // save some of the original CSS properties before we change them\n    f.originalStyle = {\n      whiteSpace: f.element.style.whiteSpace,\n      display: f.element.style.display,\n      fontSize: f.element.style.fontSize\n    };\n\n    // should we observe DOM mutations\n    observeMutations(f);\n\n    // this is a new fitty so we need to validate if it's styles are in order\n    f.newbie = true;\n\n    // because it's a new fitty it should also be dirty, we want it to redraw on the first loop\n    f.dirty = true;\n\n    // we want to be able to update this fitty\n    fitties.push(f);\n  };\n\n  var destroy = function destroy(f) {\n    return function () {\n\n      // remove from fitties array\n      fitties = fitties.filter(function (_) {\n        return _.element !== f.element;\n      });\n\n      // stop observing DOM\n      if (f.observeMutations) f.observer.disconnect();\n\n      // reset the CSS properties we changes\n      f.element.style.whiteSpace = f.originalStyle.whiteSpace;\n      f.element.style.display = f.originalStyle.display;\n      f.element.style.fontSize = f.originalStyle.fontSize;\n    };\n  };\n\n  // add a new fitty, does not redraw said fitty\n  var subscribe = function subscribe(f) {\n    return function () {\n      if (f.active) return;\n      f.active = true;\n      requestRedraw();\n    };\n  };\n\n  // remove an existing fitty\n  var unsubscribe = function unsubscribe(f) {\n    return function () {\n      return f.active = false;\n    };\n  };\n\n  var observeMutations = function observeMutations(f) {\n\n    // no observing?\n    if (!f.observeMutations) return;\n\n    // start observing mutations\n    f.observer = new MutationObserver(fit(f, DrawState.DIRTY_CONTENT));\n\n    // start observing\n    f.observer.observe(f.element, f.observeMutations);\n  };\n\n  // default mutation observer settings\n  var mutationObserverDefaultSetting = {\n    subtree: true,\n    childList: true,\n    characterData: true\n  };\n\n  // default fitty options\n  var defaultOptions = {\n    minSize: 16,\n    maxSize: 512,\n    multiLine: true,\n    observeMutations: 'MutationObserver' in w ? mutationObserverDefaultSetting : false\n  };\n\n  // array of elements in, fitty instances out\n  function fittyCreate(elements, options) {\n\n    // set options object\n    var fittyOptions = _extends({}, defaultOptions, options);\n\n    // create fitties\n    var publicFitties = elements.map(function (element) {\n\n      // create fitty instance\n      var f = _extends({}, fittyOptions, {\n\n        // internal options for this fitty\n        element: element,\n        active: true\n      });\n\n      // initialise this fitty\n      init(f);\n\n      // expose API\n      return {\n        element: element,\n        fit: fit(f, DrawState.DIRTY),\n        unfreeze: subscribe(f),\n        freeze: unsubscribe(f),\n        unsubscribe: destroy(f)\n      };\n    });\n\n    // call redraw on newly initiated fitties\n    requestRedraw();\n\n    // expose fitties\n    return publicFitties;\n  }\n\n  // fitty creation function\n  function fitty(target) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    // if target is a string\n    return typeof target === 'string' ?\n\n    // treat it as a querySelector\n    fittyCreate(toArray(document.querySelectorAll(target)), options) :\n\n    // create single fitty\n    fittyCreate([target], options)[0];\n  }\n\n  // handles viewport changes, redraws all fitties, but only does so after a timeout\n  var resizeDebounce = null;\n  var onWindowResized = function onWindowResized() {\n    w.clearTimeout(resizeDebounce);\n    resizeDebounce = w.setTimeout(redrawAll(DrawState.DIRTY_LAYOUT), fitty.observeWindowDelay);\n  };\n\n  // define observe window property, so when we set it to true or false events are automatically added and removed\n  var events = ['resize', 'orientationchange'];\n  Object.defineProperty(fitty, 'observeWindow', {\n    set: function set(enabled) {\n      var method = (enabled ? 'add' : 'remove') + 'EventListener';\n      events.forEach(function (e) {\n        w[method](e, onWindowResized);\n      });\n    }\n  });\n\n  // fitty global properties (by setting observeWindow to true the events above get added)\n  fitty.observeWindow = true;\n  fitty.observeWindowDelay = 100;\n\n  // public fit all method, will force redraw no matter what\n  fitty.fitAll = redrawAll(DrawState.DIRTY);\n\n  // export our fitty function, we don't want to keep it to our selves\n  return fitty;\n}(typeof window === 'undefined' ? null : window);","import { extend, queryAll, closest, getMimeTypeFromFile, encodeRFC3986URI } from '../utils/util.js'\nimport { isMobile } from '../utils/device.js'\n\nimport fitty from 'fitty';\n\n/**\n * Handles loading, unloading and playback of slide\n * content such as images, videos and iframes.\n */\nexport default class SlideContent {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\tthis.startEmbeddedIframe = this.startEmbeddedIframe.bind( this );\n\n\t}\n\n\t/**\n\t * Should the given element be preloaded?\n\t * Decides based on local element attributes and global config.\n\t *\n\t * @param {HTMLElement} element\n\t */\n\tshouldPreload( element ) {\n\n\t\t// Prefer an explicit global preload setting\n\t\tlet preload = this.Reveal.getConfig().preloadIframes;\n\n\t\t// If no global setting is available, fall back on the element's\n\t\t// own preload setting\n\t\tif( typeof preload !== 'boolean' ) {\n\t\t\tpreload = element.hasAttribute( 'data-preload' );\n\t\t}\n\n\t\treturn preload;\n\t}\n\n\t/**\n\t * Called when the given slide is within the configured view\n\t * distance. Shows the slide element and loads any content\n\t * that is set to load lazily (data-src).\n\t *\n\t * @param {HTMLElement} slide Slide to show\n\t */\n\tload( slide, options = {} ) {\n\n\t\t// Show the slide element\n\t\tslide.style.display = this.Reveal.getConfig().display;\n\n\t\t// Media elements with data-src attributes\n\t\tqueryAll( slide, 'img[data-src], video[data-src], audio[data-src], iframe[data-src]' ).forEach( element => {\n\t\t\tif( element.tagName !== 'IFRAME' || this.shouldPreload( element ) ) {\n\t\t\t\telement.setAttribute( 'src', element.getAttribute( 'data-src' ) );\n\t\t\t\telement.setAttribute( 'data-lazy-loaded', '' );\n\t\t\t\telement.removeAttribute( 'data-src' );\n\t\t\t}\n\t\t} );\n\n\t\t// Media elements with <source> children\n\t\tqueryAll( slide, 'video, audio' ).forEach( media => {\n\t\t\tlet sources = 0;\n\n\t\t\tqueryAll( media, 'source[data-src]' ).forEach( source => {\n\t\t\t\tsource.setAttribute( 'src', source.getAttribute( 'data-src' ) );\n\t\t\t\tsource.removeAttribute( 'data-src' );\n\t\t\t\tsource.setAttribute( 'data-lazy-loaded', '' );\n\t\t\t\tsources += 1;\n\t\t\t} );\n\n\t\t\t// Enable inline video playback in mobile Safari\n\t\t\tif( isMobile && media.tagName === 'VIDEO' ) {\n\t\t\t\tmedia.setAttribute( 'playsinline', '' );\n\t\t\t}\n\n\t\t\t// If we rewrote sources for this video/audio element, we need\n\t\t\t// to manually tell it to load from its new origin\n\t\t\tif( sources > 0 ) {\n\t\t\t\tmedia.load();\n\t\t\t}\n\t\t} );\n\n\n\t\t// Show the corresponding background element\n\t\tlet background = slide.slideBackgroundElement;\n\t\tif( background ) {\n\t\t\tbackground.style.display = 'block';\n\n\t\t\tlet backgroundContent = slide.slideBackgroundContentElement;\n\t\t\tlet backgroundIframe = slide.getAttribute( 'data-background-iframe' );\n\n\t\t\t// If the background contains media, load it\n\t\t\tif( background.hasAttribute( 'data-loaded' ) === false ) {\n\t\t\t\tbackground.setAttribute( 'data-loaded', 'true' );\n\n\t\t\t\tlet backgroundImage = slide.getAttribute( 'data-background-image' ),\n\t\t\t\t\tbackgroundVideo = slide.getAttribute( 'data-background-video' ),\n\t\t\t\t\tbackgroundVideoLoop = slide.hasAttribute( 'data-background-video-loop' ),\n\t\t\t\t\tbackgroundVideoMuted = slide.hasAttribute( 'data-background-video-muted' );\n\n\t\t\t\t// Images\n\t\t\t\tif( backgroundImage ) {\n\t\t\t\t\t// base64\n\t\t\t\t\tif(  /^data:/.test( backgroundImage.trim() ) ) {\n\t\t\t\t\t\tbackgroundContent.style.backgroundImage = `url(${backgroundImage.trim()})`;\n\t\t\t\t\t}\n\t\t\t\t\t// URL(s)\n\t\t\t\t\telse {\n\t\t\t\t\t\tbackgroundContent.style.backgroundImage = backgroundImage.split( ',' ).map( background => {\n\t\t\t\t\t\t\t// Decode URL(s) that are already encoded first\n\t\t\t\t\t\t\tlet decoded = decodeURI(background.trim());\n\t\t\t\t\t\t\treturn `url(${encodeRFC3986URI(decoded)})`;\n\t\t\t\t\t\t}).join( ',' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Videos\n\t\t\t\telse if ( backgroundVideo && !this.Reveal.isSpeakerNotes() ) {\n\t\t\t\t\tlet video = document.createElement( 'video' );\n\n\t\t\t\t\tif( backgroundVideoLoop ) {\n\t\t\t\t\t\tvideo.setAttribute( 'loop', '' );\n\t\t\t\t\t}\n\n\t\t\t\t\tif( backgroundVideoMuted ) {\n\t\t\t\t\t\tvideo.muted = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Enable inline playback in mobile Safari\n\t\t\t\t\t//\n\t\t\t\t\t// Mute is required for video to play when using\n\t\t\t\t\t// swipe gestures to navigate since they don't\n\t\t\t\t\t// count as direct user actions :'(\n\t\t\t\t\tif( isMobile ) {\n\t\t\t\t\t\tvideo.muted = true;\n\t\t\t\t\t\tvideo.setAttribute( 'playsinline', '' );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Support comma separated lists of video sources\n\t\t\t\t\tbackgroundVideo.split( ',' ).forEach( source => {\n\t\t\t\t\t\tlet type = getMimeTypeFromFile( source );\n\t\t\t\t\t\tif( type ) {\n\t\t\t\t\t\t\tvideo.innerHTML += `<source src=\"${source}\" type=\"${type}\">`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tvideo.innerHTML += `<source src=\"${source}\">`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t\tbackgroundContent.appendChild( video );\n\t\t\t\t}\n\t\t\t\t// Iframes\n\t\t\t\telse if( backgroundIframe && options.excludeIframes !== true ) {\n\t\t\t\t\tlet iframe = document.createElement( 'iframe' );\n\t\t\t\t\tiframe.setAttribute( 'allowfullscreen', '' );\n\t\t\t\t\tiframe.setAttribute( 'mozallowfullscreen', '' );\n\t\t\t\t\tiframe.setAttribute( 'webkitallowfullscreen', '' );\n\t\t\t\t\tiframe.setAttribute( 'allow', 'autoplay' );\n\n\t\t\t\t\tiframe.setAttribute( 'data-src', backgroundIframe );\n\n\t\t\t\t\tiframe.style.width  = '100%';\n\t\t\t\t\tiframe.style.height = '100%';\n\t\t\t\t\tiframe.style.maxHeight = '100%';\n\t\t\t\t\tiframe.style.maxWidth = '100%';\n\n\t\t\t\t\tbackgroundContent.appendChild( iframe );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Start loading preloadable iframes\n\t\t\tlet backgroundIframeElement = backgroundContent.querySelector( 'iframe[data-src]' );\n\t\t\tif( backgroundIframeElement ) {\n\n\t\t\t\t// Check if this iframe is eligible to be preloaded\n\t\t\t\tif( this.shouldPreload( background ) && !/autoplay=(1|true|yes)/gi.test( backgroundIframe ) ) {\n\t\t\t\t\tif( backgroundIframeElement.getAttribute( 'src' ) !== backgroundIframe ) {\n\t\t\t\t\t\tbackgroundIframeElement.setAttribute( 'src', backgroundIframe );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.layout( slide );\n\n\t}\n\n\t/**\n\t * Applies JS-dependent layout helpers for the scope.\n\t */\n\tlayout( scopeElement ) {\n\n\t\t// Autosize text with the r-fit-text class based on the\n\t\t// size of its container. This needs to happen after the\n\t\t// slide is visible in order to measure the text.\n\t\tArray.from( scopeElement.querySelectorAll( '.r-fit-text' ) ).forEach( element => {\n\t\t\tfitty( element, {\n\t\t\t\tminSize: 24,\n\t\t\t\tmaxSize: this.Reveal.getConfig().height * 0.8,\n\t\t\t\tobserveMutations: false,\n\t\t\t\tobserveWindow: false\n\t\t\t} );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Unloads and hides the given slide. This is called when the\n\t * slide is moved outside of the configured view distance.\n\t *\n\t * @param {HTMLElement} slide\n\t */\n\tunload( slide ) {\n\n\t\t// Hide the slide element\n\t\tslide.style.display = 'none';\n\n\t\t// Hide the corresponding background element\n\t\tlet background = this.Reveal.getSlideBackground( slide );\n\t\tif( background ) {\n\t\t\tbackground.style.display = 'none';\n\n\t\t\t// Unload any background iframes\n\t\t\tqueryAll( background, 'iframe[src]' ).forEach( element => {\n\t\t\t\telement.removeAttribute( 'src' );\n\t\t\t} );\n\t\t}\n\n\t\t// Reset lazy-loaded media elements with src attributes\n\t\tqueryAll( slide, 'video[data-lazy-loaded][src], audio[data-lazy-loaded][src], iframe[data-lazy-loaded][src]' ).forEach( element => {\n\t\t\telement.setAttribute( 'data-src', element.getAttribute( 'src' ) );\n\t\t\telement.removeAttribute( 'src' );\n\t\t} );\n\n\t\t// Reset lazy-loaded media elements with <source> children\n\t\tqueryAll( slide, 'video[data-lazy-loaded] source[src], audio source[src]' ).forEach( source => {\n\t\t\tsource.setAttribute( 'data-src', source.getAttribute( 'src' ) );\n\t\t\tsource.removeAttribute( 'src' );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Enforces origin-specific format rules for embedded media.\n\t */\n\tformatEmbeddedContent() {\n\n\t\tlet _appendParamToIframeSource = ( sourceAttribute, sourceURL, param ) => {\n\t\t\tqueryAll( this.Reveal.getSlidesElement(), 'iframe['+ sourceAttribute +'*=\"'+ sourceURL +'\"]' ).forEach( el => {\n\t\t\t\tlet src = el.getAttribute( sourceAttribute );\n\t\t\t\tif( src && src.indexOf( param ) === -1 ) {\n\t\t\t\t\tel.setAttribute( sourceAttribute, src + ( !/\\?/.test( src ) ? '?' : '&' ) + param );\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// YouTube frames must include \"?enablejsapi=1\"\n\t\t_appendParamToIframeSource( 'src', 'youtube.com/embed/', 'enablejsapi=1' );\n\t\t_appendParamToIframeSource( 'data-src', 'youtube.com/embed/', 'enablejsapi=1' );\n\n\t\t// Vimeo frames must include \"?api=1\"\n\t\t_appendParamToIframeSource( 'src', 'player.vimeo.com/', 'api=1' );\n\t\t_appendParamToIframeSource( 'data-src', 'player.vimeo.com/', 'api=1' );\n\n\t}\n\n\t/**\n\t * Start playback of any embedded content inside of\n\t * the given element.\n\t *\n\t * @param {HTMLElement} element\n\t */\n\tstartEmbeddedContent( element ) {\n\n\t\tif( element && !this.Reveal.isSpeakerNotes() ) {\n\n\t\t\t// Restart GIFs\n\t\t\tqueryAll( element, 'img[src$=\".gif\"]' ).forEach( el => {\n\t\t\t\t// Setting the same unchanged source like this was confirmed\n\t\t\t\t// to work in Chrome, FF & Safari\n\t\t\t\tel.setAttribute( 'src', el.getAttribute( 'src' ) );\n\t\t\t} );\n\n\t\t\t// HTML5 media elements\n\t\t\tqueryAll( element, 'video, audio' ).forEach( el => {\n\t\t\t\tif( closest( el, '.fragment' ) && !closest( el, '.fragment.visible' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Prefer an explicit global autoplay setting\n\t\t\t\tlet autoplay = this.Reveal.getConfig().autoPlayMedia;\n\n\t\t\t\t// If no global setting is available, fall back on the element's\n\t\t\t\t// own autoplay setting\n\t\t\t\tif( typeof autoplay !== 'boolean' ) {\n\t\t\t\t\tautoplay = el.hasAttribute( 'data-autoplay' ) || !!closest( el, '.slide-background' );\n\t\t\t\t}\n\n\t\t\t\tif( autoplay && typeof el.play === 'function' ) {\n\n\t\t\t\t\t// If the media is ready, start playback\n\t\t\t\t\tif( el.readyState > 1 ) {\n\t\t\t\t\t\tthis.startEmbeddedMedia( { target: el } );\n\t\t\t\t\t}\n\t\t\t\t\t// Mobile devices never fire a loaded event so instead\n\t\t\t\t\t// of waiting, we initiate playback\n\t\t\t\t\telse if( isMobile ) {\n\t\t\t\t\t\tlet promise = el.play();\n\n\t\t\t\t\t\t// If autoplay does not work, ensure that the controls are visible so\n\t\t\t\t\t\t// that the viewer can start the media on their own\n\t\t\t\t\t\tif( promise && typeof promise.catch === 'function' && el.controls === false ) {\n\t\t\t\t\t\t\tpromise.catch( () => {\n\t\t\t\t\t\t\t\tel.controls = true;\n\n\t\t\t\t\t\t\t\t// Once the video does start playing, hide the controls again\n\t\t\t\t\t\t\t\tel.addEventListener( 'play', () => {\n\t\t\t\t\t\t\t\t\tel.controls = false;\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// If the media isn't loaded, wait before playing\n\t\t\t\t\telse {\n\t\t\t\t\t\tel.removeEventListener( 'loadeddata', this.startEmbeddedMedia ); // remove first to avoid dupes\n\t\t\t\t\t\tel.addEventListener( 'loadeddata', this.startEmbeddedMedia );\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Normal iframes\n\t\t\tqueryAll( element, 'iframe[src]' ).forEach( el => {\n\t\t\t\tif( closest( el, '.fragment' ) && !closest( el, '.fragment.visible' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.startEmbeddedIframe( { target: el } );\n\t\t\t} );\n\n\t\t\t// Lazy loading iframes\n\t\t\tqueryAll( element, 'iframe[data-src]' ).forEach( el => {\n\t\t\t\tif( closest( el, '.fragment' ) && !closest( el, '.fragment.visible' ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif( el.getAttribute( 'src' ) !== el.getAttribute( 'data-src' ) ) {\n\t\t\t\t\tel.removeEventListener( 'load', this.startEmbeddedIframe ); // remove first to avoid dupes\n\t\t\t\t\tel.addEventListener( 'load', this.startEmbeddedIframe );\n\t\t\t\t\tel.setAttribute( 'src', el.getAttribute( 'data-src' ) );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Starts playing an embedded video/audio element after\n\t * it has finished loading.\n\t *\n\t * @param {object} event\n\t */\n\tstartEmbeddedMedia( event ) {\n\n\t\tlet isAttachedToDOM = !!closest( event.target, 'html' ),\n\t\t\tisVisible  \t\t= !!closest( event.target, '.present' );\n\n\t\tif( isAttachedToDOM && isVisible ) {\n\t\t\tevent.target.currentTime = 0;\n\t\t\tevent.target.play();\n\t\t}\n\n\t\tevent.target.removeEventListener( 'loadeddata', this.startEmbeddedMedia );\n\n\t}\n\n\t/**\n\t * \"Starts\" the content of an embedded iframe using the\n\t * postMessage API.\n\t *\n\t * @param {object} event\n\t */\n\tstartEmbeddedIframe( event ) {\n\n\t\tlet iframe = event.target;\n\n\t\tif( iframe && iframe.contentWindow ) {\n\n\t\t\tlet isAttachedToDOM = !!closest( event.target, 'html' ),\n\t\t\t\tisVisible  \t\t= !!closest( event.target, '.present' );\n\n\t\t\tif( isAttachedToDOM && isVisible ) {\n\n\t\t\t\t// Prefer an explicit global autoplay setting\n\t\t\t\tlet autoplay = this.Reveal.getConfig().autoPlayMedia;\n\n\t\t\t\t// If no global setting is available, fall back on the element's\n\t\t\t\t// own autoplay setting\n\t\t\t\tif( typeof autoplay !== 'boolean' ) {\n\t\t\t\t\tautoplay = iframe.hasAttribute( 'data-autoplay' ) || !!closest( iframe, '.slide-background' );\n\t\t\t\t}\n\n\t\t\t\t// YouTube postMessage API\n\t\t\t\tif( /youtube\\.com\\/embed\\//.test( iframe.getAttribute( 'src' ) ) && autoplay ) {\n\t\t\t\t\tiframe.contentWindow.postMessage( '{\"event\":\"command\",\"func\":\"playVideo\",\"args\":\"\"}', '*' );\n\t\t\t\t}\n\t\t\t\t// Vimeo postMessage API\n\t\t\t\telse if( /player\\.vimeo\\.com\\//.test( iframe.getAttribute( 'src' ) ) && autoplay ) {\n\t\t\t\t\tiframe.contentWindow.postMessage( '{\"method\":\"play\"}', '*' );\n\t\t\t\t}\n\t\t\t\t// Generic postMessage API\n\t\t\t\telse {\n\t\t\t\t\tiframe.contentWindow.postMessage( 'slide:start', '*' );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Stop playback of any embedded content inside of\n\t * the targeted slide.\n\t *\n\t * @param {HTMLElement} element\n\t */\n\tstopEmbeddedContent( element, options = {} ) {\n\n\t\toptions = extend( {\n\t\t\t// Defaults\n\t\t\tunloadIframes: true\n\t\t}, options );\n\n\t\tif( element && element.parentNode ) {\n\t\t\t// HTML5 media elements\n\t\t\tqueryAll( element, 'video, audio' ).forEach( el => {\n\t\t\t\tif( !el.hasAttribute( 'data-ignore' ) && typeof el.pause === 'function' ) {\n\t\t\t\t\tel.setAttribute('data-paused-by-reveal', '');\n\t\t\t\t\tel.pause();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Generic postMessage API for non-lazy loaded iframes\n\t\t\tqueryAll( element, 'iframe' ).forEach( el => {\n\t\t\t\tif( el.contentWindow ) el.contentWindow.postMessage( 'slide:stop', '*' );\n\t\t\t\tel.removeEventListener( 'load', this.startEmbeddedIframe );\n\t\t\t});\n\n\t\t\t// YouTube postMessage API\n\t\t\tqueryAll( element, 'iframe[src*=\"youtube.com/embed/\"]' ).forEach( el => {\n\t\t\t\tif( !el.hasAttribute( 'data-ignore' ) && el.contentWindow && typeof el.contentWindow.postMessage === 'function' ) {\n\t\t\t\t\tel.contentWindow.postMessage( '{\"event\":\"command\",\"func\":\"pauseVideo\",\"args\":\"\"}', '*' );\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Vimeo postMessage API\n\t\t\tqueryAll( element, 'iframe[src*=\"player.vimeo.com/\"]' ).forEach( el => {\n\t\t\t\tif( !el.hasAttribute( 'data-ignore' ) && el.contentWindow && typeof el.contentWindow.postMessage === 'function' ) {\n\t\t\t\t\tel.contentWindow.postMessage( '{\"method\":\"pause\"}', '*' );\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif( options.unloadIframes === true ) {\n\t\t\t\t// Unload lazy-loaded iframes\n\t\t\t\tqueryAll( element, 'iframe[data-src]' ).forEach( el => {\n\t\t\t\t\t// Only removing the src doesn't actually unload the frame\n\t\t\t\t\t// in all browsers (Firefox) so we set it to blank first\n\t\t\t\t\tel.setAttribute( 'src', 'about:blank' );\n\t\t\t\t\tel.removeAttribute( 'src' );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t}\n\n}\n","/**\n * Handles the display of reveal.js' optional slide number.\n */\nexport default class SlideNumber {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t}\n\n\trender() {\n\n\t\tthis.element = document.createElement( 'div' );\n\t\tthis.element.className = 'slide-number';\n\t\tthis.Reveal.getRevealElement().appendChild( this.element );\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tlet slideNumberDisplay = 'none';\n\t\tif( config.slideNumber && !this.Reveal.isPrintingPDF() ) {\n\t\t\tif( config.showSlideNumber === 'all' ) {\n\t\t\t\tslideNumberDisplay = 'block';\n\t\t\t}\n\t\t\telse if( config.showSlideNumber === 'speaker' && this.Reveal.isSpeakerNotes() ) {\n\t\t\t\tslideNumberDisplay = 'block';\n\t\t\t}\n\t\t}\n\n\t\tthis.element.style.display = slideNumberDisplay;\n\n\t}\n\n\t/**\n\t * Updates the slide number to match the current slide.\n\t */\n\tupdate() {\n\n\t\t// Update slide number if enabled\n\t\tif( this.Reveal.getConfig().slideNumber && this.element ) {\n\t\t\tthis.element.innerHTML = this.getSlideNumber();\n\t\t}\n\n\t}\n\n\t/**\n\t * Returns the HTML string corresponding to the current slide\n\t * number, including formatting.\n\t */\n\tgetSlideNumber( slide = this.Reveal.getCurrentSlide() ) {\n\n\t\tlet config = this.Reveal.getConfig();\n\t\tlet value;\n\t\tlet format = 'h.v';\n\n\t\tif ( typeof config.slideNumber === 'function' ) {\n\t\t\tvalue = config.slideNumber( slide );\n\t\t} else {\n\t\t\t// Check if a custom number format is available\n\t\t\tif( typeof config.slideNumber === 'string' ) {\n\t\t\t\tformat = config.slideNumber;\n\t\t\t}\n\n\t\t\t// If there are ONLY vertical slides in this deck, always use\n\t\t\t// a flattened slide number\n\t\t\tif( !/c/.test( format ) && this.Reveal.getHorizontalSlides().length === 1 ) {\n\t\t\t\tformat = 'c';\n\t\t\t}\n\n\t\t\t// Offset the current slide number by 1 to make it 1-indexed\n\t\t\tlet horizontalOffset = slide && slide.dataset.visibility === 'uncounted' ? 0 : 1;\n\n\t\t\tvalue = [];\n\t\t\tswitch( format ) {\n\t\t\t\tcase 'c':\n\t\t\t\t\tvalue.push( this.Reveal.getSlidePastCount( slide ) + horizontalOffset );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'c/t':\n\t\t\t\t\tvalue.push( this.Reveal.getSlidePastCount( slide ) + horizontalOffset, '/', this.Reveal.getTotalSlides() );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tlet indices = this.Reveal.getIndices( slide );\n\t\t\t\t\tvalue.push( indices.h + horizontalOffset );\n\t\t\t\t\tlet sep = format === 'h/v' ? '/' : '.';\n\t\t\t\t\tif( this.Reveal.isVerticalSlide( slide ) ) value.push( sep, indices.v + 1 );\n\t\t\t}\n\t\t}\n\n\t\tlet url = '#' + this.Reveal.location.getHash( slide );\n\t\treturn this.formatNumber( value[0], value[1], value[2], url );\n\n\t}\n\n\t/**\n\t * Applies HTML formatting to a slide number before it's\n\t * written to the DOM.\n\t *\n\t * @param {number} a Current slide\n\t * @param {string} delimiter Character to separate slide numbers\n\t * @param {(number|*)} b Total slides\n\t * @param {HTMLElement} [url='#'+locationHash()] The url to link to\n\t * @return {string} HTML string fragment\n\t */\n\tformatNumber( a, delimiter, b, url = '#' + this.Reveal.location.getHash() ) {\n\n\t\tif( typeof b === 'number' && !isNaN( b ) ) {\n\t\t\treturn  `<a href=\"${url}\">\n\t\t\t\t\t<span class=\"slide-number-a\">${a}</span>\n\t\t\t\t\t<span class=\"slide-number-delimiter\">${delimiter}</span>\n\t\t\t\t\t<span class=\"slide-number-b\">${b}</span>\n\t\t\t\t\t</a>`;\n\t\t}\n\t\telse {\n\t\t\treturn `<a href=\"${url}\">\n\t\t\t\t\t<span class=\"slide-number-a\">${a}</span>\n\t\t\t\t\t</a>`;\n\t\t}\n\n\t}\n\n\tdestroy() {\n\n\t\tthis.element.remove();\n\n\t}\n\n}","/**\n * Makes it possible to jump to a slide by entering its\n * slide number or id.\n */\nexport default class JumpToSlide {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\tthis.onInput = this.onInput.bind( this );\n\t\tthis.onBlur = this.onBlur.bind( this );\n\t\tthis.onKeyDown = this.onKeyDown.bind( this );\n\n\t}\n\n\trender() {\n\n\t\tthis.element = document.createElement( 'div' );\n\t\tthis.element.className = 'jump-to-slide';\n\n    this.jumpInput = document.createElement( 'input' );\n    this.jumpInput.type = 'text';\n    this.jumpInput.className = 'jump-to-slide-input';\n    this.jumpInput.placeholder = 'Jump to slide';\n\t\tthis.jumpInput.addEventListener( 'input', this.onInput );\n\t\tthis.jumpInput.addEventListener( 'keydown', this.onKeyDown );\n\t\tthis.jumpInput.addEventListener( 'blur', this.onBlur );\n\n    this.element.appendChild( this.jumpInput );\n\n\t}\n\n\tshow() {\n\n\t\tthis.indicesOnShow = this.Reveal.getIndices();\n\n\t\tthis.Reveal.getRevealElement().appendChild( this.element );\n\t\tthis.jumpInput.focus();\n\n\t}\n\n\thide() {\n\n\t\tif( this.isVisible() ) {\n\t\t\tthis.element.remove();\n\t\t\tthis.jumpInput.value = '';\n\n\t\t\tclearTimeout( this.jumpTimeout );\n\t\t\tdelete this.jumpTimeout;\n\t\t}\n\n\t}\n\n\tisVisible() {\n\n\t\treturn !!this.element.parentNode;\n\n\t}\n\n\t/**\n\t * Parses the current input and jumps to the given slide.\n\t */\n\tjump() {\n\n\t\tclearTimeout( this.jumpTimeout );\n\t\tdelete this.jumpTimeout;\n\n\t\tconst query = this.jumpInput.value.trim( '' );\n\t\tlet indices = this.Reveal.location.getIndicesFromHash( query, { oneBasedIndex: true } );\n\n\t\t// If no valid index was found and the input query is a\n\t\t// string, fall back on a simple search\n\t\tif( !indices && /\\S+/i.test( query ) && query.length > 1 ) {\n\t\t\tindices = this.search( query );\n\t\t}\n\n\t\tif( indices && query !== '' ) {\n\t\t\tthis.Reveal.slide( indices.h, indices.v, indices.f );\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\tthis.Reveal.slide( this.indicesOnShow.h, this.indicesOnShow.v, this.indicesOnShow.f );\n\t\t\treturn false;\n\t\t}\n\n\t}\n\n\tjumpAfter( delay ) {\n\n\t\tclearTimeout( this.jumpTimeout );\n\t\tthis.jumpTimeout = setTimeout( () => this.jump(), delay );\n\n\t}\n\n\t/**\n\t * A lofi search that looks for the given query in all\n\t * of our slides and returns the first match.\n\t */\n\tsearch( query ) {\n\n\t\tconst regex = new RegExp( '\\\\b' + query.trim() + '\\\\b', 'i' );\n\n\t\tconst slide = this.Reveal.getSlides().find( ( slide ) => {\n\t\t\treturn regex.test( slide.innerText );\n\t\t} );\n\n\t\tif( slide ) {\n\t\t\treturn this.Reveal.getIndices( slide );\n\t\t}\n\t\telse {\n\t\t\treturn null;\n\t\t}\n\n\t}\n\n\t/**\n\t * Reverts back to the slide we were on when jump to slide was\n\t * invoked.\n\t */\n\tcancel() {\n\n\t\tthis.Reveal.slide( this.indicesOnShow.h, this.indicesOnShow.v, this.indicesOnShow.f );\n\t\tthis.hide();\n\n\t}\n\n\tconfirm() {\n\n\t\tthis.jump();\n\t\tthis.hide();\n\n\t}\n\n\tdestroy() {\n\n\t\tthis.jumpInput.removeEventListener( 'input', this.onInput );\n\t\tthis.jumpInput.removeEventListener( 'keydown', this.onKeyDown );\n\t\tthis.jumpInput.removeEventListener( 'blur', this.onBlur );\n\n\t\tthis.element.remove();\n\n\t}\n\n\tonKeyDown( event ) {\n\n\t\tif( event.keyCode === 13 ) {\n\t\t\tthis.confirm();\n\t\t}\n\t\telse if( event.keyCode === 27 ) {\n\t\t\tthis.cancel();\n\n\t\t\tevent.stopImmediatePropagation();\n\t\t}\n\n\t}\n\n\tonInput( event ) {\n\n\t\tthis.jumpAfter( 200 );\n\n\t}\n\n\tonBlur() {\n\n\t\tsetTimeout( () => this.hide(), 1 );\n\n\t}\n\n}","/**\n * Converts various color input formats to an {r:0,g:0,b:0} object.\n *\n * @param {string} color The string representation of a color\n * @example\n * colorToRgb('#000');\n * @example\n * colorToRgb('#000000');\n * @example\n * colorToRgb('rgb(0,0,0)');\n * @example\n * colorToRgb('rgba(0,0,0)');\n *\n * @return {{r: number, g: number, b: number, [a]: number}|null}\n */\nexport const colorToRgb = ( color ) => {\n\n\tlet hex3 = color.match( /^#([0-9a-f]{3})$/i );\n\tif( hex3 && hex3[1] ) {\n\t\thex3 = hex3[1];\n\t\treturn {\n\t\t\tr: parseInt( hex3.charAt( 0 ), 16 ) * 0x11,\n\t\t\tg: parseInt( hex3.charAt( 1 ), 16 ) * 0x11,\n\t\t\tb: parseInt( hex3.charAt( 2 ), 16 ) * 0x11\n\t\t};\n\t}\n\n\tlet hex6 = color.match( /^#([0-9a-f]{6})$/i );\n\tif( hex6 && hex6[1] ) {\n\t\thex6 = hex6[1];\n\t\treturn {\n\t\t\tr: parseInt( hex6.slice( 0, 2 ), 16 ),\n\t\t\tg: parseInt( hex6.slice( 2, 4 ), 16 ),\n\t\t\tb: parseInt( hex6.slice( 4, 6 ), 16 )\n\t\t};\n\t}\n\n\tlet rgb = color.match( /^rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/i );\n\tif( rgb ) {\n\t\treturn {\n\t\t\tr: parseInt( rgb[1], 10 ),\n\t\t\tg: parseInt( rgb[2], 10 ),\n\t\t\tb: parseInt( rgb[3], 10 )\n\t\t};\n\t}\n\n\tlet rgba = color.match( /^rgba\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\,\\s*([\\d]+|[\\d]*.[\\d]+)\\s*\\)$/i );\n\tif( rgba ) {\n\t\treturn {\n\t\t\tr: parseInt( rgba[1], 10 ),\n\t\t\tg: parseInt( rgba[2], 10 ),\n\t\t\tb: parseInt( rgba[3], 10 ),\n\t\t\ta: parseFloat( rgba[4] )\n\t\t};\n\t}\n\n\treturn null;\n\n}\n\n/**\n * Calculates brightness on a scale of 0-255.\n *\n * @param {string} color See colorToRgb for supported formats.\n * @see {@link colorToRgb}\n */\nexport const colorBrightness = ( color ) => {\n\n\tif( typeof color === 'string' ) color = colorToRgb( color );\n\n\tif( color ) {\n\t\treturn ( color.r * 299 + color.g * 587 + color.b * 114 ) / 1000;\n\t}\n\n\treturn null;\n\n}","import { queryAll } from '../utils/util.js'\nimport { colorToRgb, colorBrightness } from '../utils/color.js'\n\n/**\n * Creates and updates slide backgrounds.\n */\nexport default class Backgrounds {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t}\n\n\trender() {\n\n\t\tthis.element = document.createElement( 'div' );\n\t\tthis.element.className = 'backgrounds';\n\t\tthis.Reveal.getRevealElement().appendChild( this.element );\n\n\t}\n\n\t/**\n\t * Creates the slide background elements and appends them\n\t * to the background container. One element is created per\n\t * slide no matter if the given slide has visible background.\n\t */\n\tcreate() {\n\n\t\t// Clear prior backgrounds\n\t\tthis.element.innerHTML = '';\n\t\tthis.element.classList.add( 'no-transition' );\n\n\t\t// Iterate over all horizontal slides\n\t\tthis.Reveal.getHorizontalSlides().forEach( slideh => {\n\n\t\t\tlet backgroundStack = this.createBackground( slideh, this.element );\n\n\t\t\t// Iterate over all vertical slides\n\t\t\tqueryAll( slideh, 'section' ).forEach( slidev => {\n\n\t\t\t\tthis.createBackground( slidev, backgroundStack );\n\n\t\t\t\tbackgroundStack.classList.add( 'stack' );\n\n\t\t\t} );\n\n\t\t} );\n\n\t\t// Add parallax background if specified\n\t\tif( this.Reveal.getConfig().parallaxBackgroundImage ) {\n\n\t\t\tthis.element.style.backgroundImage = 'url(\"' + this.Reveal.getConfig().parallaxBackgroundImage + '\")';\n\t\t\tthis.element.style.backgroundSize = this.Reveal.getConfig().parallaxBackgroundSize;\n\t\t\tthis.element.style.backgroundRepeat = this.Reveal.getConfig().parallaxBackgroundRepeat;\n\t\t\tthis.element.style.backgroundPosition = this.Reveal.getConfig().parallaxBackgroundPosition;\n\n\t\t\t// Make sure the below properties are set on the element - these properties are\n\t\t\t// needed for proper transitions to be set on the element via CSS. To remove\n\t\t\t// annoying background slide-in effect when the presentation starts, apply\n\t\t\t// these properties after short time delay\n\t\t\tsetTimeout( () => {\n\t\t\t\tthis.Reveal.getRevealElement().classList.add( 'has-parallax-background' );\n\t\t\t}, 1 );\n\n\t\t}\n\t\telse {\n\n\t\t\tthis.element.style.backgroundImage = '';\n\t\t\tthis.Reveal.getRevealElement().classList.remove( 'has-parallax-background' );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Creates a background for the given slide.\n\t *\n\t * @param {HTMLElement} slide\n\t * @param {HTMLElement} container The element that the background\n\t * should be appended to\n\t * @return {HTMLElement} New background div\n\t */\n\tcreateBackground( slide, container ) {\n\n\t\t// Main slide background element\n\t\tlet element = document.createElement( 'div' );\n\t\telement.className = 'slide-background ' + slide.className.replace( /present|past|future/, '' );\n\n\t\t// Inner background element that wraps images/videos/iframes\n\t\tlet contentElement = document.createElement( 'div' );\n\t\tcontentElement.className = 'slide-background-content';\n\n\t\telement.appendChild( contentElement );\n\t\tcontainer.appendChild( element );\n\n\t\tslide.slideBackgroundElement = element;\n\t\tslide.slideBackgroundContentElement = contentElement;\n\n\t\t// Syncs the background to reflect all current background settings\n\t\tthis.sync( slide );\n\n\t\treturn element;\n\n\t}\n\n\t/**\n\t * Renders all of the visual properties of a slide background\n\t * based on the various background attributes.\n\t *\n\t * @param {HTMLElement} slide\n\t */\n\tsync( slide ) {\n\n\t\tconst element = slide.slideBackgroundElement,\n\t\t\tcontentElement = slide.slideBackgroundContentElement;\n\n\t\tconst data = {\n\t\t\tbackground: slide.getAttribute( 'data-background' ),\n\t\t\tbackgroundSize: slide.getAttribute( 'data-background-size' ),\n\t\t\tbackgroundImage: slide.getAttribute( 'data-background-image' ),\n\t\t\tbackgroundVideo: slide.getAttribute( 'data-background-video' ),\n\t\t\tbackgroundIframe: slide.getAttribute( 'data-background-iframe' ),\n\t\t\tbackgroundColor: slide.getAttribute( 'data-background-color' ),\n\t\t\tbackgroundGradient: slide.getAttribute( 'data-background-gradient' ),\n\t\t\tbackgroundRepeat: slide.getAttribute( 'data-background-repeat' ),\n\t\t\tbackgroundPosition: slide.getAttribute( 'data-background-position' ),\n\t\t\tbackgroundTransition: slide.getAttribute( 'data-background-transition' ),\n\t\t\tbackgroundOpacity: slide.getAttribute( 'data-background-opacity' ),\n\t\t};\n\n\t\tconst dataPreload = slide.hasAttribute( 'data-preload' );\n\n\t\t// Reset the prior background state in case this is not the\n\t\t// initial sync\n\t\tslide.classList.remove( 'has-dark-background' );\n\t\tslide.classList.remove( 'has-light-background' );\n\n\t\telement.removeAttribute( 'data-loaded' );\n\t\telement.removeAttribute( 'data-background-hash' );\n\t\telement.removeAttribute( 'data-background-size' );\n\t\telement.removeAttribute( 'data-background-transition' );\n\t\telement.style.backgroundColor = '';\n\n\t\tcontentElement.style.backgroundSize = '';\n\t\tcontentElement.style.backgroundRepeat = '';\n\t\tcontentElement.style.backgroundPosition = '';\n\t\tcontentElement.style.backgroundImage = '';\n\t\tcontentElement.style.opacity = '';\n\t\tcontentElement.innerHTML = '';\n\n\t\tif( data.background ) {\n\t\t\t// Auto-wrap image urls in url(...)\n\t\t\tif( /^(http|file|\\/\\/)/gi.test( data.background ) || /\\.(svg|png|jpg|jpeg|gif|bmp|webp)([?#\\s]|$)/gi.test( data.background ) ) {\n\t\t\t\tslide.setAttribute( 'data-background-image', data.background );\n\t\t\t}\n\t\t\telse {\n\t\t\t\telement.style.background = data.background;\n\t\t\t}\n\t\t}\n\n\t\t// Create a hash for this combination of background settings.\n\t\t// This is used to determine when two slide backgrounds are\n\t\t// the same.\n\t\tif( data.background || data.backgroundColor || data.backgroundGradient || data.backgroundImage || data.backgroundVideo || data.backgroundIframe ) {\n\t\t\telement.setAttribute( 'data-background-hash', data.background +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundSize +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundImage +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundVideo +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundIframe +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundColor +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundGradient +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundRepeat +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundPosition +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundTransition +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundOpacity );\n\t\t}\n\n\t\t// Additional and optional background properties\n\t\tif( data.backgroundSize ) element.setAttribute( 'data-background-size', data.backgroundSize );\n\t\tif( data.backgroundColor ) element.style.backgroundColor = data.backgroundColor;\n\t\tif( data.backgroundGradient ) element.style.backgroundImage = data.backgroundGradient;\n\t\tif( data.backgroundTransition ) element.setAttribute( 'data-background-transition', data.backgroundTransition );\n\n\t\tif( dataPreload ) element.setAttribute( 'data-preload', '' );\n\n\t\t// Background image options are set on the content wrapper\n\t\tif( data.backgroundSize ) contentElement.style.backgroundSize = data.backgroundSize;\n\t\tif( data.backgroundRepeat ) contentElement.style.backgroundRepeat = data.backgroundRepeat;\n\t\tif( data.backgroundPosition ) contentElement.style.backgroundPosition = data.backgroundPosition;\n\t\tif( data.backgroundOpacity ) contentElement.style.opacity = data.backgroundOpacity;\n\n\t\t// If this slide has a background color, we add a class that\n\t\t// signals if it is light or dark. If the slide has no background\n\t\t// color, no class will be added\n\t\tlet contrastColor = data.backgroundColor;\n\n\t\t// If no bg color was found, or it cannot be converted by colorToRgb, check the computed background\n\t\tif( !contrastColor || !colorToRgb( contrastColor ) ) {\n\t\t\tlet computedBackgroundStyle = window.getComputedStyle( element );\n\t\t\tif( computedBackgroundStyle && computedBackgroundStyle.backgroundColor ) {\n\t\t\t\tcontrastColor = computedBackgroundStyle.backgroundColor;\n\t\t\t}\n\t\t}\n\n\t\tif( contrastColor ) {\n\t\t\tconst rgb = colorToRgb( contrastColor );\n\n\t\t\t// Ignore fully transparent backgrounds. Some browsers return\n\t\t\t// rgba(0,0,0,0) when reading the computed background color of\n\t\t\t// an element with no background\n\t\t\tif( rgb && rgb.a !== 0 ) {\n\t\t\t\tif( colorBrightness( contrastColor ) < 128 ) {\n\t\t\t\t\tslide.classList.add( 'has-dark-background' );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tslide.classList.add( 'has-light-background' );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Updates the background elements to reflect the current\n\t * slide.\n\t *\n\t * @param {boolean} includeAll If true, the backgrounds of\n\t * all vertical slides (not just the present) will be updated.\n\t */\n\tupdate( includeAll = false ) {\n\n\t\tlet currentSlide = this.Reveal.getCurrentSlide();\n\t\tlet indices = this.Reveal.getIndices();\n\n\t\tlet currentBackground = null;\n\n\t\t// Reverse past/future classes when in RTL mode\n\t\tlet horizontalPast = this.Reveal.getConfig().rtl ? 'future' : 'past',\n\t\t\thorizontalFuture = this.Reveal.getConfig().rtl ? 'past' : 'future';\n\n\t\t// Update the classes of all backgrounds to match the\n\t\t// states of their slides (past/present/future)\n\t\tArray.from( this.element.childNodes ).forEach( ( backgroundh, h ) => {\n\n\t\t\tbackgroundh.classList.remove( 'past', 'present', 'future' );\n\n\t\t\tif( h < indices.h ) {\n\t\t\t\tbackgroundh.classList.add( horizontalPast );\n\t\t\t}\n\t\t\telse if ( h > indices.h ) {\n\t\t\t\tbackgroundh.classList.add( horizontalFuture );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbackgroundh.classList.add( 'present' );\n\n\t\t\t\t// Store a reference to the current background element\n\t\t\t\tcurrentBackground = backgroundh;\n\t\t\t}\n\n\t\t\tif( includeAll || h === indices.h ) {\n\t\t\t\tqueryAll( backgroundh, '.slide-background' ).forEach( ( backgroundv, v ) => {\n\n\t\t\t\t\tbackgroundv.classList.remove( 'past', 'present', 'future' );\n\n\t\t\t\t\tif( v < indices.v ) {\n\t\t\t\t\t\tbackgroundv.classList.add( 'past' );\n\t\t\t\t\t}\n\t\t\t\t\telse if ( v > indices.v ) {\n\t\t\t\t\t\tbackgroundv.classList.add( 'future' );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tbackgroundv.classList.add( 'present' );\n\n\t\t\t\t\t\t// Only if this is the present horizontal and vertical slide\n\t\t\t\t\t\tif( h === indices.h ) currentBackground = backgroundv;\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t}\n\n\t\t} );\n\n\t\t// Stop content inside of previous backgrounds\n\t\tif( this.previousBackground ) {\n\n\t\t\tthis.Reveal.slideContent.stopEmbeddedContent( this.previousBackground, { unloadIframes: !this.Reveal.slideContent.shouldPreload( this.previousBackground ) } );\n\n\t\t}\n\n\t\t// Start content in the current background\n\t\tif( currentBackground ) {\n\n\t\t\tthis.Reveal.slideContent.startEmbeddedContent( currentBackground );\n\n\t\t\tlet currentBackgroundContent = currentBackground.querySelector( '.slide-background-content' );\n\t\t\tif( currentBackgroundContent ) {\n\n\t\t\t\tlet backgroundImageURL = currentBackgroundContent.style.backgroundImage || '';\n\n\t\t\t\t// Restart GIFs (doesn't work in Firefox)\n\t\t\t\tif( /\\.gif/i.test( backgroundImageURL ) ) {\n\t\t\t\t\tcurrentBackgroundContent.style.backgroundImage = '';\n\t\t\t\t\twindow.getComputedStyle( currentBackgroundContent ).opacity;\n\t\t\t\t\tcurrentBackgroundContent.style.backgroundImage = backgroundImageURL;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Don't transition between identical backgrounds. This\n\t\t\t// prevents unwanted flicker.\n\t\t\tlet previousBackgroundHash = this.previousBackground ? this.previousBackground.getAttribute( 'data-background-hash' ) : null;\n\t\t\tlet currentBackgroundHash = currentBackground.getAttribute( 'data-background-hash' );\n\t\t\tif( currentBackgroundHash && currentBackgroundHash === previousBackgroundHash && currentBackground !== this.previousBackground ) {\n\t\t\t\tthis.element.classList.add( 'no-transition' );\n\t\t\t}\n\n\t\t\tthis.previousBackground = currentBackground;\n\n\t\t}\n\n\t\t// If there's a background brightness flag for this slide,\n\t\t// bubble it to the .reveal container\n\t\tif( currentSlide ) {\n\t\t\t[ 'has-light-background', 'has-dark-background' ].forEach( classToBubble => {\n\t\t\t\tif( currentSlide.classList.contains( classToBubble ) ) {\n\t\t\t\t\tthis.Reveal.getRevealElement().classList.add( classToBubble );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.Reveal.getRevealElement().classList.remove( classToBubble );\n\t\t\t\t}\n\t\t\t}, this );\n\t\t}\n\n\t\t// Allow the first background to apply without transition\n\t\tsetTimeout( () => {\n\t\t\tthis.element.classList.remove( 'no-transition' );\n\t\t}, 1 );\n\n\t}\n\n\t/**\n\t * Updates the position of the parallax background based\n\t * on the current slide index.\n\t */\n\tupdateParallax() {\n\n\t\tlet indices = this.Reveal.getIndices();\n\n\t\tif( this.Reveal.getConfig().parallaxBackgroundImage ) {\n\n\t\t\tlet horizontalSlides = this.Reveal.getHorizontalSlides(),\n\t\t\t\tverticalSlides = this.Reveal.getVerticalSlides();\n\n\t\t\tlet backgroundSize = this.element.style.backgroundSize.split( ' ' ),\n\t\t\t\tbackgroundWidth, backgroundHeight;\n\n\t\t\tif( backgroundSize.length === 1 ) {\n\t\t\t\tbackgroundWidth = backgroundHeight = parseInt( backgroundSize[0], 10 );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tbackgroundWidth = parseInt( backgroundSize[0], 10 );\n\t\t\t\tbackgroundHeight = parseInt( backgroundSize[1], 10 );\n\t\t\t}\n\n\t\t\tlet slideWidth = this.element.offsetWidth,\n\t\t\t\thorizontalSlideCount = horizontalSlides.length,\n\t\t\t\thorizontalOffsetMultiplier,\n\t\t\t\thorizontalOffset;\n\n\t\t\tif( typeof this.Reveal.getConfig().parallaxBackgroundHorizontal === 'number' ) {\n\t\t\t\thorizontalOffsetMultiplier = this.Reveal.getConfig().parallaxBackgroundHorizontal;\n\t\t\t}\n\t\t\telse {\n\t\t\t\thorizontalOffsetMultiplier = horizontalSlideCount > 1 ? ( backgroundWidth - slideWidth ) / ( horizontalSlideCount-1 ) : 0;\n\t\t\t}\n\n\t\t\thorizontalOffset = horizontalOffsetMultiplier * indices.h * -1;\n\n\t\t\tlet slideHeight = this.element.offsetHeight,\n\t\t\t\tverticalSlideCount = verticalSlides.length,\n\t\t\t\tverticalOffsetMultiplier,\n\t\t\t\tverticalOffset;\n\n\t\t\tif( typeof this.Reveal.getConfig().parallaxBackgroundVertical === 'number' ) {\n\t\t\t\tverticalOffsetMultiplier = this.Reveal.getConfig().parallaxBackgroundVertical;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tverticalOffsetMultiplier = ( backgroundHeight - slideHeight ) / ( verticalSlideCount-1 );\n\t\t\t}\n\n\t\t\tverticalOffset = verticalSlideCount > 0 ?  verticalOffsetMultiplier * indices.v : 0;\n\n\t\t\tthis.element.style.backgroundPosition = horizontalOffset + 'px ' + -verticalOffset + 'px';\n\n\t\t}\n\n\t}\n\n\tdestroy() {\n\n\t\tthis.element.remove();\n\n\t}\n\n}\n","\nexport const SLIDES_SELECTOR = '.slides section';\nexport const HORIZONTAL_SLIDES_SELECTOR = '.slides>section';\nexport const VERTICAL_SLIDES_SELECTOR = '.slides>section.present>section';\n\n// Methods that may not be invoked via the postMessage API\nexport const POST_MESSAGE_METHOD_BLACKLIST = /registerPlugin|registerKeyboardShortcut|addKeyBinding|addEventListener|showPreview/;\n\n// Regex for retrieving the fragment style from a class attribute\nexport const FRAGMENT_STYLE_REGEX = /fade-(down|up|right|left|out|in-then-out|in-then-semi-out)|semi-fade-out|current-visible|shrink|grow/;","import { queryAll, extend, createStyleSheet, matches, closest } from '../utils/util.js'\nimport { FRAGMENT_STYLE_REGEX } from '../utils/constants.js'\n\n// Counter used to generate unique IDs for auto-animated elements\nlet autoAnimateCounter = 0;\n\n/**\n * Automatically animates matching elements across\n * slides with the [data-auto-animate] attribute.\n */\nexport default class AutoAnimate {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t}\n\n\t/**\n\t * Runs an auto-animation between the given slides.\n\t *\n\t * @param  {HTMLElement} fromSlide\n\t * @param  {HTMLElement} toSlide\n\t */\n\trun( fromSlide, toSlide ) {\n\n\t\t// Clean up after prior animations\n\t\tthis.reset();\n\n\t\tlet allSlides = this.Reveal.getSlides();\n\t\tlet toSlideIndex = allSlides.indexOf( toSlide );\n\t\tlet fromSlideIndex = allSlides.indexOf( fromSlide );\n\n\t\t// Ensure that both slides are auto-animate targets with the same data-auto-animate-id value\n\t\t// (including null if absent on both) and that data-auto-animate-restart isn't set on the\n\t\t// physically latter slide (independent of slide direction)\n\t\tif( fromSlide.hasAttribute( 'data-auto-animate' ) && toSlide.hasAttribute( 'data-auto-animate' )\n\t\t\t\t&& fromSlide.getAttribute( 'data-auto-animate-id' ) === toSlide.getAttribute( 'data-auto-animate-id' ) \n\t\t\t\t&& !( toSlideIndex > fromSlideIndex ? toSlide : fromSlide ).hasAttribute( 'data-auto-animate-restart' ) ) {\n\n\t\t\t// Create a new auto-animate sheet\n\t\t\tthis.autoAnimateStyleSheet = this.autoAnimateStyleSheet || createStyleSheet();\n\n\t\t\tlet animationOptions = this.getAutoAnimateOptions( toSlide );\n\n\t\t\t// Set our starting state\n\t\t\tfromSlide.dataset.autoAnimate = 'pending';\n\t\t\ttoSlide.dataset.autoAnimate = 'pending';\n\n\t\t\t// Flag the navigation direction, needed for fragment buildup\n\t\t\tanimationOptions.slideDirection = toSlideIndex > fromSlideIndex ? 'forward' : 'backward';\n\n\t\t\t// If the from-slide is hidden because it has moved outside\n\t\t\t// the view distance, we need to temporarily show it while\n\t\t\t// measuring\n\t\t\tlet fromSlideIsHidden = fromSlide.style.display === 'none';\n\t\t\tif( fromSlideIsHidden ) fromSlide.style.display = this.Reveal.getConfig().display;\n\n\t\t\t// Inject our auto-animate styles for this transition\n\t\t\tlet css = this.getAutoAnimatableElements( fromSlide, toSlide ).map( elements => {\n\t\t\t\treturn this.autoAnimateElements( elements.from, elements.to, elements.options || {}, animationOptions, autoAnimateCounter++ );\n\t\t\t} );\n\n\t\t\tif( fromSlideIsHidden ) fromSlide.style.display = 'none';\n\n\t\t\t// Animate unmatched elements, if enabled\n\t\t\tif( toSlide.dataset.autoAnimateUnmatched !== 'false' && this.Reveal.getConfig().autoAnimateUnmatched === true ) {\n\n\t\t\t\t// Our default timings for unmatched elements\n\t\t\t\tlet defaultUnmatchedDuration = animationOptions.duration * 0.8,\n\t\t\t\t\tdefaultUnmatchedDelay = animationOptions.duration * 0.2;\n\n\t\t\t\tthis.getUnmatchedAutoAnimateElements( toSlide ).forEach( unmatchedElement => {\n\n\t\t\t\t\tlet unmatchedOptions = this.getAutoAnimateOptions( unmatchedElement, animationOptions );\n\t\t\t\t\tlet id = 'unmatched';\n\n\t\t\t\t\t// If there is a duration or delay set specifically for this\n\t\t\t\t\t// element our unmatched elements should adhere to those\n\t\t\t\t\tif( unmatchedOptions.duration !== animationOptions.duration || unmatchedOptions.delay !== animationOptions.delay ) {\n\t\t\t\t\t\tid = 'unmatched-' + autoAnimateCounter++;\n\t\t\t\t\t\tcss.push( `[data-auto-animate=\"running\"] [data-auto-animate-target=\"${id}\"] { transition: opacity ${unmatchedOptions.duration}s ease ${unmatchedOptions.delay}s; }` );\n\t\t\t\t\t}\n\n\t\t\t\t\tunmatchedElement.dataset.autoAnimateTarget = id;\n\n\t\t\t\t}, this );\n\n\t\t\t\t// Our default transition for unmatched elements\n\t\t\t\tcss.push( `[data-auto-animate=\"running\"] [data-auto-animate-target=\"unmatched\"] { transition: opacity ${defaultUnmatchedDuration}s ease ${defaultUnmatchedDelay}s; }` );\n\n\t\t\t}\n\n\t\t\t// Setting the whole chunk of CSS at once is the most\n\t\t\t// efficient way to do this. Using sheet.insertRule\n\t\t\t// is multiple factors slower.\n\t\t\tthis.autoAnimateStyleSheet.innerHTML = css.join( '' );\n\n\t\t\t// Start the animation next cycle\n\t\t\trequestAnimationFrame( () => {\n\t\t\t\tif( this.autoAnimateStyleSheet ) {\n\t\t\t\t\t// This forces our newly injected styles to be applied in Firefox\n\t\t\t\t\tgetComputedStyle( this.autoAnimateStyleSheet ).fontWeight;\n\n\t\t\t\t\ttoSlide.dataset.autoAnimate = 'running';\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tthis.Reveal.dispatchEvent({\n\t\t\t\ttype: 'autoanimate',\n\t\t\t\tdata: {\n\t\t\t\t\tfromSlide,\n\t\t\t\t\ttoSlide,\n\t\t\t\t\tsheet: this.autoAnimateStyleSheet\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Rolls back all changes that we've made to the DOM so\n\t * that as part of animating.\n\t */\n\treset() {\n\n\t\t// Reset slides\n\t\tqueryAll( this.Reveal.getRevealElement(), '[data-auto-animate]:not([data-auto-animate=\"\"])' ).forEach( element => {\n\t\t\telement.dataset.autoAnimate = '';\n\t\t} );\n\n\t\t// Reset elements\n\t\tqueryAll( this.Reveal.getRevealElement(), '[data-auto-animate-target]' ).forEach( element => {\n\t\t\tdelete element.dataset.autoAnimateTarget;\n\t\t} );\n\n\t\t// Remove the animation sheet\n\t\tif( this.autoAnimateStyleSheet && this.autoAnimateStyleSheet.parentNode ) {\n\t\t\tthis.autoAnimateStyleSheet.parentNode.removeChild( this.autoAnimateStyleSheet );\n\t\t\tthis.autoAnimateStyleSheet = null;\n\t\t}\n\n\t}\n\n\t/**\n\t * Creates a FLIP animation where the `to` element starts out\n\t * in the `from` element position and animates to its original\n\t * state.\n\t *\n\t * @param {HTMLElement} from\n\t * @param {HTMLElement} to\n\t * @param {Object} elementOptions Options for this element pair\n\t * @param {Object} animationOptions Options set at the slide level\n\t * @param {String} id Unique ID that we can use to identify this\n\t * auto-animate element in the DOM\n\t */\n\tautoAnimateElements( from, to, elementOptions, animationOptions, id ) {\n\n\t\t// 'from' elements are given a data-auto-animate-target with no value,\n\t\t// 'to' elements are are given a data-auto-animate-target with an ID\n\t\tfrom.dataset.autoAnimateTarget = '';\n\t\tto.dataset.autoAnimateTarget = id;\n\n\t\t// Each element may override any of the auto-animate options\n\t\t// like transition easing, duration and delay via data-attributes\n\t\tlet options = this.getAutoAnimateOptions( to, animationOptions );\n\n\t\t// If we're using a custom element matcher the element options\n\t\t// may contain additional transition overrides\n\t\tif( typeof elementOptions.delay !== 'undefined' ) options.delay = elementOptions.delay;\n\t\tif( typeof elementOptions.duration !== 'undefined' ) options.duration = elementOptions.duration;\n\t\tif( typeof elementOptions.easing !== 'undefined' ) options.easing = elementOptions.easing;\n\n\t\tlet fromProps = this.getAutoAnimatableProperties( 'from', from, elementOptions ),\n\t\t\ttoProps = this.getAutoAnimatableProperties( 'to', to, elementOptions );\n\n\t\t// Maintain fragment visibility for matching elements when\n\t\t// we're navigating forwards, this way the viewer won't need\n\t\t// to step through the same fragments twice\n\t\tif( to.classList.contains( 'fragment' ) ) {\n\n\t\t\t// Don't auto-animate the opacity of fragments to avoid\n\t\t\t// conflicts with fragment animations\n\t\t\tdelete toProps.styles['opacity'];\n\n\t\t\tif( from.classList.contains( 'fragment' ) ) {\n\n\t\t\t\tlet fromFragmentStyle = ( from.className.match( FRAGMENT_STYLE_REGEX ) || [''] )[0];\n\t\t\t\tlet toFragmentStyle = ( to.className.match( FRAGMENT_STYLE_REGEX ) || [''] )[0];\n\n\t\t\t\t// Only skip the fragment if the fragment animation style\n\t\t\t\t// remains unchanged\n\t\t\t\tif( fromFragmentStyle === toFragmentStyle && animationOptions.slideDirection === 'forward' ) {\n\t\t\t\t\tto.classList.add( 'visible', 'disabled' );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// If translation and/or scaling are enabled, css transform\n\t\t// the 'to' element so that it matches the position and size\n\t\t// of the 'from' element\n\t\tif( elementOptions.translate !== false || elementOptions.scale !== false ) {\n\n\t\t\tlet presentationScale = this.Reveal.getScale();\n\n\t\t\tlet delta = {\n\t\t\t\tx: ( fromProps.x - toProps.x ) / presentationScale,\n\t\t\t\ty: ( fromProps.y - toProps.y ) / presentationScale,\n\t\t\t\tscaleX: fromProps.width / toProps.width,\n\t\t\t\tscaleY: fromProps.height / toProps.height\n\t\t\t};\n\n\t\t\t// Limit decimal points to avoid 0.0001px blur and stutter\n\t\t\tdelta.x = Math.round( delta.x * 1000 ) / 1000;\n\t\t\tdelta.y = Math.round( delta.y * 1000 ) / 1000;\n\t\t\tdelta.scaleX = Math.round( delta.scaleX * 1000 ) / 1000;\n\t\t\tdelta.scaleX = Math.round( delta.scaleX * 1000 ) / 1000;\n\n\t\t\tlet translate = elementOptions.translate !== false && ( delta.x !== 0 || delta.y !== 0 ),\n\t\t\t\tscale = elementOptions.scale !== false && ( delta.scaleX !== 0 || delta.scaleY !== 0 );\n\n\t\t\t// No need to transform if nothing's changed\n\t\t\tif( translate || scale ) {\n\n\t\t\t\tlet transform = [];\n\n\t\t\t\tif( translate ) transform.push( `translate(${delta.x}px, ${delta.y}px)` );\n\t\t\t\tif( scale ) transform.push( `scale(${delta.scaleX}, ${delta.scaleY})` );\n\n\t\t\t\tfromProps.styles['transform'] = transform.join( ' ' );\n\t\t\t\tfromProps.styles['transform-origin'] = 'top left';\n\n\t\t\t\ttoProps.styles['transform'] = 'none';\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Delete all unchanged 'to' styles\n\t\tfor( let propertyName in toProps.styles ) {\n\t\t\tconst toValue = toProps.styles[propertyName];\n\t\t\tconst fromValue = fromProps.styles[propertyName];\n\n\t\t\tif( toValue === fromValue ) {\n\t\t\t\tdelete toProps.styles[propertyName];\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// If these property values were set via a custom matcher providing\n\t\t\t\t// an explicit 'from' and/or 'to' value, we always inject those values.\n\t\t\t\tif( toValue.explicitValue === true ) {\n\t\t\t\t\ttoProps.styles[propertyName] = toValue.value;\n\t\t\t\t}\n\n\t\t\t\tif( fromValue.explicitValue === true ) {\n\t\t\t\t\tfromProps.styles[propertyName] = fromValue.value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tlet css = '';\n\n\t\tlet toStyleProperties = Object.keys( toProps.styles );\n\n\t\t// Only create animate this element IF at least one style\n\t\t// property has changed\n\t\tif( toStyleProperties.length > 0 ) {\n\n\t\t\t// Instantly move to the 'from' state\n\t\t\tfromProps.styles['transition'] = 'none';\n\n\t\t\t// Animate towards the 'to' state\n\t\t\ttoProps.styles['transition'] = `all ${options.duration}s ${options.easing} ${options.delay}s`;\n\t\t\ttoProps.styles['transition-property'] = toStyleProperties.join( ', ' );\n\t\t\ttoProps.styles['will-change'] = toStyleProperties.join( ', ' );\n\n\t\t\t// Build up our custom CSS. We need to override inline styles\n\t\t\t// so we need to make our styles vErY IMPORTANT!1!!\n\t\t\tlet fromCSS = Object.keys( fromProps.styles ).map( propertyName => {\n\t\t\t\treturn propertyName + ': ' + fromProps.styles[propertyName] + ' !important;';\n\t\t\t} ).join( '' );\n\n\t\t\tlet toCSS = Object.keys( toProps.styles ).map( propertyName => {\n\t\t\t\treturn propertyName + ': ' + toProps.styles[propertyName] + ' !important;';\n\t\t\t} ).join( '' );\n\n\t\t\tcss = \t'[data-auto-animate-target=\"'+ id +'\"] {'+ fromCSS +'}' +\n\t\t\t\t\t'[data-auto-animate=\"running\"] [data-auto-animate-target=\"'+ id +'\"] {'+ toCSS +'}';\n\n\t\t}\n\n\t\treturn css;\n\n\t}\n\n\t/**\n\t * Returns the auto-animate options for the given element.\n\t *\n\t * @param {HTMLElement} element Element to pick up options\n\t * from, either a slide or an animation target\n\t * @param {Object} [inheritedOptions] Optional set of existing\n\t * options\n\t */\n\tgetAutoAnimateOptions( element, inheritedOptions ) {\n\n\t\tlet options = {\n\t\t\teasing: this.Reveal.getConfig().autoAnimateEasing,\n\t\t\tduration: this.Reveal.getConfig().autoAnimateDuration,\n\t\t\tdelay: 0\n\t\t};\n\n\t\toptions = extend( options, inheritedOptions );\n\n\t\t// Inherit options from parent elements\n\t\tif( element.parentNode ) {\n\t\t\tlet autoAnimatedParent = closest( element.parentNode, '[data-auto-animate-target]' );\n\t\t\tif( autoAnimatedParent ) {\n\t\t\t\toptions = this.getAutoAnimateOptions( autoAnimatedParent, options );\n\t\t\t}\n\t\t}\n\n\t\tif( element.dataset.autoAnimateEasing ) {\n\t\t\toptions.easing = element.dataset.autoAnimateEasing;\n\t\t}\n\n\t\tif( element.dataset.autoAnimateDuration ) {\n\t\t\toptions.duration = parseFloat( element.dataset.autoAnimateDuration );\n\t\t}\n\n\t\tif( element.dataset.autoAnimateDelay ) {\n\t\t\toptions.delay = parseFloat( element.dataset.autoAnimateDelay );\n\t\t}\n\n\t\treturn options;\n\n\t}\n\n\t/**\n\t * Returns an object containing all of the properties\n\t * that can be auto-animated for the given element and\n\t * their current computed values.\n\t *\n\t * @param {String} direction 'from' or 'to'\n\t */\n\tgetAutoAnimatableProperties( direction, element, elementOptions ) {\n\n\t\tlet config = this.Reveal.getConfig();\n\n\t\tlet properties = { styles: [] };\n\n\t\t// Position and size\n\t\tif( elementOptions.translate !== false || elementOptions.scale !== false ) {\n\t\t\tlet bounds;\n\n\t\t\t// Custom auto-animate may optionally return a custom tailored\n\t\t\t// measurement function\n\t\t\tif( typeof elementOptions.measure === 'function' ) {\n\t\t\t\tbounds = elementOptions.measure( element );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif( config.center ) {\n\t\t\t\t\t// More precise, but breaks when used in combination\n\t\t\t\t\t// with zoom for scaling the deck \\_()_/\n\t\t\t\t\tbounds = element.getBoundingClientRect();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlet scale = this.Reveal.getScale();\n\t\t\t\t\tbounds = {\n\t\t\t\t\t\tx: element.offsetLeft * scale,\n\t\t\t\t\t\ty: element.offsetTop * scale,\n\t\t\t\t\t\twidth: element.offsetWidth * scale,\n\t\t\t\t\t\theight: element.offsetHeight * scale\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tproperties.x = bounds.x;\n\t\t\tproperties.y = bounds.y;\n\t\t\tproperties.width = bounds.width;\n\t\t\tproperties.height = bounds.height;\n\t\t}\n\n\t\tconst computedStyles = getComputedStyle( element );\n\n\t\t// CSS styles\n\t\t( elementOptions.styles || config.autoAnimateStyles ).forEach( style => {\n\t\t\tlet value;\n\n\t\t\t// `style` is either the property name directly, or an object\n\t\t\t// definition of a style property\n\t\t\tif( typeof style === 'string' ) style = { property: style };\n\n\t\t\tif( typeof style.from !== 'undefined' && direction === 'from' ) {\n\t\t\t\tvalue = { value: style.from, explicitValue: true };\n\t\t\t}\n\t\t\telse if( typeof style.to !== 'undefined' && direction === 'to' ) {\n\t\t\t\tvalue = { value: style.to, explicitValue: true };\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Use a unitless value for line-height so that it inherits properly\n\t\t\t\tif( style.property === 'line-height' ) {\n\t\t\t\t\tvalue = parseFloat( computedStyles['line-height'] ) / parseFloat( computedStyles['font-size'] );\n\t\t\t\t}\n\n\t\t\t\tif( isNaN(value) ) {\n\t\t\t\t\tvalue = computedStyles[style.property];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( value !== '' ) {\n\t\t\t\tproperties.styles[style.property] = value;\n\t\t\t}\n\t\t} );\n\n\t\treturn properties;\n\n\t}\n\n\t/**\n\t * Get a list of all element pairs that we can animate\n\t * between the given slides.\n\t *\n\t * @param {HTMLElement} fromSlide\n\t * @param {HTMLElement} toSlide\n\t *\n\t * @return {Array} Each value is an array where [0] is\n\t * the element we're animating from and [1] is the\n\t * element we're animating to\n\t */\n\tgetAutoAnimatableElements( fromSlide, toSlide ) {\n\n\t\tlet matcher = typeof this.Reveal.getConfig().autoAnimateMatcher === 'function' ? this.Reveal.getConfig().autoAnimateMatcher : this.getAutoAnimatePairs;\n\n\t\tlet pairs = matcher.call( this, fromSlide, toSlide );\n\n\t\tlet reserved = [];\n\n\t\t// Remove duplicate pairs\n\t\treturn pairs.filter( ( pair, index ) => {\n\t\t\tif( reserved.indexOf( pair.to ) === -1 ) {\n\t\t\t\treserved.push( pair.to );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} );\n\n\t}\n\n\t/**\n\t * Identifies matching elements between slides.\n\t *\n\t * You can specify a custom matcher function by using\n\t * the `autoAnimateMatcher` config option.\n\t */\n\tgetAutoAnimatePairs( fromSlide, toSlide ) {\n\n\t\tlet pairs = [];\n\n\t\tconst codeNodes = 'pre';\n\t\tconst textNodes = 'h1, h2, h3, h4, h5, h6, p, li';\n\t\tconst mediaNodes = 'img, video, iframe';\n\n\t\t// Explicit matches via data-id\n\t\tthis.findAutoAnimateMatches( pairs, fromSlide, toSlide, '[data-id]', node => {\n\t\t\treturn node.nodeName + ':::' + node.getAttribute( 'data-id' );\n\t\t} );\n\n\t\t// Text\n\t\tthis.findAutoAnimateMatches( pairs, fromSlide, toSlide, textNodes, node => {\n\t\t\treturn node.nodeName + ':::' + node.innerText;\n\t\t} );\n\n\t\t// Media\n\t\tthis.findAutoAnimateMatches( pairs, fromSlide, toSlide, mediaNodes, node => {\n\t\t\treturn node.nodeName + ':::' + ( node.getAttribute( 'src' ) || node.getAttribute( 'data-src' ) );\n\t\t} );\n\n\t\t// Code\n\t\tthis.findAutoAnimateMatches( pairs, fromSlide, toSlide, codeNodes, node => {\n\t\t\treturn node.nodeName + ':::' + node.innerText;\n\t\t} );\n\n\t\tpairs.forEach( pair => {\n\t\t\t// Disable scale transformations on text nodes, we transition\n\t\t\t// each individual text property instead\n\t\t\tif( matches( pair.from, textNodes ) ) {\n\t\t\t\tpair.options = { scale: false };\n\t\t\t}\n\t\t\t// Animate individual lines of code\n\t\t\telse if( matches( pair.from, codeNodes ) ) {\n\n\t\t\t\t// Transition the code block's width and height instead of scaling\n\t\t\t\t// to prevent its content from being squished\n\t\t\t\tpair.options = { scale: false, styles: [ 'width', 'height' ] };\n\n\t\t\t\t// Lines of code\n\t\t\t\tthis.findAutoAnimateMatches( pairs, pair.from, pair.to, '.hljs .hljs-ln-code', node => {\n\t\t\t\t\treturn node.textContent;\n\t\t\t\t}, {\n\t\t\t\t\tscale: false,\n\t\t\t\t\tstyles: [],\n\t\t\t\t\tmeasure: this.getLocalBoundingBox.bind( this )\n\t\t\t\t} );\n\n\t\t\t\t// Line numbers\n\t\t\t\tthis.findAutoAnimateMatches( pairs, pair.from, pair.to, '.hljs .hljs-ln-numbers[data-line-number]', node => {\n\t\t\t\t\treturn node.getAttribute( 'data-line-number' );\n\t\t\t\t}, {\n\t\t\t\t\tscale: false,\n\t\t\t\t\tstyles: [ 'width' ],\n\t\t\t\t\tmeasure: this.getLocalBoundingBox.bind( this )\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}, this );\n\n\t\treturn pairs;\n\n\t}\n\n\t/**\n\t * Helper method which returns a bounding box based on\n\t * the given elements offset coordinates.\n\t *\n\t * @param {HTMLElement} element\n\t * @return {Object} x, y, width, height\n\t */\n\tgetLocalBoundingBox( element ) {\n\n\t\tconst presentationScale = this.Reveal.getScale();\n\n\t\treturn {\n\t\t\tx: Math.round( ( element.offsetLeft * presentationScale ) * 100 ) / 100,\n\t\t\ty: Math.round( ( element.offsetTop * presentationScale ) * 100 ) / 100,\n\t\t\twidth: Math.round( ( element.offsetWidth * presentationScale ) * 100 ) / 100,\n\t\t\theight: Math.round( ( element.offsetHeight * presentationScale ) * 100 ) / 100\n\t\t};\n\n\t}\n\n\t/**\n\t * Finds matching elements between two slides.\n\t *\n\t * @param {Array} pairs            \tList of pairs to push matches to\n\t * @param {HTMLElement} fromScope   Scope within the from element exists\n\t * @param {HTMLElement} toScope     Scope within the to element exists\n\t * @param {String} selector         CSS selector of the element to match\n\t * @param {Function} serializer     A function that accepts an element and returns\n\t *                                  a stringified ID based on its contents\n\t * @param {Object} animationOptions Optional config options for this pair\n\t */\n\tfindAutoAnimateMatches( pairs, fromScope, toScope, selector, serializer, animationOptions ) {\n\n\t\tlet fromMatches = {};\n\t\tlet toMatches = {};\n\n\t\t[].slice.call( fromScope.querySelectorAll( selector ) ).forEach( ( element, i ) => {\n\t\t\tconst key = serializer( element );\n\t\t\tif( typeof key === 'string' && key.length ) {\n\t\t\t\tfromMatches[key] = fromMatches[key] || [];\n\t\t\t\tfromMatches[key].push( element );\n\t\t\t}\n\t\t} );\n\n\t\t[].slice.call( toScope.querySelectorAll( selector ) ).forEach( ( element, i ) => {\n\t\t\tconst key = serializer( element );\n\t\t\ttoMatches[key] = toMatches[key] || [];\n\t\t\ttoMatches[key].push( element );\n\n\t\t\tlet fromElement;\n\n\t\t\t// Retrieve the 'from' element\n\t\t\tif( fromMatches[key] ) {\n\t\t\t\tconst primaryIndex = toMatches[key].length - 1;\n\t\t\t\tconst secondaryIndex = fromMatches[key].length - 1;\n\n\t\t\t\t// If there are multiple identical from elements, retrieve\n\t\t\t\t// the one at the same index as our to-element.\n\t\t\t\tif( fromMatches[key][ primaryIndex ] ) {\n\t\t\t\t\tfromElement = fromMatches[key][ primaryIndex ];\n\t\t\t\t\tfromMatches[key][ primaryIndex ] = null;\n\t\t\t\t}\n\t\t\t\t// If there are no matching from-elements at the same index,\n\t\t\t\t// use the last one.\n\t\t\t\telse if( fromMatches[key][ secondaryIndex ] ) {\n\t\t\t\t\tfromElement = fromMatches[key][ secondaryIndex ];\n\t\t\t\t\tfromMatches[key][ secondaryIndex ] = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If we've got a matching pair, push it to the list of pairs\n\t\t\tif( fromElement ) {\n\t\t\t\tpairs.push({\n\t\t\t\t\tfrom: fromElement,\n\t\t\t\t\tto: element,\n\t\t\t\t\toptions: animationOptions\n\t\t\t\t});\n\t\t\t}\n\t\t} );\n\n\t}\n\n\t/**\n\t * Returns a all elements within the given scope that should\n\t * be considered unmatched in an auto-animate transition. If\n\t * fading of unmatched elements is turned on, these elements\n\t * will fade when going between auto-animate slides.\n\t *\n\t * Note that parents of auto-animate targets are NOT considered\n\t * unmatched since fading them would break the auto-animation.\n\t *\n\t * @param {HTMLElement} rootElement\n\t * @return {Array}\n\t */\n\tgetUnmatchedAutoAnimateElements( rootElement ) {\n\n\t\treturn [].slice.call( rootElement.children ).reduce( ( result, element ) => {\n\n\t\t\tconst containsAnimatedElements = element.querySelector( '[data-auto-animate-target]' );\n\n\t\t\t// The element is unmatched if\n\t\t\t// - It is not an auto-animate target\n\t\t\t// - It does not contain any auto-animate targets\n\t\t\tif( !element.hasAttribute( 'data-auto-animate-target' ) && !containsAnimatedElements ) {\n\t\t\t\tresult.push( element );\n\t\t\t}\n\n\t\t\tif( element.querySelector( '[data-auto-animate-target]' ) ) {\n\t\t\t\tresult = result.concat( this.getUnmatchedAutoAnimateElements( element ) );\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t}, [] );\n\n\t}\n\n}\n","import { extend, queryAll } from '../utils/util.js'\n\n/**\n * Handles sorting and navigation of slide fragments.\n * Fragments are elements within a slide that are\n * revealed/animated incrementally.\n */\nexport default class Fragments {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tif( config.fragments === false ) {\n\t\t\tthis.disable();\n\t\t}\n\t\telse if( oldConfig.fragments === false ) {\n\t\t\tthis.enable();\n\t\t}\n\n\t}\n\n\t/**\n\t * If fragments are disabled in the deck, they should all be\n\t * visible rather than stepped through.\n\t */\n\tdisable() {\n\n\t\tqueryAll( this.Reveal.getSlidesElement(), '.fragment' ).forEach( element => {\n\t\t\telement.classList.add( 'visible' );\n\t\t\telement.classList.remove( 'current-fragment' );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Reverse of #disable(). Only called if fragments have\n\t * previously been disabled.\n\t */\n\tenable() {\n\n\t\tqueryAll( this.Reveal.getSlidesElement(), '.fragment' ).forEach( element => {\n\t\t\telement.classList.remove( 'visible' );\n\t\t\telement.classList.remove( 'current-fragment' );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Returns an object describing the available fragment\n\t * directions.\n\t *\n\t * @return {{prev: boolean, next: boolean}}\n\t */\n\tavailableRoutes() {\n\n\t\tlet currentSlide = this.Reveal.getCurrentSlide();\n\t\tif( currentSlide && this.Reveal.getConfig().fragments ) {\n\t\t\tlet fragments = currentSlide.querySelectorAll( '.fragment:not(.disabled)' );\n\t\t\tlet hiddenFragments = currentSlide.querySelectorAll( '.fragment:not(.disabled):not(.visible)' );\n\n\t\t\treturn {\n\t\t\t\tprev: fragments.length - hiddenFragments.length > 0,\n\t\t\t\tnext: !!hiddenFragments.length\n\t\t\t};\n\t\t}\n\t\telse {\n\t\t\treturn { prev: false, next: false };\n\t\t}\n\n\t}\n\n\t/**\n\t * Return a sorted fragments list, ordered by an increasing\n\t * \"data-fragment-index\" attribute.\n\t *\n\t * Fragments will be revealed in the order that they are returned by\n\t * this function, so you can use the index attributes to control the\n\t * order of fragment appearance.\n\t *\n\t * To maintain a sensible default fragment order, fragments are presumed\n\t * to be passed in document order. This function adds a \"fragment-index\"\n\t * attribute to each node if such an attribute is not already present,\n\t * and sets that attribute to an integer value which is the position of\n\t * the fragment within the fragments list.\n\t *\n\t * @param {object[]|*} fragments\n\t * @param {boolean} grouped If true the returned array will contain\n\t * nested arrays for all fragments with the same index\n\t * @return {object[]} sorted Sorted array of fragments\n\t */\n\tsort( fragments, grouped = false ) {\n\n\t\tfragments = Array.from( fragments );\n\n\t\tlet ordered = [],\n\t\t\tunordered = [],\n\t\t\tsorted = [];\n\n\t\t// Group ordered and unordered elements\n\t\tfragments.forEach( fragment => {\n\t\t\tif( fragment.hasAttribute( 'data-fragment-index' ) ) {\n\t\t\t\tlet index = parseInt( fragment.getAttribute( 'data-fragment-index' ), 10 );\n\n\t\t\t\tif( !ordered[index] ) {\n\t\t\t\t\tordered[index] = [];\n\t\t\t\t}\n\n\t\t\t\tordered[index].push( fragment );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tunordered.push( [ fragment ] );\n\t\t\t}\n\t\t} );\n\n\t\t// Append fragments without explicit indices in their\n\t\t// DOM order\n\t\tordered = ordered.concat( unordered );\n\n\t\t// Manually count the index up per group to ensure there\n\t\t// are no gaps\n\t\tlet index = 0;\n\n\t\t// Push all fragments in their sorted order to an array,\n\t\t// this flattens the groups\n\t\tordered.forEach( group => {\n\t\t\tgroup.forEach( fragment => {\n\t\t\t\tsorted.push( fragment );\n\t\t\t\tfragment.setAttribute( 'data-fragment-index', index );\n\t\t\t} );\n\n\t\t\tindex ++;\n\t\t} );\n\n\t\treturn grouped === true ? ordered : sorted;\n\n\t}\n\n\t/**\n\t * Sorts and formats all of fragments in the\n\t * presentation.\n\t */\n\tsortAll() {\n\n\t\tthis.Reveal.getHorizontalSlides().forEach( horizontalSlide => {\n\n\t\t\tlet verticalSlides = queryAll( horizontalSlide, 'section' );\n\t\t\tverticalSlides.forEach( ( verticalSlide, y ) => {\n\n\t\t\t\tthis.sort( verticalSlide.querySelectorAll( '.fragment' ) );\n\n\t\t\t}, this );\n\n\t\t\tif( verticalSlides.length === 0 ) this.sort( horizontalSlide.querySelectorAll( '.fragment' ) );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Refreshes the fragments on the current slide so that they\n\t * have the appropriate classes (.visible + .current-fragment).\n\t *\n\t * @param {number} [index] The index of the current fragment\n\t * @param {array} [fragments] Array containing all fragments\n\t * in the current slide\n\t *\n\t * @return {{shown: array, hidden: array}}\n\t */\n\tupdate( index, fragments ) {\n\n\t\tlet changedFragments = {\n\t\t\tshown: [],\n\t\t\thidden: []\n\t\t};\n\n\t\tlet currentSlide = this.Reveal.getCurrentSlide();\n\t\tif( currentSlide && this.Reveal.getConfig().fragments ) {\n\n\t\t\tfragments = fragments || this.sort( currentSlide.querySelectorAll( '.fragment' ) );\n\n\t\t\tif( fragments.length ) {\n\n\t\t\t\tlet maxIndex = 0;\n\n\t\t\t\tif( typeof index !== 'number' ) {\n\t\t\t\t\tlet currentFragment = this.sort( currentSlide.querySelectorAll( '.fragment.visible' ) ).pop();\n\t\t\t\t\tif( currentFragment ) {\n\t\t\t\t\t\tindex = parseInt( currentFragment.getAttribute( 'data-fragment-index' ) || 0, 10 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tArray.from( fragments ).forEach( ( el, i ) => {\n\n\t\t\t\t\tif( el.hasAttribute( 'data-fragment-index' ) ) {\n\t\t\t\t\t\ti = parseInt( el.getAttribute( 'data-fragment-index' ), 10 );\n\t\t\t\t\t}\n\n\t\t\t\t\tmaxIndex = Math.max( maxIndex, i );\n\n\t\t\t\t\t// Visible fragments\n\t\t\t\t\tif( i <= index ) {\n\t\t\t\t\t\tlet wasVisible = el.classList.contains( 'visible' )\n\t\t\t\t\t\tel.classList.add( 'visible' );\n\t\t\t\t\t\tel.classList.remove( 'current-fragment' );\n\n\t\t\t\t\t\tif( i === index ) {\n\t\t\t\t\t\t\t// Announce the fragments one by one to the Screen Reader\n\t\t\t\t\t\t\tthis.Reveal.announceStatus( this.Reveal.getStatusText( el ) );\n\n\t\t\t\t\t\t\tel.classList.add( 'current-fragment' );\n\t\t\t\t\t\t\tthis.Reveal.slideContent.startEmbeddedContent( el );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( !wasVisible ) {\n\t\t\t\t\t\t\tchangedFragments.shown.push( el )\n\t\t\t\t\t\t\tthis.Reveal.dispatchEvent({\n\t\t\t\t\t\t\t\ttarget: el,\n\t\t\t\t\t\t\t\ttype: 'visible',\n\t\t\t\t\t\t\t\tbubbles: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Hidden fragments\n\t\t\t\t\telse {\n\t\t\t\t\t\tlet wasVisible = el.classList.contains( 'visible' )\n\t\t\t\t\t\tel.classList.remove( 'visible' );\n\t\t\t\t\t\tel.classList.remove( 'current-fragment' );\n\n\t\t\t\t\t\tif( wasVisible ) {\n\t\t\t\t\t\t\tthis.Reveal.slideContent.stopEmbeddedContent( el );\n\t\t\t\t\t\t\tchangedFragments.hidden.push( el );\n\t\t\t\t\t\t\tthis.Reveal.dispatchEvent({\n\t\t\t\t\t\t\t\ttarget: el,\n\t\t\t\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\t\t\t\tbubbles: false\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\t// Write the current fragment index to the slide <section>.\n\t\t\t\t// This can be used by end users to apply styles based on\n\t\t\t\t// the current fragment index.\n\t\t\t\tindex = typeof index === 'number' ? index : -1;\n\t\t\t\tindex = Math.max( Math.min( index, maxIndex ), -1 );\n\t\t\t\tcurrentSlide.setAttribute( 'data-fragment', index );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn changedFragments;\n\n\t}\n\n\t/**\n\t * Formats the fragments on the given slide so that they have\n\t * valid indices. Call this if fragments are changed in the DOM\n\t * after reveal.js has already initialized.\n\t *\n\t * @param {HTMLElement} slide\n\t * @return {Array} a list of the HTML fragments that were synced\n\t */\n\tsync( slide = this.Reveal.getCurrentSlide() ) {\n\n\t\treturn this.sort( slide.querySelectorAll( '.fragment' ) );\n\n\t}\n\n\t/**\n\t * Navigate to the specified slide fragment.\n\t *\n\t * @param {?number} index The index of the fragment that\n\t * should be shown, -1 means all are invisible\n\t * @param {number} offset Integer offset to apply to the\n\t * fragment index\n\t *\n\t * @return {boolean} true if a change was made in any\n\t * fragments visibility as part of this call\n\t */\n\tgoto( index, offset = 0 ) {\n\n\t\tlet currentSlide = this.Reveal.getCurrentSlide();\n\t\tif( currentSlide && this.Reveal.getConfig().fragments ) {\n\n\t\t\tlet fragments = this.sort( currentSlide.querySelectorAll( '.fragment:not(.disabled)' ) );\n\t\t\tif( fragments.length ) {\n\n\t\t\t\t// If no index is specified, find the current\n\t\t\t\tif( typeof index !== 'number' ) {\n\t\t\t\t\tlet lastVisibleFragment = this.sort( currentSlide.querySelectorAll( '.fragment:not(.disabled).visible' ) ).pop();\n\n\t\t\t\t\tif( lastVisibleFragment ) {\n\t\t\t\t\t\tindex = parseInt( lastVisibleFragment.getAttribute( 'data-fragment-index' ) || 0, 10 );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tindex = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Apply the offset if there is one\n\t\t\t\tindex += offset;\n\n\t\t\t\tlet changedFragments = this.update( index, fragments );\n\n\t\t\t\tif( changedFragments.hidden.length ) {\n\t\t\t\t\tthis.Reveal.dispatchEvent({\n\t\t\t\t\t\ttype: 'fragmenthidden',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tfragment: changedFragments.hidden[0],\n\t\t\t\t\t\t\tfragments: changedFragments.hidden\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif( changedFragments.shown.length ) {\n\t\t\t\t\tthis.Reveal.dispatchEvent({\n\t\t\t\t\t\ttype: 'fragmentshown',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tfragment: changedFragments.shown[0],\n\t\t\t\t\t\t\tfragments: changedFragments.shown\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.Reveal.controls.update();\n\t\t\t\tthis.Reveal.progress.update();\n\n\t\t\t\tif( this.Reveal.getConfig().fragmentInURL ) {\n\t\t\t\t\tthis.Reveal.location.writeURL();\n\t\t\t\t}\n\n\t\t\t\treturn !!( changedFragments.shown.length || changedFragments.hidden.length );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t/**\n\t * Navigate to the next slide fragment.\n\t *\n\t * @return {boolean} true if there was a next fragment,\n\t * false otherwise\n\t */\n\tnext() {\n\n\t\treturn this.goto( null, 1 );\n\n\t}\n\n\t/**\n\t * Navigate to the previous slide fragment.\n\t *\n\t * @return {boolean} true if there was a previous fragment,\n\t * false otherwise\n\t */\n\tprev() {\n\n\t\treturn this.goto( null, -1 );\n\n\t}\n\n}","import { SLIDES_SELECTOR } from '../utils/constants.js'\nimport { extend, queryAll, transformElement } from '../utils/util.js'\n\n/**\n * Handles all logic related to the overview mode\n * (birds-eye view of all slides).\n */\nexport default class Overview {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\tthis.active = false;\n\n\t\tthis.onSlideClicked = this.onSlideClicked.bind( this );\n\n\t}\n\n\t/**\n\t * Displays the overview of slides (quick nav) by scaling\n\t * down and arranging all slide elements.\n\t */\n\tactivate() {\n\n\t\t// Only proceed if enabled in config\n\t\tif( this.Reveal.getConfig().overview && !this.isActive() ) {\n\n\t\t\tthis.active = true;\n\n\t\t\tthis.Reveal.getRevealElement().classList.add( 'overview' );\n\n\t\t\t// Don't auto-slide while in overview mode\n\t\t\tthis.Reveal.cancelAutoSlide();\n\n\t\t\t// Move the backgrounds element into the slide container to\n\t\t\t// that the same scaling is applied\n\t\t\tthis.Reveal.getSlidesElement().appendChild( this.Reveal.getBackgroundsElement() );\n\n\t\t\t// Clicking on an overview slide navigates to it\n\t\t\tqueryAll( this.Reveal.getRevealElement(), SLIDES_SELECTOR ).forEach( slide => {\n\t\t\t\tif( !slide.classList.contains( 'stack' ) ) {\n\t\t\t\t\tslide.addEventListener( 'click', this.onSlideClicked, true );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Calculate slide sizes\n\t\t\tconst margin = 70;\n\t\t\tconst slideSize = this.Reveal.getComputedSlideSize();\n\t\t\tthis.overviewSlideWidth = slideSize.width + margin;\n\t\t\tthis.overviewSlideHeight = slideSize.height + margin;\n\n\t\t\t// Reverse in RTL mode\n\t\t\tif( this.Reveal.getConfig().rtl ) {\n\t\t\t\tthis.overviewSlideWidth = -this.overviewSlideWidth;\n\t\t\t}\n\n\t\t\tthis.Reveal.updateSlidesVisibility();\n\n\t\t\tthis.layout();\n\t\t\tthis.update();\n\n\t\t\tthis.Reveal.layout();\n\n\t\t\tconst indices = this.Reveal.getIndices();\n\n\t\t\t// Notify observers of the overview showing\n\t\t\tthis.Reveal.dispatchEvent({\n\t\t\t\ttype: 'overviewshown',\n\t\t\t\tdata: {\n\t\t\t\t\t'indexh': indices.h,\n\t\t\t\t\t'indexv': indices.v,\n\t\t\t\t\t'currentSlide': this.Reveal.getCurrentSlide()\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Uses CSS transforms to position all slides in a grid for\n\t * display inside of the overview mode.\n\t */\n\tlayout() {\n\n\t\t// Layout slides\n\t\tthis.Reveal.getHorizontalSlides().forEach( ( hslide, h ) => {\n\t\t\thslide.setAttribute( 'data-index-h', h );\n\t\t\ttransformElement( hslide, 'translate3d(' + ( h * this.overviewSlideWidth ) + 'px, 0, 0)' );\n\n\t\t\tif( hslide.classList.contains( 'stack' ) ) {\n\n\t\t\t\tqueryAll( hslide, 'section' ).forEach( ( vslide, v ) => {\n\t\t\t\t\tvslide.setAttribute( 'data-index-h', h );\n\t\t\t\t\tvslide.setAttribute( 'data-index-v', v );\n\n\t\t\t\t\ttransformElement( vslide, 'translate3d(0, ' + ( v * this.overviewSlideHeight ) + 'px, 0)' );\n\t\t\t\t} );\n\n\t\t\t}\n\t\t} );\n\n\t\t// Layout slide backgrounds\n\t\tArray.from( this.Reveal.getBackgroundsElement().childNodes ).forEach( ( hbackground, h ) => {\n\t\t\ttransformElement( hbackground, 'translate3d(' + ( h * this.overviewSlideWidth ) + 'px, 0, 0)' );\n\n\t\t\tqueryAll( hbackground, '.slide-background' ).forEach( ( vbackground, v ) => {\n\t\t\t\ttransformElement( vbackground, 'translate3d(0, ' + ( v * this.overviewSlideHeight ) + 'px, 0)' );\n\t\t\t} );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Moves the overview viewport to the current slides.\n\t * Called each time the current slide changes.\n\t */\n\tupdate() {\n\n\t\tconst vmin = Math.min( window.innerWidth, window.innerHeight );\n\t\tconst scale = Math.max( vmin / 5, 150 ) / vmin;\n\t\tconst indices = this.Reveal.getIndices();\n\n\t\tthis.Reveal.transformSlides( {\n\t\t\toverview: [\n\t\t\t\t'scale('+ scale +')',\n\t\t\t\t'translateX('+ ( -indices.h * this.overviewSlideWidth ) +'px)',\n\t\t\t\t'translateY('+ ( -indices.v * this.overviewSlideHeight ) +'px)'\n\t\t\t].join( ' ' )\n\t\t} );\n\n\t}\n\n\t/**\n\t * Exits the slide overview and enters the currently\n\t * active slide.\n\t */\n\tdeactivate() {\n\n\t\t// Only proceed if enabled in config\n\t\tif( this.Reveal.getConfig().overview ) {\n\n\t\t\tthis.active = false;\n\n\t\t\tthis.Reveal.getRevealElement().classList.remove( 'overview' );\n\n\t\t\t// Temporarily add a class so that transitions can do different things\n\t\t\t// depending on whether they are exiting/entering overview, or just\n\t\t\t// moving from slide to slide\n\t\t\tthis.Reveal.getRevealElement().classList.add( 'overview-deactivating' );\n\n\t\t\tsetTimeout( () => {\n\t\t\t\tthis.Reveal.getRevealElement().classList.remove( 'overview-deactivating' );\n\t\t\t}, 1 );\n\n\t\t\t// Move the background element back out\n\t\t\tthis.Reveal.getRevealElement().appendChild( this.Reveal.getBackgroundsElement() );\n\n\t\t\t// Clean up changes made to slides\n\t\t\tqueryAll( this.Reveal.getRevealElement(), SLIDES_SELECTOR ).forEach( slide => {\n\t\t\t\ttransformElement( slide, '' );\n\n\t\t\t\tslide.removeEventListener( 'click', this.onSlideClicked, true );\n\t\t\t} );\n\n\t\t\t// Clean up changes made to backgrounds\n\t\t\tqueryAll( this.Reveal.getBackgroundsElement(), '.slide-background' ).forEach( background => {\n\t\t\t\ttransformElement( background, '' );\n\t\t\t} );\n\n\t\t\tthis.Reveal.transformSlides( { overview: '' } );\n\n\t\t\tconst indices = this.Reveal.getIndices();\n\n\t\t\tthis.Reveal.slide( indices.h, indices.v );\n\t\t\tthis.Reveal.layout();\n\t\t\tthis.Reveal.cueAutoSlide();\n\n\t\t\t// Notify observers of the overview hiding\n\t\t\tthis.Reveal.dispatchEvent({\n\t\t\t\ttype: 'overviewhidden',\n\t\t\t\tdata: {\n\t\t\t\t\t'indexh': indices.h,\n\t\t\t\t\t'indexv': indices.v,\n\t\t\t\t\t'currentSlide': this.Reveal.getCurrentSlide()\n\t\t\t\t}\n\t\t\t});\n\n\t\t}\n\t}\n\n\t/**\n\t * Toggles the slide overview mode on and off.\n\t *\n\t * @param {Boolean} [override] Flag which overrides the\n\t * toggle logic and forcibly sets the desired state. True means\n\t * overview is open, false means it's closed.\n\t */\n\ttoggle( override ) {\n\n\t\tif( typeof override === 'boolean' ) {\n\t\t\toverride ? this.activate() : this.deactivate();\n\t\t}\n\t\telse {\n\t\t\tthis.isActive() ? this.deactivate() : this.activate();\n\t\t}\n\n\t}\n\n\t/**\n\t * Checks if the overview is currently active.\n\t *\n\t * @return {Boolean} true if the overview is active,\n\t * false otherwise\n\t */\n\tisActive() {\n\n\t\treturn this.active;\n\n\t}\n\n\t/**\n\t * Invoked when a slide is and we're in the overview.\n\t *\n\t * @param {object} event\n\t */\n\tonSlideClicked( event ) {\n\n\t\tif( this.isActive() ) {\n\t\t\tevent.preventDefault();\n\n\t\t\tlet element = event.target;\n\n\t\t\twhile( element && !element.nodeName.match( /section/gi ) ) {\n\t\t\t\telement = element.parentNode;\n\t\t\t}\n\n\t\t\tif( element && !element.classList.contains( 'disabled' ) ) {\n\n\t\t\t\tthis.deactivate();\n\n\t\t\t\tif( element.nodeName.match( /section/gi ) ) {\n\t\t\t\t\tlet h = parseInt( element.getAttribute( 'data-index-h' ), 10 ),\n\t\t\t\t\t\tv = parseInt( element.getAttribute( 'data-index-v' ), 10 );\n\n\t\t\t\t\tthis.Reveal.slide( h, v );\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t}\n\n}","import { enterFullscreen } from '../utils/util.js'\n\n/**\n * Handles all reveal.js keyboard interactions.\n */\nexport default class Keyboard {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\t// A key:value map of keyboard keys and descriptions of\n\t\t// the actions they trigger\n\t\tthis.shortcuts = {};\n\n\t\t// Holds custom key code mappings\n\t\tthis.bindings = {};\n\n\t\tthis.onDocumentKeyDown = this.onDocumentKeyDown.bind( this );\n\t\tthis.onDocumentKeyPress = this.onDocumentKeyPress.bind( this );\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tif( config.navigationMode === 'linear' ) {\n\t\t\tthis.shortcuts['&#8594;  ,  &#8595;  ,  SPACE  ,  N  ,  L  ,  J'] = 'Next slide';\n\t\t\tthis.shortcuts['&#8592;  ,  &#8593;  ,  P  ,  H  ,  K']           = 'Previous slide';\n\t\t}\n\t\telse {\n\t\t\tthis.shortcuts['N  ,  SPACE']   = 'Next slide';\n\t\t\tthis.shortcuts['P  ,  Shift SPACE']             = 'Previous slide';\n\t\t\tthis.shortcuts['&#8592;  ,  H'] = 'Navigate left';\n\t\t\tthis.shortcuts['&#8594;  ,  L'] = 'Navigate right';\n\t\t\tthis.shortcuts['&#8593;  ,  K'] = 'Navigate up';\n\t\t\tthis.shortcuts['&#8595;  ,  J'] = 'Navigate down';\n\t\t}\n\n\t\tthis.shortcuts['Alt + &#8592;/&#8593/&#8594;/&#8595;']        = 'Navigate without fragments';\n\t\tthis.shortcuts['Shift + &#8592;/&#8593/&#8594;/&#8595;']      = 'Jump to first/last slide';\n\t\tthis.shortcuts['B  ,  .']                       = 'Pause';\n\t\tthis.shortcuts['F']                             = 'Fullscreen';\n\t\tthis.shortcuts['G']                             = 'Jump to slide';\n\t\tthis.shortcuts['ESC, O']                        = 'Slide overview';\n\n\t}\n\n\t/**\n\t * Starts listening for keyboard events.\n\t */\n\tbind() {\n\n\t\tdocument.addEventListener( 'keydown', this.onDocumentKeyDown, false );\n\t\tdocument.addEventListener( 'keypress', this.onDocumentKeyPress, false );\n\n\t}\n\n\t/**\n\t * Stops listening for keyboard events.\n\t */\n\tunbind() {\n\n\t\tdocument.removeEventListener( 'keydown', this.onDocumentKeyDown, false );\n\t\tdocument.removeEventListener( 'keypress', this.onDocumentKeyPress, false );\n\n\t}\n\n\t/**\n\t * Add a custom key binding with optional description to\n\t * be added to the help screen.\n\t */\n\taddKeyBinding( binding, callback ) {\n\n\t\tif( typeof binding === 'object' && binding.keyCode ) {\n\t\t\tthis.bindings[binding.keyCode] = {\n\t\t\t\tcallback: callback,\n\t\t\t\tkey: binding.key,\n\t\t\t\tdescription: binding.description\n\t\t\t};\n\t\t}\n\t\telse {\n\t\t\tthis.bindings[binding] = {\n\t\t\t\tcallback: callback,\n\t\t\t\tkey: null,\n\t\t\t\tdescription: null\n\t\t\t};\n\t\t}\n\n\t}\n\n\t/**\n\t * Removes the specified custom key binding.\n\t */\n\tremoveKeyBinding( keyCode ) {\n\n\t\tdelete this.bindings[keyCode];\n\n\t}\n\n\t/**\n\t * Programmatically triggers a keyboard event\n\t *\n\t * @param {int} keyCode\n\t */\n\ttriggerKey( keyCode ) {\n\n\t\tthis.onDocumentKeyDown( { keyCode } );\n\n\t}\n\n\t/**\n\t * Registers a new shortcut to include in the help overlay\n\t *\n\t * @param {String} key\n\t * @param {String} value\n\t */\n\tregisterKeyboardShortcut( key, value ) {\n\n\t\tthis.shortcuts[key] = value;\n\n\t}\n\n\tgetShortcuts() {\n\n\t\treturn this.shortcuts;\n\n\t}\n\n\tgetBindings() {\n\n\t\treturn this.bindings;\n\n\t}\n\n\t/**\n\t * Handler for the document level 'keypress' event.\n\t *\n\t * @param {object} event\n\t */\n\tonDocumentKeyPress( event ) {\n\n\t\t// Check if the pressed key is question mark\n\t\tif( event.shiftKey && event.charCode === 63 ) {\n\t\t\tthis.Reveal.toggleHelp();\n\t\t}\n\n\t}\n\n\t/**\n\t * Handler for the document level 'keydown' event.\n\t *\n\t * @param {object} event\n\t */\n\tonDocumentKeyDown( event ) {\n\n\t\tlet config = this.Reveal.getConfig();\n\n\t\t// If there's a condition specified and it returns false,\n\t\t// ignore this event\n\t\tif( typeof config.keyboardCondition === 'function' && config.keyboardCondition(event) === false ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// If keyboardCondition is set, only capture keyboard events\n\t\t// for embedded decks when they are focused\n\t\tif( config.keyboardCondition === 'focused' && !this.Reveal.isFocused() ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Shorthand\n\t\tlet keyCode = event.keyCode;\n\n\t\t// Remember if auto-sliding was paused so we can toggle it\n\t\tlet autoSlideWasPaused = !this.Reveal.isAutoSliding();\n\n\t\tthis.Reveal.onUserInput( event );\n\n\t\t// Is there a focused element that could be using the keyboard?\n\t\tlet activeElementIsCE = document.activeElement && document.activeElement.isContentEditable === true;\n\t\tlet activeElementIsInput = document.activeElement && document.activeElement.tagName && /input|textarea/i.test( document.activeElement.tagName );\n\t\tlet activeElementIsNotes = document.activeElement && document.activeElement.className && /speaker-notes/i.test( document.activeElement.className);\n\n\t\t// Whitelist certain modifiers for slide navigation shortcuts\n\t\tlet isNavigationKey = [32, 37, 38, 39, 40, 78, 80].indexOf( event.keyCode ) !== -1;\n\n\t\t// Prevent all other events when a modifier is pressed\n\t\tlet unusedModifier = \t!( isNavigationKey && event.shiftKey || event.altKey ) &&\n\t\t\t\t\t\t\t\t( event.shiftKey || event.altKey || event.ctrlKey || event.metaKey );\n\n\t\t// Disregard the event if there's a focused element or a\n\t\t// keyboard modifier key is present\n\t\tif( activeElementIsCE || activeElementIsInput || activeElementIsNotes || unusedModifier ) return;\n\n\t\t// While paused only allow resume keyboard events; 'b', 'v', '.'\n\t\tlet resumeKeyCodes = [66,86,190,191];\n\t\tlet key;\n\n\t\t// Custom key bindings for togglePause should be able to resume\n\t\tif( typeof config.keyboard === 'object' ) {\n\t\t\tfor( key in config.keyboard ) {\n\t\t\t\tif( config.keyboard[key] === 'togglePause' ) {\n\t\t\t\t\tresumeKeyCodes.push( parseInt( key, 10 ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( this.Reveal.isPaused() && resumeKeyCodes.indexOf( keyCode ) === -1 ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Use linear navigation if we're configured to OR if\n\t\t// the presentation is one-dimensional\n\t\tlet useLinearMode = config.navigationMode === 'linear' || !this.Reveal.hasHorizontalSlides() || !this.Reveal.hasVerticalSlides();\n\n\t\tlet triggered = false;\n\n\t\t// 1. User defined key bindings\n\t\tif( typeof config.keyboard === 'object' ) {\n\n\t\t\tfor( key in config.keyboard ) {\n\n\t\t\t\t// Check if this binding matches the pressed key\n\t\t\t\tif( parseInt( key, 10 ) === keyCode ) {\n\n\t\t\t\t\tlet value = config.keyboard[ key ];\n\n\t\t\t\t\t// Callback function\n\t\t\t\t\tif( typeof value === 'function' ) {\n\t\t\t\t\t\tvalue.apply( null, [ event ] );\n\t\t\t\t\t}\n\t\t\t\t\t// String shortcuts to reveal.js API\n\t\t\t\t\telse if( typeof value === 'string' && typeof this.Reveal[ value ] === 'function' ) {\n\t\t\t\t\t\tthis.Reveal[ value ].call();\n\t\t\t\t\t}\n\n\t\t\t\t\ttriggered = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// 2. Registered custom key bindings\n\t\tif( triggered === false ) {\n\n\t\t\tfor( key in this.bindings ) {\n\n\t\t\t\t// Check if this binding matches the pressed key\n\t\t\t\tif( parseInt( key, 10 ) === keyCode ) {\n\n\t\t\t\t\tlet action = this.bindings[ key ].callback;\n\n\t\t\t\t\t// Callback function\n\t\t\t\t\tif( typeof action === 'function' ) {\n\t\t\t\t\t\taction.apply( null, [ event ] );\n\t\t\t\t\t}\n\t\t\t\t\t// String shortcuts to reveal.js API\n\t\t\t\t\telse if( typeof action === 'string' && typeof this.Reveal[ action ] === 'function' ) {\n\t\t\t\t\t\tthis.Reveal[ action ].call();\n\t\t\t\t\t}\n\n\t\t\t\t\ttriggered = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// 3. System defined key bindings\n\t\tif( triggered === false ) {\n\n\t\t\t// Assume true and try to prove false\n\t\t\ttriggered = true;\n\n\t\t\t// P, PAGE UP\n\t\t\tif( keyCode === 80 || keyCode === 33 ) {\n\t\t\t\tthis.Reveal.prev({skipFragments: event.altKey});\n\t\t\t}\n\t\t\t// N, PAGE DOWN\n\t\t\telse if( keyCode === 78 || keyCode === 34 ) {\n\t\t\t\tthis.Reveal.next({skipFragments: event.altKey});\n\t\t\t}\n\t\t\t// H, LEFT\n\t\t\telse if( keyCode === 72 || keyCode === 37 ) {\n\t\t\t\tif( event.shiftKey ) {\n\t\t\t\t\tthis.Reveal.slide( 0 );\n\t\t\t\t}\n\t\t\t\telse if( !this.Reveal.overview.isActive() && useLinearMode ) {\n\t\t\t\t\tthis.Reveal.prev({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.Reveal.left({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// L, RIGHT\n\t\t\telse if( keyCode === 76 || keyCode === 39 ) {\n\t\t\t\tif( event.shiftKey ) {\n\t\t\t\t\tthis.Reveal.slide( this.Reveal.getHorizontalSlides().length - 1 );\n\t\t\t\t}\n\t\t\t\telse if( !this.Reveal.overview.isActive() && useLinearMode ) {\n\t\t\t\t\tthis.Reveal.next({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.Reveal.right({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// K, UP\n\t\t\telse if( keyCode === 75 || keyCode === 38 ) {\n\t\t\t\tif( event.shiftKey ) {\n\t\t\t\t\tthis.Reveal.slide( undefined, 0 );\n\t\t\t\t}\n\t\t\t\telse if( !this.Reveal.overview.isActive() && useLinearMode ) {\n\t\t\t\t\tthis.Reveal.prev({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.Reveal.up({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// J, DOWN\n\t\t\telse if( keyCode === 74 || keyCode === 40 ) {\n\t\t\t\tif( event.shiftKey ) {\n\t\t\t\t\tthis.Reveal.slide( undefined, Number.MAX_VALUE );\n\t\t\t\t}\n\t\t\t\telse if( !this.Reveal.overview.isActive() && useLinearMode ) {\n\t\t\t\t\tthis.Reveal.next({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.Reveal.down({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// HOME\n\t\t\telse if( keyCode === 36 ) {\n\t\t\t\tthis.Reveal.slide( 0 );\n\t\t\t}\n\t\t\t// END\n\t\t\telse if( keyCode === 35 ) {\n\t\t\t\tthis.Reveal.slide( this.Reveal.getHorizontalSlides().length - 1 );\n\t\t\t}\n\t\t\t// SPACE\n\t\t\telse if( keyCode === 32 ) {\n\t\t\t\tif( this.Reveal.overview.isActive() ) {\n\t\t\t\t\tthis.Reveal.overview.deactivate();\n\t\t\t\t}\n\t\t\t\tif( event.shiftKey ) {\n\t\t\t\t\tthis.Reveal.prev({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.Reveal.next({skipFragments: event.altKey});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// TWO-SPOT, SEMICOLON, B, V, PERIOD, LOGITECH PRESENTER TOOLS \"BLACK SCREEN\" BUTTON\n\t\t\telse if( keyCode === 58 || keyCode === 59 || keyCode === 66 || keyCode === 86 || keyCode === 190 || keyCode === 191 ) {\n\t\t\t\tthis.Reveal.togglePause();\n\t\t\t}\n\t\t\t// F\n\t\t\telse if( keyCode === 70 ) {\n\t\t\t\tenterFullscreen( config.embedded ? this.Reveal.getViewportElement() : document.documentElement );\n\t\t\t}\n\t\t\t// A\n\t\t\telse if( keyCode === 65 ) {\n\t\t\t\tif ( config.autoSlideStoppable ) {\n\t\t\t\t\tthis.Reveal.toggleAutoSlide( autoSlideWasPaused );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// G\n\t\t\telse if( keyCode === 71 ) {\n\t\t\t\tif ( config.jumpToSlide ) {\n\t\t\t\t\tthis.Reveal.toggleJumpToSlide();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttriggered = false;\n\t\t\t}\n\n\t\t}\n\n\t\t// If the input resulted in a triggered action we should prevent\n\t\t// the browsers default behavior\n\t\tif( triggered ) {\n\t\t\tevent.preventDefault && event.preventDefault();\n\t\t}\n\t\t// ESC or O key\n\t\telse if( keyCode === 27 || keyCode === 79 ) {\n\t\t\tif( this.Reveal.closeOverlay() === false ) {\n\t\t\t\tthis.Reveal.overview.toggle();\n\t\t\t}\n\n\t\t\tevent.preventDefault && event.preventDefault();\n\t\t}\n\n\t\t// If auto-sliding is enabled we need to cue up\n\t\t// another timeout\n\t\tthis.Reveal.cueAutoSlide();\n\n\t}\n\n}","/**\n * Reads and writes the URL based on reveal.js' current state.\n */\nexport default class Location {\n\n\t// The minimum number of milliseconds that must pass between\n\t// calls to history.replaceState\n\tMAX_REPLACE_STATE_FREQUENCY = 1000\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\t// Delays updates to the URL due to a Chrome thumbnailer bug\n\t\tthis.writeURLTimeout = 0;\n\n\t\tthis.replaceStateTimestamp = 0;\n\n\t\tthis.onWindowHashChange = this.onWindowHashChange.bind( this );\n\n\t}\n\n\tbind() {\n\n\t\twindow.addEventListener( 'hashchange', this.onWindowHashChange, false );\n\n\t}\n\n\tunbind() {\n\n\t\twindow.removeEventListener( 'hashchange', this.onWindowHashChange, false );\n\n\t}\n\n\t/**\n\t * Returns the slide indices for the given hash link.\n\t *\n\t * @param {string} [hash] the hash string that we want to\n\t * find the indices for\n\t *\n\t * @returns slide indices or null\n\t */\n\tgetIndicesFromHash( hash=window.location.hash, options={} ) {\n\n\t\t// Attempt to parse the hash as either an index or name\n\t\tlet name = hash.replace( /^#\\/?/, '' );\n\t\tlet bits = name.split( '/' );\n\n\t\t// If the first bit is not fully numeric and there is a name we\n\t\t// can assume that this is a named link\n\t\tif( !/^[0-9]*$/.test( bits[0] ) && name.length ) {\n\t\t\tlet slide;\n\n\t\t\tlet f;\n\n\t\t\t// Parse named links with fragments (#/named-link/2)\n\t\t\tif( /\\/[-\\d]+$/g.test( name ) ) {\n\t\t\t\tf = parseInt( name.split( '/' ).pop(), 10 );\n\t\t\t\tf = isNaN(f) ? undefined : f;\n\t\t\t\tname = name.split( '/' ).shift();\n\t\t\t}\n\n\t\t\t// Ensure the named link is a valid HTML ID attribute\n\t\t\ttry {\n\t\t\t\tslide = document\n\t\t\t\t\t.getElementById( decodeURIComponent( name ) )\n\t\t\t\t\t.closest('.slides>section, .slides>section>section');\n\t\t\t}\n\t\t\tcatch ( error ) { }\n\n\t\t\tif( slide ) {\n\t\t\t\treturn { ...this.Reveal.getIndices( slide ), f };\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tconst config = this.Reveal.getConfig();\n\t\t\tlet hashIndexBase = config.hashOneBasedIndex || options.oneBasedIndex ? 1 : 0;\n\n\t\t\t// Read the index components of the hash\n\t\t\tlet h = ( parseInt( bits[0], 10 ) - hashIndexBase ) || 0,\n\t\t\t\tv = ( parseInt( bits[1], 10 ) - hashIndexBase ) || 0,\n\t\t\t\tf;\n\n\t\t\tif( config.fragmentInURL ) {\n\t\t\t\tf = parseInt( bits[2], 10 );\n\t\t\t\tif( isNaN( f ) ) {\n\t\t\t\t\tf = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { h, v, f };\n\t\t}\n\n\t\t// The hash couldn't be parsed or no matching named link was found\n\t\treturn null\n\n\t}\n\n\t/**\n\t * Reads the current URL (hash) and navigates accordingly.\n\t */\n\treadURL() {\n\n\t\tconst currentIndices = this.Reveal.getIndices();\n\t\tconst newIndices = this.getIndicesFromHash();\n\n\t\tif( newIndices ) {\n\t\t\tif( ( newIndices.h !== currentIndices.h || newIndices.v !== currentIndices.v || newIndices.f !== undefined ) ) {\n\t\t\t\t\tthis.Reveal.slide( newIndices.h, newIndices.v, newIndices.f );\n\t\t\t}\n\t\t}\n\t\t// If no new indices are available, we're trying to navigate to\n\t\t// a slide hash that does not exist\n\t\telse {\n\t\t\tthis.Reveal.slide( currentIndices.h || 0, currentIndices.v || 0 );\n\t\t}\n\n\t}\n\n\t/**\n\t * Updates the page URL (hash) to reflect the current\n\t * state.\n\t *\n\t * @param {number} delay The time in ms to wait before\n\t * writing the hash\n\t */\n\twriteURL( delay ) {\n\n\t\tlet config = this.Reveal.getConfig();\n\t\tlet currentSlide = this.Reveal.getCurrentSlide();\n\n\t\t// Make sure there's never more than one timeout running\n\t\tclearTimeout( this.writeURLTimeout );\n\n\t\t// If a delay is specified, timeout this call\n\t\tif( typeof delay === 'number' ) {\n\t\t\tthis.writeURLTimeout = setTimeout( this.writeURL, delay );\n\t\t}\n\t\telse if( currentSlide ) {\n\n\t\t\tlet hash = this.getHash();\n\n\t\t\t// If we're configured to push to history OR the history\n\t\t\t// API is not available.\n\t\t\tif( config.history ) {\n\t\t\t\twindow.location.hash = hash;\n\t\t\t}\n\t\t\t// If we're configured to reflect the current slide in the\n\t\t\t// URL without pushing to history.\n\t\t\telse if( config.hash ) {\n\t\t\t\t// If the hash is empty, don't add it to the URL\n\t\t\t\tif( hash === '/' ) {\n\t\t\t\t\tthis.debouncedReplaceState( window.location.pathname + window.location.search );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.debouncedReplaceState( '#' + hash );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// UPDATE: The below nuking of all hash changes breaks\n\t\t\t// anchors on pages where reveal.js is running. Removed\n\t\t\t// in 4.0. Why was it here in the first place? \\_()_/\n\t\t\t//\n\t\t\t// If history and hash are both disabled, a hash may still\n\t\t\t// be added to the URL by clicking on a href with a hash\n\t\t\t// target. Counter this by always removing the hash.\n\t\t\t// else {\n\t\t\t// \twindow.history.replaceState( null, null, window.location.pathname + window.location.search );\n\t\t\t// }\n\n\t\t}\n\n\t}\n\n\treplaceState( url ) {\n\n\t\twindow.history.replaceState( null, null, url );\n\t\tthis.replaceStateTimestamp = Date.now();\n\n\t}\n\n\tdebouncedReplaceState( url ) {\n\n\t\tclearTimeout( this.replaceStateTimeout );\n\n\t\tif( Date.now() - this.replaceStateTimestamp > this.MAX_REPLACE_STATE_FREQUENCY ) {\n\t\t\tthis.replaceState( url );\n\t\t}\n\t\telse {\n\t\t\tthis.replaceStateTimeout = setTimeout( () => this.replaceState( url ), this.MAX_REPLACE_STATE_FREQUENCY );\n\t\t}\n\n\t}\n\n\t/**\n\t * Return a hash URL that will resolve to the given slide location.\n\t *\n\t * @param {HTMLElement} [slide=currentSlide] The slide to link to\n\t */\n\tgetHash( slide ) {\n\n\t\tlet url = '/';\n\n\t\t// Attempt to create a named link based on the slide's ID\n\t\tlet s = slide || this.Reveal.getCurrentSlide();\n\t\tlet id = s ? s.getAttribute( 'id' ) : null;\n\t\tif( id ) {\n\t\t\tid = encodeURIComponent( id );\n\t\t}\n\n\t\tlet index = this.Reveal.getIndices( slide );\n\t\tif( !this.Reveal.getConfig().fragmentInURL ) {\n\t\t\tindex.f = undefined;\n\t\t}\n\n\t\t// If the current slide has an ID, use that as a named link,\n\t\t// but we don't support named links with a fragment index\n\t\tif( typeof id === 'string' && id.length ) {\n\t\t\turl = '/' + id;\n\n\t\t\t// If there is also a fragment, append that at the end\n\t\t\t// of the named link, like: #/named-link/2\n\t\t\tif( index.f >= 0 ) url += '/' + index.f;\n\t\t}\n\t\t// Otherwise use the /h/v index\n\t\telse {\n\t\t\tlet hashIndexBase = this.Reveal.getConfig().hashOneBasedIndex ? 1 : 0;\n\t\t\tif( index.h > 0 || index.v > 0 || index.f >= 0 ) url += index.h + hashIndexBase;\n\t\t\tif( index.v > 0 || index.f >= 0 ) url += '/' + (index.v + hashIndexBase );\n\t\t\tif( index.f >= 0 ) url += '/' + index.f;\n\t\t}\n\n\t\treturn url;\n\n\t}\n\n\t/**\n\t * Handler for the window level 'hashchange' event.\n\t *\n\t * @param {object} [event]\n\t */\n\tonWindowHashChange( event ) {\n\n\t\tthis.readURL();\n\n\t}\n\n}","import { queryAll } from '../utils/util.js'\nimport { isAndroid } from '../utils/device.js'\n\n/**\n * Manages our presentation controls. This includes both\n * the built-in control arrows as well as event monitoring\n * of any elements within the presentation with either of the\n * following helper classes:\n * - .navigate-up\n * - .navigate-right\n * - .navigate-down\n * - .navigate-left\n * - .navigate-next\n * - .navigate-prev\n */\nexport default class Controls {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\tthis.onNavigateLeftClicked = this.onNavigateLeftClicked.bind( this );\n\t\tthis.onNavigateRightClicked = this.onNavigateRightClicked.bind( this );\n\t\tthis.onNavigateUpClicked = this.onNavigateUpClicked.bind( this );\n\t\tthis.onNavigateDownClicked = this.onNavigateDownClicked.bind( this );\n\t\tthis.onNavigatePrevClicked = this.onNavigatePrevClicked.bind( this );\n\t\tthis.onNavigateNextClicked = this.onNavigateNextClicked.bind( this );\n\n\t}\n\n\trender() {\n\n\t\tconst rtl = this.Reveal.getConfig().rtl;\n\t\tconst revealElement = this.Reveal.getRevealElement();\n\n\t\tthis.element = document.createElement( 'aside' );\n\t\tthis.element.className = 'controls';\n\t\tthis.element.innerHTML =\n\t\t\t`<button class=\"navigate-left\" aria-label=\"${ rtl ? 'next slide' : 'previous slide' }\"><div class=\"controls-arrow\"></div></button>\n\t\t\t<button class=\"navigate-right\" aria-label=\"${ rtl ? 'previous slide' : 'next slide' }\"><div class=\"controls-arrow\"></div></button>\n\t\t\t<button class=\"navigate-up\" aria-label=\"above slide\"><div class=\"controls-arrow\"></div></button>\n\t\t\t<button class=\"navigate-down\" aria-label=\"below slide\"><div class=\"controls-arrow\"></div></button>`;\n\n\t\tthis.Reveal.getRevealElement().appendChild( this.element );\n\n\t\t// There can be multiple instances of controls throughout the page\n\t\tthis.controlsLeft = queryAll( revealElement, '.navigate-left' );\n\t\tthis.controlsRight = queryAll( revealElement, '.navigate-right' );\n\t\tthis.controlsUp = queryAll( revealElement, '.navigate-up' );\n\t\tthis.controlsDown = queryAll( revealElement, '.navigate-down' );\n\t\tthis.controlsPrev = queryAll( revealElement, '.navigate-prev' );\n\t\tthis.controlsNext = queryAll( revealElement, '.navigate-next' );\n\n\t\t// The left, right and down arrows in the standard reveal.js controls\n\t\tthis.controlsRightArrow = this.element.querySelector( '.navigate-right' );\n\t\tthis.controlsLeftArrow = this.element.querySelector( '.navigate-left' );\n\t\tthis.controlsDownArrow = this.element.querySelector( '.navigate-down' );\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tthis.element.style.display = config.controls ? 'block' : 'none';\n\n\t\tthis.element.setAttribute( 'data-controls-layout', config.controlsLayout );\n\t\tthis.element.setAttribute( 'data-controls-back-arrows', config.controlsBackArrows );\n\n\t}\n\n\tbind() {\n\n\t\t// Listen to both touch and click events, in case the device\n\t\t// supports both\n\t\tlet pointerEvents = [ 'touchstart', 'click' ];\n\n\t\t// Only support touch for Android, fixes double navigations in\n\t\t// stock browser\n\t\tif( isAndroid ) {\n\t\t\tpointerEvents = [ 'touchstart' ];\n\t\t}\n\n\t\tpointerEvents.forEach( eventName => {\n\t\t\tthis.controlsLeft.forEach( el => el.addEventListener( eventName, this.onNavigateLeftClicked, false ) );\n\t\t\tthis.controlsRight.forEach( el => el.addEventListener( eventName, this.onNavigateRightClicked, false ) );\n\t\t\tthis.controlsUp.forEach( el => el.addEventListener( eventName, this.onNavigateUpClicked, false ) );\n\t\t\tthis.controlsDown.forEach( el => el.addEventListener( eventName, this.onNavigateDownClicked, false ) );\n\t\t\tthis.controlsPrev.forEach( el => el.addEventListener( eventName, this.onNavigatePrevClicked, false ) );\n\t\t\tthis.controlsNext.forEach( el => el.addEventListener( eventName, this.onNavigateNextClicked, false ) );\n\t\t} );\n\n\t}\n\n\tunbind() {\n\n\t\t[ 'touchstart', 'click' ].forEach( eventName => {\n\t\t\tthis.controlsLeft.forEach( el => el.removeEventListener( eventName, this.onNavigateLeftClicked, false ) );\n\t\t\tthis.controlsRight.forEach( el => el.removeEventListener( eventName, this.onNavigateRightClicked, false ) );\n\t\t\tthis.controlsUp.forEach( el => el.removeEventListener( eventName, this.onNavigateUpClicked, false ) );\n\t\t\tthis.controlsDown.forEach( el => el.removeEventListener( eventName, this.onNavigateDownClicked, false ) );\n\t\t\tthis.controlsPrev.forEach( el => el.removeEventListener( eventName, this.onNavigatePrevClicked, false ) );\n\t\t\tthis.controlsNext.forEach( el => el.removeEventListener( eventName, this.onNavigateNextClicked, false ) );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Updates the state of all control/navigation arrows.\n\t */\n\tupdate() {\n\n\t\tlet routes = this.Reveal.availableRoutes();\n\n\t\t// Remove the 'enabled' class from all directions\n\t\t[...this.controlsLeft, ...this.controlsRight, ...this.controlsUp, ...this.controlsDown, ...this.controlsPrev, ...this.controlsNext].forEach( node => {\n\t\t\tnode.classList.remove( 'enabled', 'fragmented' );\n\n\t\t\t// Set 'disabled' attribute on all directions\n\t\t\tnode.setAttribute( 'disabled', 'disabled' );\n\t\t} );\n\n\t\t// Add the 'enabled' class to the available routes; remove 'disabled' attribute to enable buttons\n\t\tif( routes.left ) this.controlsLeft.forEach( el => { el.classList.add( 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\tif( routes.right ) this.controlsRight.forEach( el => { el.classList.add( 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\tif( routes.up ) this.controlsUp.forEach( el => { el.classList.add( 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\tif( routes.down ) this.controlsDown.forEach( el => { el.classList.add( 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\n\t\t// Prev/next buttons\n\t\tif( routes.left || routes.up ) this.controlsPrev.forEach( el => { el.classList.add( 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\tif( routes.right || routes.down ) this.controlsNext.forEach( el => { el.classList.add( 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\n\t\t// Highlight fragment directions\n\t\tlet currentSlide = this.Reveal.getCurrentSlide();\n\t\tif( currentSlide ) {\n\n\t\t\tlet fragmentsRoutes = this.Reveal.fragments.availableRoutes();\n\n\t\t\t// Always apply fragment decorator to prev/next buttons\n\t\t\tif( fragmentsRoutes.prev ) this.controlsPrev.forEach( el => { el.classList.add( 'fragmented', 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\t\tif( fragmentsRoutes.next ) this.controlsNext.forEach( el => { el.classList.add( 'fragmented', 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\n\t\t\t// Apply fragment decorators to directional buttons based on\n\t\t\t// what slide axis they are in\n\t\t\tif( this.Reveal.isVerticalSlide( currentSlide ) ) {\n\t\t\t\tif( fragmentsRoutes.prev ) this.controlsUp.forEach( el => { el.classList.add( 'fragmented', 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\t\t\tif( fragmentsRoutes.next ) this.controlsDown.forEach( el => { el.classList.add( 'fragmented', 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif( fragmentsRoutes.prev ) this.controlsLeft.forEach( el => { el.classList.add( 'fragmented', 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\t\t\tif( fragmentsRoutes.next ) this.controlsRight.forEach( el => { el.classList.add( 'fragmented', 'enabled' ); el.removeAttribute( 'disabled' ); } );\n\t\t\t}\n\n\t\t}\n\n\t\tif( this.Reveal.getConfig().controlsTutorial ) {\n\n\t\t\tlet indices = this.Reveal.getIndices();\n\n\t\t\t// Highlight control arrows with an animation to ensure\n\t\t\t// that the viewer knows how to navigate\n\t\t\tif( !this.Reveal.hasNavigatedVertically() && routes.down ) {\n\t\t\t\tthis.controlsDownArrow.classList.add( 'highlight' );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.controlsDownArrow.classList.remove( 'highlight' );\n\n\t\t\t\tif( this.Reveal.getConfig().rtl ) {\n\n\t\t\t\t\tif( !this.Reveal.hasNavigatedHorizontally() && routes.left && indices.v === 0 ) {\n\t\t\t\t\t\tthis.controlsLeftArrow.classList.add( 'highlight' );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.controlsLeftArrow.classList.remove( 'highlight' );\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif( !this.Reveal.hasNavigatedHorizontally() && routes.right && indices.v === 0 ) {\n\t\t\t\t\t\tthis.controlsRightArrow.classList.add( 'highlight' );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.controlsRightArrow.classList.remove( 'highlight' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy() {\n\n\t\tthis.unbind();\n\t\tthis.element.remove();\n\n\t}\n\n\t/**\n\t * Event handlers for navigation control buttons.\n\t */\n\tonNavigateLeftClicked( event ) {\n\n\t\tevent.preventDefault();\n\t\tthis.Reveal.onUserInput();\n\n\t\tif( this.Reveal.getConfig().navigationMode === 'linear' ) {\n\t\t\tthis.Reveal.prev();\n\t\t}\n\t\telse {\n\t\t\tthis.Reveal.left();\n\t\t}\n\n\t}\n\n\tonNavigateRightClicked( event ) {\n\n\t\tevent.preventDefault();\n\t\tthis.Reveal.onUserInput();\n\n\t\tif( this.Reveal.getConfig().navigationMode === 'linear' ) {\n\t\t\tthis.Reveal.next();\n\t\t}\n\t\telse {\n\t\t\tthis.Reveal.right();\n\t\t}\n\n\t}\n\n\tonNavigateUpClicked( event ) {\n\n\t\tevent.preventDefault();\n\t\tthis.Reveal.onUserInput();\n\n\t\tthis.Reveal.up();\n\n\t}\n\n\tonNavigateDownClicked( event ) {\n\n\t\tevent.preventDefault();\n\t\tthis.Reveal.onUserInput();\n\n\t\tthis.Reveal.down();\n\n\t}\n\n\tonNavigatePrevClicked( event ) {\n\n\t\tevent.preventDefault();\n\t\tthis.Reveal.onUserInput();\n\n\t\tthis.Reveal.prev();\n\n\t}\n\n\tonNavigateNextClicked( event ) {\n\n\t\tevent.preventDefault();\n\t\tthis.Reveal.onUserInput();\n\n\t\tthis.Reveal.next();\n\n\t}\n\n\n}","/**\n * Creates a visual progress bar for the presentation.\n */\nexport default class Progress {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\tthis.onProgressClicked = this.onProgressClicked.bind( this );\n\n\t}\n\n\trender() {\n\n\t\tthis.element = document.createElement( 'div' );\n\t\tthis.element.className = 'progress';\n\t\tthis.Reveal.getRevealElement().appendChild( this.element );\n\n\t\tthis.bar = document.createElement( 'span' );\n\t\tthis.element.appendChild( this.bar );\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tthis.element.style.display = config.progress ? 'block' : 'none';\n\n\t}\n\n\tbind() {\n\n\t\tif( this.Reveal.getConfig().progress && this.element ) {\n\t\t\tthis.element.addEventListener( 'click', this.onProgressClicked, false );\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tif ( this.Reveal.getConfig().progress && this.element ) {\n\t\t\tthis.element.removeEventListener( 'click', this.onProgressClicked, false );\n\t\t}\n\n\t}\n\n\t/**\n\t * Updates the progress bar to reflect the current slide.\n\t */\n\tupdate() {\n\n\t\t// Update progress if enabled\n\t\tif( this.Reveal.getConfig().progress && this.bar ) {\n\n\t\t\tlet scale = this.Reveal.getProgress();\n\n\t\t\t// Don't fill the progress bar if there's only one slide\n\t\t\tif( this.Reveal.getTotalSlides() < 2 ) {\n\t\t\t\tscale = 0;\n\t\t\t}\n\n\t\t\tthis.bar.style.transform = 'scaleX('+ scale +')';\n\n\t\t}\n\n\t}\n\n\tgetMaxWidth() {\n\n\t\treturn this.Reveal.getRevealElement().offsetWidth;\n\n\t}\n\n\t/**\n\t * Clicking on the progress bar results in a navigation to the\n\t * closest approximate horizontal slide using this equation:\n\t *\n\t * ( clickX / presentationWidth ) * numberOfSlides\n\t *\n\t * @param {object} event\n\t */\n\tonProgressClicked( event ) {\n\n\t\tthis.Reveal.onUserInput( event );\n\n\t\tevent.preventDefault();\n\n\t\tlet slides = this.Reveal.getSlides();\n\t\tlet slidesTotal = slides.length;\n\t\tlet slideIndex = Math.floor( ( event.clientX / this.getMaxWidth() ) * slidesTotal );\n\n\t\tif( this.Reveal.getConfig().rtl ) {\n\t\t\tslideIndex = slidesTotal - slideIndex;\n\t\t}\n\n\t\tlet targetIndices = this.Reveal.getIndices(slides[slideIndex]);\n\t\tthis.Reveal.slide( targetIndices.h, targetIndices.v );\n\n\t}\n\n\tdestroy() {\n\n\t\tthis.element.remove();\n\n\t}\n\n}","/**\n * Handles hiding of the pointer/cursor when inactive.\n */\nexport default class Pointer {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\t// Throttles mouse wheel navigation\n\t\tthis.lastMouseWheelStep = 0;\n\n\t\t// Is the mouse pointer currently hidden from view\n\t\tthis.cursorHidden = false;\n\n\t\t// Timeout used to determine when the cursor is inactive\n\t\tthis.cursorInactiveTimeout = 0;\n\n\t\tthis.onDocumentCursorActive = this.onDocumentCursorActive.bind( this );\n\t\tthis.onDocumentMouseScroll = this.onDocumentMouseScroll.bind( this );\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tif( config.mouseWheel ) {\n\t\t\tdocument.addEventListener( 'DOMMouseScroll', this.onDocumentMouseScroll, false ); // FF\n\t\t\tdocument.addEventListener( 'mousewheel', this.onDocumentMouseScroll, false );\n\t\t}\n\t\telse {\n\t\t\tdocument.removeEventListener( 'DOMMouseScroll', this.onDocumentMouseScroll, false ); // FF\n\t\t\tdocument.removeEventListener( 'mousewheel', this.onDocumentMouseScroll, false );\n\t\t}\n\n\t\t// Auto-hide the mouse pointer when its inactive\n\t\tif( config.hideInactiveCursor ) {\n\t\t\tdocument.addEventListener( 'mousemove', this.onDocumentCursorActive, false );\n\t\t\tdocument.addEventListener( 'mousedown', this.onDocumentCursorActive, false );\n\t\t}\n\t\telse {\n\t\t\tthis.showCursor();\n\n\t\t\tdocument.removeEventListener( 'mousemove', this.onDocumentCursorActive, false );\n\t\t\tdocument.removeEventListener( 'mousedown', this.onDocumentCursorActive, false );\n\t\t}\n\n\t}\n\n\t/**\n\t * Shows the mouse pointer after it has been hidden with\n\t * #hideCursor.\n\t */\n\tshowCursor() {\n\n\t\tif( this.cursorHidden ) {\n\t\t\tthis.cursorHidden = false;\n\t\t\tthis.Reveal.getRevealElement().style.cursor = '';\n\t\t}\n\n\t}\n\n\t/**\n\t * Hides the mouse pointer when it's on top of the .reveal\n\t * container.\n\t */\n\thideCursor() {\n\n\t\tif( this.cursorHidden === false ) {\n\t\t\tthis.cursorHidden = true;\n\t\t\tthis.Reveal.getRevealElement().style.cursor = 'none';\n\t\t}\n\n\t}\n\n\tdestroy() {\n\n\t\tthis.showCursor();\n\n\t\tdocument.removeEventListener( 'DOMMouseScroll', this.onDocumentMouseScroll, false );\n\t\tdocument.removeEventListener( 'mousewheel', this.onDocumentMouseScroll, false );\n\t\tdocument.removeEventListener( 'mousemove', this.onDocumentCursorActive, false );\n\t\tdocument.removeEventListener( 'mousedown', this.onDocumentCursorActive, false );\n\n\t}\n\n\t/**\n\t * Called whenever there is mouse input at the document level\n\t * to determine if the cursor is active or not.\n\t *\n\t * @param {object} event\n\t */\n\tonDocumentCursorActive( event ) {\n\n\t\tthis.showCursor();\n\n\t\tclearTimeout( this.cursorInactiveTimeout );\n\n\t\tthis.cursorInactiveTimeout = setTimeout( this.hideCursor.bind( this ), this.Reveal.getConfig().hideCursorTime );\n\n\t}\n\n\t/**\n\t * Handles mouse wheel scrolling, throttled to avoid skipping\n\t * multiple slides.\n\t *\n\t * @param {object} event\n\t */\n\tonDocumentMouseScroll( event ) {\n\n\t\tif( Date.now() - this.lastMouseWheelStep > 1000 ) {\n\n\t\t\tthis.lastMouseWheelStep = Date.now();\n\n\t\t\tlet delta = event.detail || -event.wheelDelta;\n\t\t\tif( delta > 0 ) {\n\t\t\t\tthis.Reveal.next();\n\t\t\t}\n\t\t\telse if( delta < 0 ) {\n\t\t\t\tthis.Reveal.prev();\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}","/**\n * Loads a JavaScript file from the given URL and executes it.\n *\n * @param {string} url Address of the .js file to load\n * @param {function} callback Method to invoke when the script\n * has loaded and executed\n */\nexport const loadScript = ( url, callback ) => {\n\n\tconst script = document.createElement( 'script' );\n\tscript.type = 'text/javascript';\n\tscript.async = false;\n\tscript.defer = false;\n\tscript.src = url;\n\n\tif( typeof callback === 'function' ) {\n\n\t\t// Success callback\n\t\tscript.onload = script.onreadystatechange = event => {\n\t\t\tif( event.type === 'load' || /loaded|complete/.test( script.readyState ) ) {\n\n\t\t\t\t// Kill event listeners\n\t\t\t\tscript.onload = script.onreadystatechange = script.onerror = null;\n\n\t\t\t\tcallback();\n\n\t\t\t}\n\t\t};\n\n\t\t// Error callback\n\t\tscript.onerror = err => {\n\n\t\t\t// Kill event listeners\n\t\t\tscript.onload = script.onreadystatechange = script.onerror = null;\n\n\t\t\tcallback( new Error( 'Failed loading script: ' + script.src + '\\n' + err ) );\n\n\t\t};\n\n\t}\n\n\t// Append the script at the end of <head>\n\tconst head = document.querySelector( 'head' );\n\thead.insertBefore( script, head.lastChild );\n\n}","import { loadScript } from '../utils/loader.js'\n\n/**\n * Manages loading and registering of reveal.js plugins.\n */\nexport default class Plugins {\n\n\tconstructor( reveal ) {\n\n\t\tthis.Reveal = reveal;\n\n\t\t// Flags our current state (idle -> loading -> loaded)\n\t\tthis.state = 'idle';\n\n\t\t// An id:instance map of currently registered plugins\n\t\tthis.registeredPlugins = {};\n\n\t\tthis.asyncDependencies = [];\n\n\t}\n\n\t/**\n\t * Loads reveal.js dependencies, registers and\n\t * initializes plugins.\n\t *\n\t * Plugins are direct references to a reveal.js plugin\n\t * object that we register and initialize after any\n\t * synchronous dependencies have loaded.\n\t *\n\t * Dependencies are defined via the 'dependencies' config\n\t * option and will be loaded prior to starting reveal.js.\n\t * Some dependencies may have an 'async' flag, if so they\n\t * will load after reveal.js has been started up.\n\t */\n\tload( plugins, dependencies ) {\n\n\t\tthis.state = 'loading';\n\n\t\tplugins.forEach( this.registerPlugin.bind( this ) );\n\n\t\treturn new Promise( resolve => {\n\n\t\t\tlet scripts = [],\n\t\t\t\tscriptsToLoad = 0;\n\n\t\t\tdependencies.forEach( s => {\n\t\t\t\t// Load if there's no condition or the condition is truthy\n\t\t\t\tif( !s.condition || s.condition() ) {\n\t\t\t\t\tif( s.async ) {\n\t\t\t\t\t\tthis.asyncDependencies.push( s );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tscripts.push( s );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tif( scripts.length ) {\n\t\t\t\tscriptsToLoad = scripts.length;\n\n\t\t\t\tconst scriptLoadedCallback = (s) => {\n\t\t\t\t\tif( s && typeof s.callback === 'function' ) s.callback();\n\n\t\t\t\t\tif( --scriptsToLoad === 0 ) {\n\t\t\t\t\t\tthis.initPlugins().then( resolve );\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// Load synchronous scripts\n\t\t\t\tscripts.forEach( s => {\n\t\t\t\t\tif( typeof s.id === 'string' ) {\n\t\t\t\t\t\tthis.registerPlugin( s );\n\t\t\t\t\t\tscriptLoadedCallback( s );\n\t\t\t\t\t}\n\t\t\t\t\telse if( typeof s.src === 'string' ) {\n\t\t\t\t\t\tloadScript( s.src, () => scriptLoadedCallback(s) );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tconsole.warn( 'Unrecognized plugin format', s );\n\t\t\t\t\t\tscriptLoadedCallback();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.initPlugins().then( resolve );\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Initializes our plugins and waits for them to be ready\n\t * before proceeding.\n\t */\n\tinitPlugins() {\n\n\t\treturn new Promise( resolve => {\n\n\t\t\tlet pluginValues = Object.values( this.registeredPlugins );\n\t\t\tlet pluginsToInitialize = pluginValues.length;\n\n\t\t\t// If there are no plugins, skip this step\n\t\t\tif( pluginsToInitialize === 0 ) {\n\t\t\t\tthis.loadAsync().then( resolve );\n\t\t\t}\n\t\t\t// ... otherwise initialize plugins\n\t\t\telse {\n\n\t\t\t\tlet initNextPlugin;\n\n\t\t\t\tlet afterPlugInitialized = () => {\n\t\t\t\t\tif( --pluginsToInitialize === 0 ) {\n\t\t\t\t\t\tthis.loadAsync().then( resolve );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tinitNextPlugin();\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tlet i = 0;\n\n\t\t\t\t// Initialize plugins serially\n\t\t\t\tinitNextPlugin = () => {\n\n\t\t\t\t\tlet plugin = pluginValues[i++];\n\n\t\t\t\t\t// If the plugin has an 'init' method, invoke it\n\t\t\t\t\tif( typeof plugin.init === 'function' ) {\n\t\t\t\t\t\tlet promise = plugin.init( this.Reveal );\n\n\t\t\t\t\t\t// If the plugin returned a Promise, wait for it\n\t\t\t\t\t\tif( promise && typeof promise.then === 'function' ) {\n\t\t\t\t\t\t\tpromise.then( afterPlugInitialized );\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tafterPlugInitialized();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tafterPlugInitialized();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tinitNextPlugin();\n\n\t\t\t}\n\n\t\t} )\n\n\t}\n\n\t/**\n\t * Loads all async reveal.js dependencies.\n\t */\n\tloadAsync() {\n\n\t\tthis.state = 'loaded';\n\n\t\tif( this.asyncDependencies.length ) {\n\t\t\tthis.asyncDependencies.forEach( s => {\n\t\t\t\tloadScript( s.src, s.callback );\n\t\t\t} );\n\t\t}\n\n\t\treturn Promise.resolve();\n\n\t}\n\n\t/**\n\t * Registers a new plugin with this reveal.js instance.\n\t *\n\t * reveal.js waits for all registered plugins to initialize\n\t * before considering itself ready, as long as the plugin\n\t * is registered before calling `Reveal.initialize()`.\n\t */\n\tregisterPlugin( plugin ) {\n\n\t\t// Backwards compatibility to make reveal.js ~3.9.0\n\t\t// plugins work with reveal.js 4.0.0\n\t\tif( arguments.length === 2 && typeof arguments[0] === 'string' ) {\n\t\t\tplugin = arguments[1];\n\t\t\tplugin.id = arguments[0];\n\t\t}\n\t\t// Plugin can optionally be a function which we call\n\t\t// to create an instance of the plugin\n\t\telse if( typeof plugin === 'function' ) {\n\t\t\tplugin = plugin();\n\t\t}\n\n\t\tlet id = plugin.id;\n\n\t\tif( typeof id !== 'string' ) {\n\t\t\tconsole.warn( 'Unrecognized plugin format; can\\'t find plugin.id', plugin );\n\t\t}\n\t\telse if( this.registeredPlugins[id] === undefined ) {\n\t\t\tthis.registeredPlugins[id] = plugin;\n\n\t\t\t// If a plugin is registered after reveal.js is loaded,\n\t\t\t// initialize it right away\n\t\t\tif( this.state === 'loaded' && typeof plugin.init === 'function' ) {\n\t\t\t\tplugin.init( this.Reveal );\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tconsole.warn( 'reveal.js: \"'+ id +'\" plugin has already been registered' );\n\t\t}\n\n\t}\n\n\t/**\n\t * Checks if a specific plugin has been registered.\n\t *\n\t * @param {String} id Unique plugin identifier\n\t */\n\thasPlugin( id ) {\n\n\t\treturn !!this.registeredPlugins[id];\n\n\t}\n\n\t/**\n\t * Returns the specific plugin instance, if a plugin\n\t * with the given ID has been registered.\n\t *\n\t * @param {String} id Unique plugin identifier\n\t */\n\tgetPlugin( id ) {\n\n\t\treturn this.registeredPlugins[id];\n\n\t}\n\n\tgetRegisteredPlugins() {\n\n\t\treturn this.registeredPlugins;\n\n\t}\n\n\tdestroy() {\n\n\t\tObject.values( this.registeredPlugins ).forEach( plugin => {\n\t\t\tif( typeof plugin.destroy === 'function' ) {\n\t\t\t\tplugin.destroy();\n\t\t\t}\n\t\t} );\n\n\t\tthis.registeredPlugins = {};\n\t\tthis.asyncDependencies = [];\n\n\t}\n\n}\n","import { SLIDES_SELECTOR } from '../utils/constants.js'\nimport { queryAll, createStyleSheet } from '../utils/util.js'\n\n/**\n * Setups up our presentation for printing/exporting to PDF.\n */\nexport default class Print {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t}\n\n\t/**\n\t * Configures the presentation for printing to a static\n\t * PDF.\n\t */\n\tasync setupPDF() {\n\n\t\tconst config = this.Reveal.getConfig();\n\t\tconst slides = queryAll( this.Reveal.getRevealElement(), SLIDES_SELECTOR )\n\n\t\t// Compute slide numbers now, before we start duplicating slides\n\t\tconst injectPageNumbers = config.slideNumber && /all|print/i.test( config.showSlideNumber );\n\n\t\tconst slideSize = this.Reveal.getComputedSlideSize( window.innerWidth, window.innerHeight );\n\n\t\t// Dimensions of the PDF pages\n\t\tconst pageWidth = Math.floor( slideSize.width * ( 1 + config.margin ) ),\n\t\t\tpageHeight = Math.floor( slideSize.height * ( 1 + config.margin ) );\n\n\t\t// Dimensions of slides within the pages\n\t\tconst slideWidth = slideSize.width,\n\t\t\tslideHeight = slideSize.height;\n\n\t\tawait new Promise( requestAnimationFrame );\n\n\t\t// Let the browser know what page size we want to print\n\t\tcreateStyleSheet( '@page{size:'+ pageWidth +'px '+ pageHeight +'px; margin: 0px;}' );\n\n\t\t// Limit the size of certain elements to the dimensions of the slide\n\t\tcreateStyleSheet( '.reveal section>img, .reveal section>video, .reveal section>iframe{max-width: '+ slideWidth +'px; max-height:'+ slideHeight +'px}' );\n\n\t\tdocument.documentElement.classList.add( 'print-pdf' );\n\t\tdocument.body.style.width = pageWidth + 'px';\n\t\tdocument.body.style.height = pageHeight + 'px';\n\n\t\tconst viewportElement = document.querySelector( '.reveal-viewport' );\n\t\tlet presentationBackground;\n\t\tif( viewportElement ) {\n\t\t\tconst viewportStyles = window.getComputedStyle( viewportElement );\n\t\t\tif( viewportStyles && viewportStyles.background ) {\n\t\t\t\tpresentationBackground = viewportStyles.background;\n\t\t\t}\n\t\t}\n\n\t\t// Make sure stretch elements fit on slide\n\t\tawait new Promise( requestAnimationFrame );\n\t\tthis.Reveal.layoutSlideContents( slideWidth, slideHeight );\n\n\t\t// Batch scrollHeight access to prevent layout thrashing\n\t\tawait new Promise( requestAnimationFrame );\n\n\t\tconst slideScrollHeights = slides.map( slide => slide.scrollHeight );\n\n\t\tconst pages = [];\n\t\tconst pageContainer = slides[0].parentNode;\n\t\tlet slideNumber = 1;\n\n\t\t// Slide and slide background layout\n\t\tslides.forEach( function( slide, index ) {\n\n\t\t\t// Vertical stacks are not centred since their section\n\t\t\t// children will be\n\t\t\tif( slide.classList.contains( 'stack' ) === false ) {\n\t\t\t\t// Center the slide inside of the page, giving the slide some margin\n\t\t\t\tlet left = ( pageWidth - slideWidth ) / 2;\n\t\t\t\tlet top = ( pageHeight - slideHeight ) / 2;\n\n\t\t\t\tconst contentHeight = slideScrollHeights[ index ];\n\t\t\t\tlet numberOfPages = Math.max( Math.ceil( contentHeight / pageHeight ), 1 );\n\n\t\t\t\t// Adhere to configured pages per slide limit\n\t\t\t\tnumberOfPages = Math.min( numberOfPages, config.pdfMaxPagesPerSlide );\n\n\t\t\t\t// Center slides vertically\n\t\t\t\tif( numberOfPages === 1 && config.center || slide.classList.contains( 'center' ) ) {\n\t\t\t\t\ttop = Math.max( ( pageHeight - contentHeight ) / 2, 0 );\n\t\t\t\t}\n\n\t\t\t\t// Wrap the slide in a page element and hide its overflow\n\t\t\t\t// so that no page ever flows onto another\n\t\t\t\tconst page = document.createElement( 'div' );\n\t\t\t\tpages.push( page );\n\n\t\t\t\tpage.className = 'pdf-page';\n\t\t\t\tpage.style.height = ( ( pageHeight + config.pdfPageHeightOffset ) * numberOfPages ) + 'px';\n\n\t\t\t\t// Copy the presentation-wide background to each individual\n\t\t\t\t// page when printing\n\t\t\t\tif( presentationBackground ) {\n\t\t\t\t\tpage.style.background = presentationBackground;\n\t\t\t\t}\n\n\t\t\t\tpage.appendChild( slide );\n\n\t\t\t\t// Position the slide inside of the page\n\t\t\t\tslide.style.left = left + 'px';\n\t\t\t\tslide.style.top = top + 'px';\n\t\t\t\tslide.style.width = slideWidth + 'px';\n\n\t\t\t\tthis.Reveal.slideContent.layout( slide );\n\n\t\t\t\tif( slide.slideBackgroundElement ) {\n\t\t\t\t\tpage.insertBefore( slide.slideBackgroundElement, slide );\n\t\t\t\t}\n\n\t\t\t\t// Inject notes if `showNotes` is enabled\n\t\t\t\tif( config.showNotes ) {\n\n\t\t\t\t\t// Are there notes for this slide?\n\t\t\t\t\tconst notes = this.Reveal.getSlideNotes( slide );\n\t\t\t\t\tif( notes ) {\n\n\t\t\t\t\t\tconst notesSpacing = 8;\n\t\t\t\t\t\tconst notesLayout = typeof config.showNotes === 'string' ? config.showNotes : 'inline';\n\t\t\t\t\t\tconst notesElement = document.createElement( 'div' );\n\t\t\t\t\t\tnotesElement.classList.add( 'speaker-notes' );\n\t\t\t\t\t\tnotesElement.classList.add( 'speaker-notes-pdf' );\n\t\t\t\t\t\tnotesElement.setAttribute( 'data-layout', notesLayout );\n\t\t\t\t\t\tnotesElement.innerHTML = notes;\n\n\t\t\t\t\t\tif( notesLayout === 'separate-page' ) {\n\t\t\t\t\t\t\tpages.push( notesElement );\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tnotesElement.style.left = notesSpacing + 'px';\n\t\t\t\t\t\t\tnotesElement.style.bottom = notesSpacing + 'px';\n\t\t\t\t\t\t\tnotesElement.style.width = ( pageWidth - notesSpacing*2 ) + 'px';\n\t\t\t\t\t\t\tpage.appendChild( notesElement );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Inject page numbers if `slideNumbers` are enabled\n\t\t\t\tif( injectPageNumbers ) {\n\t\t\t\t\tconst numberElement = document.createElement( 'div' );\n\t\t\t\t\tnumberElement.classList.add( 'slide-number' );\n\t\t\t\t\tnumberElement.classList.add( 'slide-number-pdf' );\n\t\t\t\t\tnumberElement.innerHTML = slideNumber++;\n\t\t\t\t\tpage.appendChild( numberElement );\n\t\t\t\t}\n\n\t\t\t\t// Copy page and show fragments one after another\n\t\t\t\tif( config.pdfSeparateFragments ) {\n\n\t\t\t\t\t// Each fragment 'group' is an array containing one or more\n\t\t\t\t\t// fragments. Multiple fragments that appear at the same time\n\t\t\t\t\t// are part of the same group.\n\t\t\t\t\tconst fragmentGroups = this.Reveal.fragments.sort( page.querySelectorAll( '.fragment' ), true );\n\n\t\t\t\t\tlet previousFragmentStep;\n\n\t\t\t\t\tfragmentGroups.forEach( function( fragments, index ) {\n\n\t\t\t\t\t\t// Remove 'current-fragment' from the previous group\n\t\t\t\t\t\tif( previousFragmentStep ) {\n\t\t\t\t\t\t\tpreviousFragmentStep.forEach( function( fragment ) {\n\t\t\t\t\t\t\t\tfragment.classList.remove( 'current-fragment' );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Show the fragments for the current index\n\t\t\t\t\t\tfragments.forEach( function( fragment ) {\n\t\t\t\t\t\t\tfragment.classList.add( 'visible', 'current-fragment' );\n\t\t\t\t\t\t}, this );\n\n\t\t\t\t\t\t// Create a separate page for the current fragment state\n\t\t\t\t\t\tconst clonedPage = page.cloneNode( true );\n\n\t\t\t\t\t\t// Inject unique page numbers for fragments\n\t\t\t\t\t\tif( injectPageNumbers ) {\n\t\t\t\t\t\t\tconst numberElement = clonedPage.querySelector( '.slide-number-pdf' );\n\t\t\t\t\t\t\tconst fragmentNumber = index + 1;\n\t\t\t\t\t\t\tnumberElement.innerHTML += '.' + fragmentNumber;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpages.push( clonedPage );\n\n\t\t\t\t\t\tpreviousFragmentStep = fragments;\n\n\t\t\t\t\t}, this );\n\n\t\t\t\t\t// Reset the first/original page so that all fragments are hidden\n\t\t\t\t\tfragmentGroups.forEach( function( fragments ) {\n\t\t\t\t\t\tfragments.forEach( function( fragment ) {\n\t\t\t\t\t\t\tfragment.classList.remove( 'visible', 'current-fragment' );\n\t\t\t\t\t\t} );\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\t\t\t\t// Show all fragments\n\t\t\t\telse {\n\t\t\t\t\tqueryAll( page, '.fragment:not(.fade-out)' ).forEach( function( fragment ) {\n\t\t\t\t\t\tfragment.classList.add( 'visible' );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}, this );\n\n\t\tawait new Promise( requestAnimationFrame );\n\n\t\tpages.forEach( page => pageContainer.appendChild( page ) );\n\n\t\t// Re-run JS-based content layout after the slide is added to page DOM\n\t\tthis.Reveal.slideContent.layout( this.Reveal.getSlidesElement() );\n\n\t\t// Notify subscribers that the PDF layout is good to go\n\t\tthis.Reveal.dispatchEvent({ type: 'pdf-ready' });\n\n\t}\n\n\t/**\n\t * Checks if this instance is being used to print a PDF.\n\t */\n\tisPrintingPDF() {\n\n\t\treturn ( /print-pdf/gi ).test( window.location.search );\n\n\t}\n\n}\n","import { isAndroid } from '../utils/device.js'\nimport { matches } from '../utils/util.js'\n\nconst SWIPE_THRESHOLD = 40;\n\n/**\n * Controls all touch interactions and navigations for\n * a presentation.\n */\nexport default class Touch {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\t// Holds information about the currently ongoing touch interaction\n\t\tthis.touchStartX = 0;\n\t\tthis.touchStartY = 0;\n\t\tthis.touchStartCount = 0;\n\t\tthis.touchCaptured = false;\n\n\t\tthis.onPointerDown = this.onPointerDown.bind( this );\n\t\tthis.onPointerMove = this.onPointerMove.bind( this );\n\t\tthis.onPointerUp = this.onPointerUp.bind( this );\n\t\tthis.onTouchStart = this.onTouchStart.bind( this );\n\t\tthis.onTouchMove = this.onTouchMove.bind( this );\n\t\tthis.onTouchEnd = this.onTouchEnd.bind( this );\n\n\t}\n\n\t/**\n\t *\n\t */\n\tbind() {\n\n\t\tlet revealElement = this.Reveal.getRevealElement();\n\n\t\tif( 'onpointerdown' in window ) {\n\t\t\t// Use W3C pointer events\n\t\t\trevealElement.addEventListener( 'pointerdown', this.onPointerDown, false );\n\t\t\trevealElement.addEventListener( 'pointermove', this.onPointerMove, false );\n\t\t\trevealElement.addEventListener( 'pointerup', this.onPointerUp, false );\n\t\t}\n\t\telse if( window.navigator.msPointerEnabled ) {\n\t\t\t// IE 10 uses prefixed version of pointer events\n\t\t\trevealElement.addEventListener( 'MSPointerDown', this.onPointerDown, false );\n\t\t\trevealElement.addEventListener( 'MSPointerMove', this.onPointerMove, false );\n\t\t\trevealElement.addEventListener( 'MSPointerUp', this.onPointerUp, false );\n\t\t}\n\t\telse {\n\t\t\t// Fall back to touch events\n\t\t\trevealElement.addEventListener( 'touchstart', this.onTouchStart, false );\n\t\t\trevealElement.addEventListener( 'touchmove', this.onTouchMove, false );\n\t\t\trevealElement.addEventListener( 'touchend', this.onTouchEnd, false );\n\t\t}\n\n\t}\n\n\t/**\n\t *\n\t */\n\tunbind() {\n\n\t\tlet revealElement = this.Reveal.getRevealElement();\n\n\t\trevealElement.removeEventListener( 'pointerdown', this.onPointerDown, false );\n\t\trevealElement.removeEventListener( 'pointermove', this.onPointerMove, false );\n\t\trevealElement.removeEventListener( 'pointerup', this.onPointerUp, false );\n\n\t\trevealElement.removeEventListener( 'MSPointerDown', this.onPointerDown, false );\n\t\trevealElement.removeEventListener( 'MSPointerMove', this.onPointerMove, false );\n\t\trevealElement.removeEventListener( 'MSPointerUp', this.onPointerUp, false );\n\n\t\trevealElement.removeEventListener( 'touchstart', this.onTouchStart, false );\n\t\trevealElement.removeEventListener( 'touchmove', this.onTouchMove, false );\n\t\trevealElement.removeEventListener( 'touchend', this.onTouchEnd, false );\n\n\t}\n\n\t/**\n\t * Checks if the target element prevents the triggering of\n\t * swipe navigation.\n\t */\n\tisSwipePrevented( target ) {\n\n\t\t// Prevent accidental swipes when scrubbing timelines\n\t\tif( matches( target, 'video, audio' ) ) return true;\n\n\t\twhile( target && typeof target.hasAttribute === 'function' ) {\n\t\t\tif( target.hasAttribute( 'data-prevent-swipe' ) ) return true;\n\t\t\ttarget = target.parentNode;\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t/**\n\t * Handler for the 'touchstart' event, enables support for\n\t * swipe and pinch gestures.\n\t *\n\t * @param {object} event\n\t */\n\tonTouchStart( event ) {\n\n\t\tif( this.isSwipePrevented( event.target ) ) return true;\n\n\t\tthis.touchStartX = event.touches[0].clientX;\n\t\tthis.touchStartY = event.touches[0].clientY;\n\t\tthis.touchStartCount = event.touches.length;\n\n\t}\n\n\t/**\n\t * Handler for the 'touchmove' event.\n\t *\n\t * @param {object} event\n\t */\n\tonTouchMove( event ) {\n\n\t\tif( this.isSwipePrevented( event.target ) ) return true;\n\n\t\tlet config = this.Reveal.getConfig();\n\n\t\t// Each touch should only trigger one action\n\t\tif( !this.touchCaptured ) {\n\t\t\tthis.Reveal.onUserInput( event );\n\n\t\t\tlet currentX = event.touches[0].clientX;\n\t\t\tlet currentY = event.touches[0].clientY;\n\n\t\t\t// There was only one touch point, look for a swipe\n\t\t\tif( event.touches.length === 1 && this.touchStartCount !== 2 ) {\n\n\t\t\t\tlet availableRoutes = this.Reveal.availableRoutes({ includeFragments: true });\n\n\t\t\t\tlet deltaX = currentX - this.touchStartX,\n\t\t\t\t\tdeltaY = currentY - this.touchStartY;\n\n\t\t\t\tif( deltaX > SWIPE_THRESHOLD && Math.abs( deltaX ) > Math.abs( deltaY ) ) {\n\t\t\t\t\tthis.touchCaptured = true;\n\t\t\t\t\tif( config.navigationMode === 'linear' ) {\n\t\t\t\t\t\tif( config.rtl ) {\n\t\t\t\t\t\t\tthis.Reveal.next();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.Reveal.prev();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.Reveal.left();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( deltaX < -SWIPE_THRESHOLD && Math.abs( deltaX ) > Math.abs( deltaY ) ) {\n\t\t\t\t\tthis.touchCaptured = true;\n\t\t\t\t\tif( config.navigationMode === 'linear' ) {\n\t\t\t\t\t\tif( config.rtl ) {\n\t\t\t\t\t\t\tthis.Reveal.prev();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tthis.Reveal.next();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.Reveal.right();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( deltaY > SWIPE_THRESHOLD && availableRoutes.up ) {\n\t\t\t\t\tthis.touchCaptured = true;\n\t\t\t\t\tif( config.navigationMode === 'linear' ) {\n\t\t\t\t\t\tthis.Reveal.prev();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.Reveal.up();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( deltaY < -SWIPE_THRESHOLD && availableRoutes.down ) {\n\t\t\t\t\tthis.touchCaptured = true;\n\t\t\t\t\tif( config.navigationMode === 'linear' ) {\n\t\t\t\t\t\tthis.Reveal.next();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.Reveal.down();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// If we're embedded, only block touch events if they have\n\t\t\t\t// triggered an action\n\t\t\t\tif( config.embedded ) {\n\t\t\t\t\tif( this.touchCaptured || this.Reveal.isVerticalSlide() ) {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Not embedded? Block them all to avoid needless tossing\n\t\t\t\t// around of the viewport in iOS\n\t\t\t\telse {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\t// There's a bug with swiping on some Android devices unless\n\t\t// the default action is always prevented\n\t\telse if( isAndroid ) {\n\t\t\tevent.preventDefault();\n\t\t}\n\n\t}\n\n\t/**\n\t * Handler for the 'touchend' event.\n\t *\n\t * @param {object} event\n\t */\n\tonTouchEnd( event ) {\n\n\t\tthis.touchCaptured = false;\n\n\t}\n\n\t/**\n\t * Convert pointer down to touch start.\n\t *\n\t * @param {object} event\n\t */\n\tonPointerDown( event ) {\n\n\t\tif( event.pointerType === event.MSPOINTER_TYPE_TOUCH || event.pointerType === \"touch\" ) {\n\t\t\tevent.touches = [{ clientX: event.clientX, clientY: event.clientY }];\n\t\t\tthis.onTouchStart( event );\n\t\t}\n\n\t}\n\n\t/**\n\t * Convert pointer move to touch move.\n\t *\n\t * @param {object} event\n\t */\n\tonPointerMove( event ) {\n\n\t\tif( event.pointerType === event.MSPOINTER_TYPE_TOUCH || event.pointerType === \"touch\" )  {\n\t\t\tevent.touches = [{ clientX: event.clientX, clientY: event.clientY }];\n\t\t\tthis.onTouchMove( event );\n\t\t}\n\n\t}\n\n\t/**\n\t * Convert pointer up to touch end.\n\t *\n\t * @param {object} event\n\t */\n\tonPointerUp( event ) {\n\n\t\tif( event.pointerType === event.MSPOINTER_TYPE_TOUCH || event.pointerType === \"touch\" )  {\n\t\t\tevent.touches = [{ clientX: event.clientX, clientY: event.clientY }];\n\t\t\tthis.onTouchEnd( event );\n\t\t}\n\n\t}\n\n}","import { closest } from '../utils/util.js'\n\n/**\n * Manages focus when a presentation is embedded. This\n * helps us only capture keyboard from the presentation\n * a user is currently interacting with in a page where\n * multiple presentations are embedded.\n */\n\nconst STATE_FOCUS = 'focus';\nconst STATE_BLUR = 'blur';\n\nexport default class Focus {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t\tthis.onRevealPointerDown = this.onRevealPointerDown.bind( this );\n\t\tthis.onDocumentPointerDown = this.onDocumentPointerDown.bind( this );\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tif( config.embedded ) {\n\t\t\tthis.blur();\n\t\t}\n\t\telse {\n\t\t\tthis.focus();\n\t\t\tthis.unbind();\n\t\t}\n\n\t}\n\n\tbind() {\n\n\t\tif( this.Reveal.getConfig().embedded ) {\n\t\t\tthis.Reveal.getRevealElement().addEventListener( 'pointerdown', this.onRevealPointerDown, false );\n\t\t}\n\n\t}\n\n\tunbind() {\n\n\t\tthis.Reveal.getRevealElement().removeEventListener( 'pointerdown', this.onRevealPointerDown, false );\n\t\tdocument.removeEventListener( 'pointerdown', this.onDocumentPointerDown, false );\n\n\t}\n\n\tfocus() {\n\n\t\tif( this.state !== STATE_FOCUS ) {\n\t\t\tthis.Reveal.getRevealElement().classList.add( 'focused' );\n\t\t\tdocument.addEventListener( 'pointerdown', this.onDocumentPointerDown, false );\n\t\t}\n\n\t\tthis.state = STATE_FOCUS;\n\n\t}\n\n\tblur() {\n\n\t\tif( this.state !== STATE_BLUR ) {\n\t\t\tthis.Reveal.getRevealElement().classList.remove( 'focused' );\n\t\t\tdocument.removeEventListener( 'pointerdown', this.onDocumentPointerDown, false );\n\t\t}\n\n\t\tthis.state = STATE_BLUR;\n\n\t}\n\n\tisFocused() {\n\n\t\treturn this.state === STATE_FOCUS;\n\n\t}\n\n\tdestroy() {\n\n\t\tthis.Reveal.getRevealElement().classList.remove( 'focused' );\n\n\t}\n\n\tonRevealPointerDown( event ) {\n\n\t\tthis.focus();\n\n\t}\n\n\tonDocumentPointerDown( event ) {\n\n\t\tlet revealElement = closest( event.target, '.reveal' );\n\t\tif( !revealElement || revealElement !== this.Reveal.getRevealElement() ) {\n\t\t\tthis.blur();\n\t\t}\n\n\t}\n\n}","/**\n * Handles the showing of speaker notes\n */\nexport default class Notes {\n\n\tconstructor( Reveal ) {\n\n\t\tthis.Reveal = Reveal;\n\n\t}\n\n\trender() {\n\n\t\tthis.element = document.createElement( 'div' );\n\t\tthis.element.className = 'speaker-notes';\n\t\tthis.element.setAttribute( 'data-prevent-swipe', '' );\n\t\tthis.element.setAttribute( 'tabindex', '0' );\n\t\tthis.Reveal.getRevealElement().appendChild( this.element );\n\n\t}\n\n\t/**\n\t * Called when the reveal.js config is updated.\n\t */\n\tconfigure( config, oldConfig ) {\n\n\t\tif( config.showNotes ) {\n\t\t\tthis.element.setAttribute( 'data-layout', typeof config.showNotes === 'string' ? config.showNotes : 'inline' );\n\t\t}\n\n\t}\n\n\t/**\n\t * Pick up notes from the current slide and display them\n\t * to the viewer.\n\t *\n\t * @see {@link config.showNotes}\n\t */\n\tupdate() {\n\n\t\tif( this.Reveal.getConfig().showNotes && this.element && this.Reveal.getCurrentSlide() && !this.Reveal.print.isPrintingPDF() ) {\n\n\t\t\tthis.element.innerHTML = this.getSlideNotes() || '<span class=\"notes-placeholder\">No notes on this slide.</span>';\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Updates the visibility of the speaker notes sidebar that\n\t * is used to share annotated slides. The notes sidebar is\n\t * only visible if showNotes is true and there are notes on\n\t * one or more slides in the deck.\n\t */\n\tupdateVisibility() {\n\n\t\tif( this.Reveal.getConfig().showNotes && this.hasNotes() && !this.Reveal.print.isPrintingPDF() ) {\n\t\t\tthis.Reveal.getRevealElement().classList.add( 'show-notes' );\n\t\t}\n\t\telse {\n\t\t\tthis.Reveal.getRevealElement().classList.remove( 'show-notes' );\n\t\t}\n\n\t}\n\n\t/**\n\t * Checks if there are speaker notes for ANY slide in the\n\t * presentation.\n\t */\n\thasNotes() {\n\n\t\treturn this.Reveal.getSlidesElement().querySelectorAll( '[data-notes], aside.notes' ).length > 0;\n\n\t}\n\n\t/**\n\t * Checks if this presentation is running inside of the\n\t * speaker notes window.\n\t *\n\t * @return {boolean}\n\t */\n\tisSpeakerNotesWindow() {\n\n\t\treturn !!window.location.search.match( /receiver/gi );\n\n\t}\n\n\t/**\n\t * Retrieves the speaker notes from a slide. Notes can be\n\t * defined in two ways:\n\t * 1. As a data-notes attribute on the slide <section>\n\t * 2. With <aside class=\"notes\"> elements inside the slide\n\t *\n\t * @param {HTMLElement} [slide=currentSlide]\n\t * @return {(string|null)}\n\t */\n\tgetSlideNotes( slide = this.Reveal.getCurrentSlide() ) {\n\n\t\t// Notes can be specified via the data-notes attribute...\n\t\tif( slide.hasAttribute( 'data-notes' ) ) {\n\t\t\treturn slide.getAttribute( 'data-notes' );\n\t\t}\n\n\t\t// ... or using <aside class=\"notes\"> elements\n\t\tlet notesElements = slide.querySelectorAll( 'aside.notes' );\n\t\tif( notesElements ) {\n\t\t\treturn Array.from(notesElements).map( notesElement => notesElement.innerHTML ).join( '\\n' );\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tdestroy() {\n\n\t\tthis.element.remove();\n\n\t}\n\n}","/**\n * UI component that lets the use control auto-slide\n * playback via play/pause.\n */\nexport default class Playback {\n\n\t/**\n\t * @param {HTMLElement} container The component will append\n\t * itself to this\n\t * @param {function} progressCheck A method which will be\n\t * called frequently to get the current playback progress on\n\t * a range of 0-1\n\t */\n\tconstructor( container, progressCheck ) {\n\n\t\t// Cosmetics\n\t\tthis.diameter = 100;\n\t\tthis.diameter2 = this.diameter/2;\n\t\tthis.thickness = 6;\n\n\t\t// Flags if we are currently playing\n\t\tthis.playing = false;\n\n\t\t// Current progress on a 0-1 range\n\t\tthis.progress = 0;\n\n\t\t// Used to loop the animation smoothly\n\t\tthis.progressOffset = 1;\n\n\t\tthis.container = container;\n\t\tthis.progressCheck = progressCheck;\n\n\t\tthis.canvas = document.createElement( 'canvas' );\n\t\tthis.canvas.className = 'playback';\n\t\tthis.canvas.width = this.diameter;\n\t\tthis.canvas.height = this.diameter;\n\t\tthis.canvas.style.width = this.diameter2 + 'px';\n\t\tthis.canvas.style.height = this.diameter2 + 'px';\n\t\tthis.context = this.canvas.getContext( '2d' );\n\n\t\tthis.container.appendChild( this.canvas );\n\n\t\tthis.render();\n\n\t}\n\n\tsetPlaying( value ) {\n\n\t\tconst wasPlaying = this.playing;\n\n\t\tthis.playing = value;\n\n\t\t// Start repainting if we weren't already\n\t\tif( !wasPlaying && this.playing ) {\n\t\t\tthis.animate();\n\t\t}\n\t\telse {\n\t\t\tthis.render();\n\t\t}\n\n\t}\n\n\tanimate() {\n\n\t\tconst progressBefore = this.progress;\n\n\t\tthis.progress = this.progressCheck();\n\n\t\t// When we loop, offset the progress so that it eases\n\t\t// smoothly rather than immediately resetting\n\t\tif( progressBefore > 0.8 && this.progress < 0.2 ) {\n\t\t\tthis.progressOffset = this.progress;\n\t\t}\n\n\t\tthis.render();\n\n\t\tif( this.playing ) {\n\t\t\trequestAnimationFrame( this.animate.bind( this ) );\n\t\t}\n\n\t}\n\n\t/**\n\t * Renders the current progress and playback state.\n\t */\n\trender() {\n\n\t\tlet progress = this.playing ? this.progress : 0,\n\t\t\tradius = ( this.diameter2 ) - this.thickness,\n\t\t\tx = this.diameter2,\n\t\t\ty = this.diameter2,\n\t\t\ticonSize = 28;\n\n\t\t// Ease towards 1\n\t\tthis.progressOffset += ( 1 - this.progressOffset ) * 0.1;\n\n\t\tconst endAngle = ( - Math.PI / 2 ) + ( progress * ( Math.PI * 2 ) );\n\t\tconst startAngle = ( - Math.PI / 2 ) + ( this.progressOffset * ( Math.PI * 2 ) );\n\n\t\tthis.context.save();\n\t\tthis.context.clearRect( 0, 0, this.diameter, this.diameter );\n\n\t\t// Solid background color\n\t\tthis.context.beginPath();\n\t\tthis.context.arc( x, y, radius + 4, 0, Math.PI * 2, false );\n\t\tthis.context.fillStyle = 'rgba( 0, 0, 0, 0.4 )';\n\t\tthis.context.fill();\n\n\t\t// Draw progress track\n\t\tthis.context.beginPath();\n\t\tthis.context.arc( x, y, radius, 0, Math.PI * 2, false );\n\t\tthis.context.lineWidth = this.thickness;\n\t\tthis.context.strokeStyle = 'rgba( 255, 255, 255, 0.2 )';\n\t\tthis.context.stroke();\n\n\t\tif( this.playing ) {\n\t\t\t// Draw progress on top of track\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.arc( x, y, radius, startAngle, endAngle, false );\n\t\t\tthis.context.lineWidth = this.thickness;\n\t\t\tthis.context.strokeStyle = '#fff';\n\t\t\tthis.context.stroke();\n\t\t}\n\n\t\tthis.context.translate( x - ( iconSize / 2 ), y - ( iconSize / 2 ) );\n\n\t\t// Draw play/pause icons\n\t\tif( this.playing ) {\n\t\t\tthis.context.fillStyle = '#fff';\n\t\t\tthis.context.fillRect( 0, 0, iconSize / 2 - 4, iconSize );\n\t\t\tthis.context.fillRect( iconSize / 2 + 4, 0, iconSize / 2 - 4, iconSize );\n\t\t}\n\t\telse {\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.translate( 4, 0 );\n\t\t\tthis.context.moveTo( 0, 0 );\n\t\t\tthis.context.lineTo( iconSize - 4, iconSize / 2 );\n\t\t\tthis.context.lineTo( 0, iconSize );\n\t\t\tthis.context.fillStyle = '#fff';\n\t\t\tthis.context.fill();\n\t\t}\n\n\t\tthis.context.restore();\n\n\t}\n\n\ton( type, listener ) {\n\t\tthis.canvas.addEventListener( type, listener, false );\n\t}\n\n\toff( type, listener ) {\n\t\tthis.canvas.removeEventListener( type, listener, false );\n\t}\n\n\tdestroy() {\n\n\t\tthis.playing = false;\n\n\t\tif( this.canvas.parentNode ) {\n\t\t\tthis.container.removeChild( this.canvas );\n\t\t}\n\n\t}\n\n}","/**\n * The default reveal.js config object.\n */\nexport default {\n\n\t// The \"normal\" size of the presentation, aspect ratio will be preserved\n\t// when the presentation is scaled to fit different resolutions\n\twidth: 960,\n\theight: 700,\n\n\t// Factor of the display size that should remain empty around the content\n\tmargin: 0.04,\n\n\t// Bounds for smallest/largest possible scale to apply to content\n\tminScale: 0.2,\n\tmaxScale: 2.0,\n\n\t// Display presentation control arrows\n\tcontrols: true,\n\n\t// Help the user learn the controls by providing hints, for example by\n\t// bouncing the down arrow when they first encounter a vertical slide\n\tcontrolsTutorial: true,\n\n\t// Determines where controls appear, \"edges\" or \"bottom-right\"\n\tcontrolsLayout: 'bottom-right',\n\n\t// Visibility rule for backwards navigation arrows; \"faded\", \"hidden\"\n\t// or \"visible\"\n\tcontrolsBackArrows: 'faded',\n\n\t// Display a presentation progress bar\n\tprogress: true,\n\n\t// Display the page number of the current slide\n\t// - true:    Show slide number\n\t// - false:   Hide slide number\n\t//\n\t// Can optionally be set as a string that specifies the number formatting:\n\t// - \"h.v\":\t  Horizontal . vertical slide number (default)\n\t// - \"h/v\":\t  Horizontal / vertical slide number\n\t// - \"c\":\t  Flattened slide number\n\t// - \"c/t\":\t  Flattened slide number / total slides\n\t//\n\t// Alternatively, you can provide a function that returns the slide\n\t// number for the current slide. The function should take in a slide\n\t// object and return an array with one string [slideNumber] or\n\t// three strings [n1,delimiter,n2]. See #formatSlideNumber().\n\tslideNumber: false,\n\n\t// Can be used to limit the contexts in which the slide number appears\n\t// - \"all\":      Always show the slide number\n\t// - \"print\":    Only when printing to PDF\n\t// - \"speaker\":  Only in the speaker view\n\tshowSlideNumber: 'all',\n\n\t// Use 1 based indexing for # links to match slide number (default is zero\n\t// based)\n\thashOneBasedIndex: false,\n\n\t// Add the current slide number to the URL hash so that reloading the\n\t// page/copying the URL will return you to the same slide\n\thash: false,\n\n\t// Flags if we should monitor the hash and change slides accordingly\n\trespondToHashChanges: true,\n\n\t// Enable support for jump-to-slide navigation shortcuts\n\tjumpToSlide: true,\n\n\t// Push each slide change to the browser history.  Implies `hash: true`\n\thistory: false,\n\n\t// Enable keyboard shortcuts for navigation\n\tkeyboard: true,\n\n\t// Optional function that blocks keyboard events when retuning false\n\t//\n\t// If you set this to 'focused', we will only capture keyboard events\n\t// for embedded decks when they are in focus\n\tkeyboardCondition: null,\n\n\t// Disables the default reveal.js slide layout (scaling and centering)\n\t// so that you can use custom CSS layout\n\tdisableLayout: false,\n\n\t// Enable the slide overview mode\n\toverview: true,\n\n\t// Vertical centering of slides\n\tcenter: true,\n\n\t// Enables touch navigation on devices with touch input\n\ttouch: true,\n\n\t// Loop the presentation\n\tloop: false,\n\n\t// Change the presentation direction to be RTL\n\trtl: false,\n\n\t// Changes the behavior of our navigation directions.\n\t//\n\t// \"default\"\n\t// Left/right arrow keys step between horizontal slides, up/down\n\t// arrow keys step between vertical slides. Space key steps through\n\t// all slides (both horizontal and vertical).\n\t//\n\t// \"linear\"\n\t// Removes the up/down arrows. Left/right arrows step through all\n\t// slides (both horizontal and vertical).\n\t//\n\t// \"grid\"\n\t// When this is enabled, stepping left/right from a vertical stack\n\t// to an adjacent vertical stack will land you at the same vertical\n\t// index.\n\t//\n\t// Consider a deck with six slides ordered in two vertical stacks:\n\t// 1.1    2.1\n\t// 1.2    2.2\n\t// 1.3    2.3\n\t//\n\t// If you're on slide 1.3 and navigate right, you will normally move\n\t// from 1.3 -> 2.1. If \"grid\" is used, the same navigation takes you\n\t// from 1.3 -> 2.3.\n\tnavigationMode: 'default',\n\n\t// Randomizes the order of slides each time the presentation loads\n\tshuffle: false,\n\n\t// Turns fragments on and off globally\n\tfragments: true,\n\n\t// Flags whether to include the current fragment in the URL,\n\t// so that reloading brings you to the same fragment position\n\tfragmentInURL: true,\n\n\t// Flags if the presentation is running in an embedded mode,\n\t// i.e. contained within a limited portion of the screen\n\tembedded: false,\n\n\t// Flags if we should show a help overlay when the question-mark\n\t// key is pressed\n\thelp: true,\n\n\t// Flags if it should be possible to pause the presentation (blackout)\n\tpause: true,\n\n\t// Flags if speaker notes should be visible to all viewers\n\tshowNotes: false,\n\n\t// Flags if slides with data-visibility=\"hidden\" should be kep visible\n\tshowHiddenSlides: false,\n\n\t// Global override for autoplaying embedded media (video/audio/iframe)\n\t// - null:   Media will only autoplay if data-autoplay is present\n\t// - true:   All media will autoplay, regardless of individual setting\n\t// - false:  No media will autoplay, regardless of individual setting\n\tautoPlayMedia: null,\n\n\t// Global override for preloading lazy-loaded iframes\n\t// - null:   Iframes with data-src AND data-preload will be loaded when within\n\t//           the viewDistance, iframes with only data-src will be loaded when visible\n\t// - true:   All iframes with data-src will be loaded when within the viewDistance\n\t// - false:  All iframes with data-src will be loaded only when visible\n\tpreloadIframes: null,\n\n\t// Can be used to globally disable auto-animation\n\tautoAnimate: true,\n\n\t// Optionally provide a custom element matcher that will be\n\t// used to dictate which elements we can animate between.\n\tautoAnimateMatcher: null,\n\n\t// Default settings for our auto-animate transitions, can be\n\t// overridden per-slide or per-element via data arguments\n\tautoAnimateEasing: 'ease',\n\tautoAnimateDuration: 1.0,\n\tautoAnimateUnmatched: true,\n\n\t// CSS properties that can be auto-animated. Position & scale\n\t// is matched separately so there's no need to include styles\n\t// like top/right/bottom/left, width/height or margin.\n\tautoAnimateStyles: [\n\t\t'opacity',\n\t\t'color',\n\t\t'background-color',\n\t\t'padding',\n\t\t'font-size',\n\t\t'line-height',\n\t\t'letter-spacing',\n\t\t'border-width',\n\t\t'border-color',\n\t\t'border-radius',\n\t\t'outline',\n\t\t'outline-offset'\n\t],\n\n\t// Controls automatic progression to the next slide\n\t// - 0:      Auto-sliding only happens if the data-autoslide HTML attribute\n\t//           is present on the current slide or fragment\n\t// - 1+:     All slides will progress automatically at the given interval\n\t// - false:  No auto-sliding, even if data-autoslide is present\n\tautoSlide: 0,\n\n\t// Stop auto-sliding after user input\n\tautoSlideStoppable: true,\n\n\t// Use this method for navigation when auto-sliding (defaults to navigateNext)\n\tautoSlideMethod: null,\n\n\t// Specify the average time in seconds that you think you will spend\n\t// presenting each slide. This is used to show a pacing timer in the\n\t// speaker view\n\tdefaultTiming: null,\n\n\t// Enable slide navigation via mouse wheel\n\tmouseWheel: false,\n\n\t// Opens links in an iframe preview overlay\n\t// Add `data-preview-link` and `data-preview-link=\"false\"` to customise each link\n\t// individually\n\tpreviewLinks: false,\n\n\t// Exposes the reveal.js API through window.postMessage\n\tpostMessage: true,\n\n\t// Dispatches all reveal.js events to the parent window through postMessage\n\tpostMessageEvents: false,\n\n\t// Focuses body when page changes visibility to ensure keyboard shortcuts work\n\tfocusBodyOnPageVisibilityChange: true,\n\n\t// Transition style\n\ttransition: 'slide', // none/fade/slide/convex/concave/zoom\n\n\t// Transition speed\n\ttransitionSpeed: 'default', // default/fast/slow\n\n\t// Transition style for full page slide backgrounds\n\tbackgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom\n\n\t// Parallax background image\n\tparallaxBackgroundImage: '', // CSS syntax, e.g. \"a.jpg\"\n\n\t// Parallax background size\n\tparallaxBackgroundSize: '', // CSS syntax, e.g. \"3000px 2000px\"\n\n\t// Parallax background repeat\n\tparallaxBackgroundRepeat: '', // repeat/repeat-x/repeat-y/no-repeat/initial/inherit\n\n\t// Parallax background position\n\tparallaxBackgroundPosition: '', // CSS syntax, e.g. \"top left\"\n\n\t// Amount of pixels to move the parallax background per slide step\n\tparallaxBackgroundHorizontal: null,\n\tparallaxBackgroundVertical: null,\n\n\t// The maximum number of pages a single slide can expand onto when printing\n\t// to PDF, unlimited by default\n\tpdfMaxPagesPerSlide: Number.POSITIVE_INFINITY,\n\n\t// Prints each fragment on a separate slide\n\tpdfSeparateFragments: true,\n\n\t// Offset used to reduce the height of content within exported PDF pages.\n\t// This exists to account for environment differences based on how you\n\t// print to PDF. CLI printing options, like phantomjs and wkpdf, can end\n\t// on precisely the total height of the document whereas in-browser\n\t// printing has to end one pixel before.\n\tpdfPageHeightOffset: -1,\n\n\t// Number of slides away from the current that are visible\n\tviewDistance: 3,\n\n\t// Number of slides away from the current that are visible on mobile\n\t// devices. It is advisable to set this to a lower number than\n\t// viewDistance in order to save resources.\n\tmobileViewDistance: 2,\n\n\t// The display mode that will be used to show slides\n\tdisplay: 'block',\n\n\t// Hide cursor if inactive\n\thideInactiveCursor: true,\n\n\t// Time before the cursor is hidden (in ms)\n\thideCursorTime: 5000,\n\n\t// Should we automatmically sort and set indices for fragments\n\t// at each sync? (See Reveal.sync)\n\tsortFragmentsOnSync: true,\n\n\t// Script dependencies to load\n\tdependencies: [],\n\n\t// Plugin objects to register and use for this presentation\n\tplugins: []\n\n}","import SlideContent from './controllers/slidecontent.js'\nimport SlideNumber from './controllers/slidenumber.js'\nimport JumpToSlide from './controllers/jumptoslide.js'\nimport Backgrounds from './controllers/backgrounds.js'\nimport AutoAnimate from './controllers/autoanimate.js'\nimport Fragments from './controllers/fragments.js'\nimport Overview from './controllers/overview.js'\nimport Keyboard from './controllers/keyboard.js'\nimport Location from './controllers/location.js'\nimport Controls from './controllers/controls.js'\nimport Progress from './controllers/progress.js'\nimport Pointer from './controllers/pointer.js'\nimport Plugins from './controllers/plugins.js'\nimport Print from './controllers/print.js'\nimport Touch from './controllers/touch.js'\nimport Focus from './controllers/focus.js'\nimport Notes from './controllers/notes.js'\nimport Playback from './components/playback.js'\nimport defaultConfig from './config.js'\nimport * as Util from './utils/util.js'\nimport * as Device from './utils/device.js'\nimport {\n\tSLIDES_SELECTOR,\n\tHORIZONTAL_SLIDES_SELECTOR,\n\tVERTICAL_SLIDES_SELECTOR,\n\tPOST_MESSAGE_METHOD_BLACKLIST\n} from './utils/constants.js'\n\n// The reveal.js version\nexport const VERSION = '4.5.0';\n\n/**\n * reveal.js\n * https://revealjs.com\n * MIT licensed\n *\n * Copyright (C) 2011-2022 Hakim El Hattab, https://hakim.se\n */\nexport default function( revealElement, options ) {\n\n\t// Support initialization with no args, one arg\n\t// [options] or two args [revealElement, options]\n\tif( arguments.length < 2 ) {\n\t\toptions = arguments[0];\n\t\trevealElement = document.querySelector( '.reveal' );\n\t}\n\n\tconst Reveal = {};\n\n\t// Configuration defaults, can be overridden at initialization time\n\tlet config = {},\n\n\t\t// Flags if reveal.js is loaded (has dispatched the 'ready' event)\n\t\tready = false,\n\n\t\t// The horizontal and vertical index of the currently active slide\n\t\tindexh,\n\t\tindexv,\n\n\t\t// The previous and current slide HTML elements\n\t\tpreviousSlide,\n\t\tcurrentSlide,\n\n\t\t// Remember which directions that the user has navigated towards\n\t\tnavigationHistory = {\n\t\t\thasNavigatedHorizontally: false,\n\t\t\thasNavigatedVertically: false\n\t\t},\n\n\t\t// Slides may have a data-state attribute which we pick up and apply\n\t\t// as a class to the body. This list contains the combined state of\n\t\t// all current slides.\n\t\tstate = [],\n\n\t\t// The current scale of the presentation (see width/height config)\n\t\tscale = 1,\n\n\t\t// CSS transform that is currently applied to the slides container,\n\t\t// split into two groups\n\t\tslidesTransform = { layout: '', overview: '' },\n\n\t\t// Cached references to DOM elements\n\t\tdom = {},\n\n\t\t// Flags if the interaction event listeners are bound\n\t\teventsAreBound = false,\n\n\t\t// The current slide transition state; idle or running\n\t\ttransition = 'idle',\n\n\t\t// The current auto-slide duration\n\t\tautoSlide = 0,\n\n\t\t// Auto slide properties\n\t\tautoSlidePlayer,\n\t\tautoSlideTimeout = 0,\n\t\tautoSlideStartTime = -1,\n\t\tautoSlidePaused = false,\n\n\t\t// Controllers for different aspects of our presentation. They're\n\t\t// all given direct references to this Reveal instance since there\n\t\t// may be multiple presentations running in parallel.\n\t\tslideContent = new SlideContent( Reveal ),\n\t\tslideNumber = new SlideNumber( Reveal ),\n\t\tjumpToSlide = new JumpToSlide( Reveal ),\n\t\tautoAnimate = new AutoAnimate( Reveal ),\n\t\tbackgrounds = new Backgrounds( Reveal ),\n\t\tfragments = new Fragments( Reveal ),\n\t\toverview = new Overview( Reveal ),\n\t\tkeyboard = new Keyboard( Reveal ),\n\t\tlocation = new Location( Reveal ),\n\t\tcontrols = new Controls( Reveal ),\n\t\tprogress = new Progress( Reveal ),\n\t\tpointer = new Pointer( Reveal ),\n\t\tplugins = new Plugins( Reveal ),\n\t\tprint = new Print( Reveal ),\n\t\tfocus = new Focus( Reveal ),\n\t\ttouch = new Touch( Reveal ),\n\t\tnotes = new Notes( Reveal );\n\n\t/**\n\t * Starts up the presentation.\n\t */\n\tfunction initialize( initOptions ) {\n\n\t\tif( !revealElement ) throw 'Unable to find presentation root (<div class=\"reveal\">).';\n\n\t\t// Cache references to key DOM elements\n\t\tdom.wrapper = revealElement;\n\t\tdom.slides = revealElement.querySelector( '.slides' );\n\n\t\tif( !dom.slides ) throw 'Unable to find slides container (<div class=\"slides\">).';\n\n\t\t// Compose our config object in order of increasing precedence:\n\t\t// 1. Default reveal.js options\n\t\t// 2. Options provided via Reveal.configure() prior to\n\t\t//    initialization\n\t\t// 3. Options passed to the Reveal constructor\n\t\t// 4. Options passed to Reveal.initialize\n\t\t// 5. Query params\n\t\tconfig = { ...defaultConfig, ...config, ...options, ...initOptions, ...Util.getQueryHash() };\n\n\t\tsetViewport();\n\n\t\t// Force a layout when the whole page, incl fonts, has loaded\n\t\twindow.addEventListener( 'load', layout, false );\n\n\t\t// Register plugins and load dependencies, then move on to #start()\n\t\tplugins.load( config.plugins, config.dependencies ).then( start );\n\n\t\treturn new Promise( resolve => Reveal.on( 'ready', resolve ) );\n\n\t}\n\n\t/**\n\t * Encase the presentation in a reveal.js viewport. The\n\t * extent of the viewport differs based on configuration.\n\t */\n\tfunction setViewport() {\n\n\t\t// Embedded decks use the reveal element as their viewport\n\t\tif( config.embedded === true ) {\n\t\t\tdom.viewport = Util.closest( revealElement, '.reveal-viewport' ) || revealElement;\n\t\t}\n\t\t// Full-page decks use the body as their viewport\n\t\telse {\n\t\t\tdom.viewport = document.body;\n\t\t\tdocument.documentElement.classList.add( 'reveal-full-page' );\n\t\t}\n\n\t\tdom.viewport.classList.add( 'reveal-viewport' );\n\n\t}\n\n\t/**\n\t * Starts up reveal.js by binding input events and navigating\n\t * to the current URL deeplink if there is one.\n\t */\n\tfunction start() {\n\n\t\tready = true;\n\n\t\t// Remove slides hidden with data-visibility\n\t\tremoveHiddenSlides();\n\n\t\t// Make sure we've got all the DOM elements we need\n\t\tsetupDOM();\n\n\t\t// Listen to messages posted to this window\n\t\tsetupPostMessage();\n\n\t\t// Prevent the slides from being scrolled out of view\n\t\tsetupScrollPrevention();\n\n\t\t// Adds bindings for fullscreen mode\n\t\tsetupFullscreen();\n\n\t\t// Resets all vertical slides so that only the first is visible\n\t\tresetVerticalSlides();\n\n\t\t// Updates the presentation to match the current configuration values\n\t\tconfigure();\n\n\t\t// Read the initial hash\n\t\tlocation.readURL();\n\n\t\t// Create slide backgrounds\n\t\tbackgrounds.update( true );\n\n\t\t// Notify listeners that the presentation is ready but use a 1ms\n\t\t// timeout to ensure it's not fired synchronously after #initialize()\n\t\tsetTimeout( () => {\n\t\t\t// Enable transitions now that we're loaded\n\t\t\tdom.slides.classList.remove( 'no-transition' );\n\n\t\t\tdom.wrapper.classList.add( 'ready' );\n\n\t\t\tdispatchEvent({\n\t\t\t\ttype: 'ready',\n\t\t\t\tdata: {\n\t\t\t\t\tindexh,\n\t\t\t\t\tindexv,\n\t\t\t\t\tcurrentSlide\n\t\t\t\t}\n\t\t\t});\n\t\t}, 1 );\n\n\t\t// Special setup and config is required when printing to PDF\n\t\tif( print.isPrintingPDF() ) {\n\t\t\tremoveEventListeners();\n\n\t\t\t// The document needs to have loaded for the PDF layout\n\t\t\t// measurements to be accurate\n\t\t\tif( document.readyState === 'complete' ) {\n\t\t\t\tprint.setupPDF();\n\t\t\t}\n\t\t\telse {\n\t\t\t\twindow.addEventListener( 'load', () => {\n\t\t\t\t\tprint.setupPDF();\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Removes all slides with data-visibility=\"hidden\". This\n\t * is done right before the rest of the presentation is\n\t * initialized.\n\t *\n\t * If you want to show all hidden slides, initialize\n\t * reveal.js with showHiddenSlides set to true.\n\t */\n\tfunction removeHiddenSlides() {\n\n\t\tif( !config.showHiddenSlides ) {\n\t\t\tUtil.queryAll( dom.wrapper, 'section[data-visibility=\"hidden\"]' ).forEach( slide => {\n\t\t\t\tslide.parentNode.removeChild( slide );\n\t\t\t} );\n\t\t}\n\n\t}\n\n\t/**\n\t * Finds and stores references to DOM elements which are\n\t * required by the presentation. If a required element is\n\t * not found, it is created.\n\t */\n\tfunction setupDOM() {\n\n\t\t// Prevent transitions while we're loading\n\t\tdom.slides.classList.add( 'no-transition' );\n\n\t\tif( Device.isMobile ) {\n\t\t\tdom.wrapper.classList.add( 'no-hover' );\n\t\t}\n\t\telse {\n\t\t\tdom.wrapper.classList.remove( 'no-hover' );\n\t\t}\n\n\t\tbackgrounds.render();\n\t\tslideNumber.render();\n\t\tjumpToSlide.render();\n\t\tcontrols.render();\n\t\tprogress.render();\n\t\tnotes.render();\n\n\t\t// Overlay graphic which is displayed during the paused mode\n\t\tdom.pauseOverlay = Util.createSingletonNode( dom.wrapper, 'div', 'pause-overlay', config.controls ? '<button class=\"resume-button\">Resume presentation</button>' : null );\n\n\t\tdom.statusElement = createStatusElement();\n\n\t\tdom.wrapper.setAttribute( 'role', 'application' );\n\t}\n\n\t/**\n\t * Creates a hidden div with role aria-live to announce the\n\t * current slide content. Hide the div off-screen to make it\n\t * available only to Assistive Technologies.\n\t *\n\t * @return {HTMLElement}\n\t */\n\tfunction createStatusElement() {\n\n\t\tlet statusElement = dom.wrapper.querySelector( '.aria-status' );\n\t\tif( !statusElement ) {\n\t\t\tstatusElement = document.createElement( 'div' );\n\t\t\tstatusElement.style.position = 'absolute';\n\t\t\tstatusElement.style.height = '1px';\n\t\t\tstatusElement.style.width = '1px';\n\t\t\tstatusElement.style.overflow = 'hidden';\n\t\t\tstatusElement.style.clip = 'rect( 1px, 1px, 1px, 1px )';\n\t\t\tstatusElement.classList.add( 'aria-status' );\n\t\t\tstatusElement.setAttribute( 'aria-live', 'polite' );\n\t\t\tstatusElement.setAttribute( 'aria-atomic','true' );\n\t\t\tdom.wrapper.appendChild( statusElement );\n\t\t}\n\t\treturn statusElement;\n\n\t}\n\n\t/**\n\t * Announces the given text to screen readers.\n\t */\n\tfunction announceStatus( value ) {\n\n\t\tdom.statusElement.textContent = value;\n\n\t}\n\n\t/**\n\t * Converts the given HTML element into a string of text\n\t * that can be announced to a screen reader. Hidden\n\t * elements are excluded.\n\t */\n\tfunction getStatusText( node ) {\n\n\t\tlet text = '';\n\n\t\t// Text node\n\t\tif( node.nodeType === 3 ) {\n\t\t\ttext += node.textContent;\n\t\t}\n\t\t// Element node\n\t\telse if( node.nodeType === 1 ) {\n\n\t\t\tlet isAriaHidden = node.getAttribute( 'aria-hidden' );\n\t\t\tlet isDisplayHidden = window.getComputedStyle( node )['display'] === 'none';\n\t\t\tif( isAriaHidden !== 'true' && !isDisplayHidden ) {\n\n\t\t\t\tArray.from( node.childNodes ).forEach( child => {\n\t\t\t\t\ttext += getStatusText( child );\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t\ttext = text.trim();\n\n\t\treturn text === '' ? '' : text + ' ';\n\n\t}\n\n\t/**\n\t * This is an unfortunate necessity. Some actions  such as\n\t * an input field being focused in an iframe or using the\n\t * keyboard to expand text selection beyond the bounds of\n\t * a slide  can trigger our content to be pushed out of view.\n\t * This scrolling can not be prevented by hiding overflow in\n\t * CSS (we already do) so we have to resort to repeatedly\n\t * checking if the slides have been offset :(\n\t */\n\tfunction setupScrollPrevention() {\n\n\t\tsetInterval( () => {\n\t\t\tif( dom.wrapper.scrollTop !== 0 || dom.wrapper.scrollLeft !== 0 ) {\n\t\t\t\tdom.wrapper.scrollTop = 0;\n\t\t\t\tdom.wrapper.scrollLeft = 0;\n\t\t\t}\n\t\t}, 1000 );\n\n\t}\n\n\t/**\n\t * After entering fullscreen we need to force a layout to\n\t * get our presentations to scale correctly. This behavior\n\t * is inconsistent across browsers but a force layout seems\n\t * to normalize it.\n\t */\n\tfunction setupFullscreen() {\n\n\t\tdocument.addEventListener( 'fullscreenchange', onFullscreenChange );\n\t\tdocument.addEventListener( 'webkitfullscreenchange', onFullscreenChange );\n\n\t}\n\n\t/**\n\t * Registers a listener to postMessage events, this makes it\n\t * possible to call all reveal.js API methods from another\n\t * window. For example:\n\t *\n\t * revealWindow.postMessage( JSON.stringify({\n\t *   method: 'slide',\n\t *   args: [ 2 ]\n\t * }), '*' );\n\t */\n\tfunction setupPostMessage() {\n\n\t\tif( config.postMessage ) {\n\t\t\twindow.addEventListener( 'message', onPostMessage, false );\n\t\t}\n\n\t}\n\n\t/**\n\t * Applies the configuration settings from the config\n\t * object. May be called multiple times.\n\t *\n\t * @param {object} options\n\t */\n\tfunction configure( options ) {\n\n\t\tconst oldConfig = { ...config }\n\n\t\t// New config options may be passed when this method\n\t\t// is invoked through the API after initialization\n\t\tif( typeof options === 'object' ) Util.extend( config, options );\n\n\t\t// Abort if reveal.js hasn't finished loading, config\n\t\t// changes will be applied automatically once ready\n\t\tif( Reveal.isReady() ===  false ) return;\n\n\t\tconst numberOfSlides = dom.wrapper.querySelectorAll( SLIDES_SELECTOR ).length;\n\n\t\t// The transition is added as a class on the .reveal element\n\t\tdom.wrapper.classList.remove( oldConfig.transition );\n\t\tdom.wrapper.classList.add( config.transition );\n\n\t\tdom.wrapper.setAttribute( 'data-transition-speed', config.transitionSpeed );\n\t\tdom.wrapper.setAttribute( 'data-background-transition', config.backgroundTransition );\n\n\t\t// Expose our configured slide dimensions as custom props\n\t\tdom.viewport.style.setProperty( '--slide-width', config.width + 'px' );\n\t\tdom.viewport.style.setProperty( '--slide-height', config.height + 'px' );\n\n\t\tif( config.shuffle ) {\n\t\t\tshuffle();\n\t\t}\n\n\t\tUtil.toggleClass( dom.wrapper, 'embedded', config.embedded );\n\t\tUtil.toggleClass( dom.wrapper, 'rtl', config.rtl );\n\t\tUtil.toggleClass( dom.wrapper, 'center', config.center );\n\n\t\t// Exit the paused mode if it was configured off\n\t\tif( config.pause === false ) {\n\t\t\tresume();\n\t\t}\n\n\t\t// Iframe link previews\n\t\tif( config.previewLinks ) {\n\t\t\tenablePreviewLinks();\n\t\t\tdisablePreviewLinks( '[data-preview-link=false]' );\n\t\t}\n\t\telse {\n\t\t\tdisablePreviewLinks();\n\t\t\tenablePreviewLinks( '[data-preview-link]:not([data-preview-link=false])' );\n\t\t}\n\n\t\t// Reset all changes made by auto-animations\n\t\tautoAnimate.reset();\n\n\t\t// Remove existing auto-slide controls\n\t\tif( autoSlidePlayer ) {\n\t\t\tautoSlidePlayer.destroy();\n\t\t\tautoSlidePlayer = null;\n\t\t}\n\n\t\t// Generate auto-slide controls if needed\n\t\tif( numberOfSlides > 1 && config.autoSlide && config.autoSlideStoppable ) {\n\t\t\tautoSlidePlayer = new Playback( dom.wrapper, () => {\n\t\t\t\treturn Math.min( Math.max( ( Date.now() - autoSlideStartTime ) / autoSlide, 0 ), 1 );\n\t\t\t} );\n\n\t\t\tautoSlidePlayer.on( 'click', onAutoSlidePlayerClick );\n\t\t\tautoSlidePaused = false;\n\t\t}\n\n\t\t// Add the navigation mode to the DOM so we can adjust styling\n\t\tif( config.navigationMode !== 'default' ) {\n\t\t\tdom.wrapper.setAttribute( 'data-navigation-mode', config.navigationMode );\n\t\t}\n\t\telse {\n\t\t\tdom.wrapper.removeAttribute( 'data-navigation-mode' );\n\t\t}\n\n\t\tnotes.configure( config, oldConfig );\n\t\tfocus.configure( config, oldConfig );\n\t\tpointer.configure( config, oldConfig );\n\t\tcontrols.configure( config, oldConfig );\n\t\tprogress.configure( config, oldConfig );\n\t\tkeyboard.configure( config, oldConfig );\n\t\tfragments.configure( config, oldConfig );\n\t\tslideNumber.configure( config, oldConfig );\n\n\t\tsync();\n\n\t}\n\n\t/**\n\t * Binds all event listeners.\n\t */\n\tfunction addEventListeners() {\n\n\t\teventsAreBound = true;\n\n\t\twindow.addEventListener( 'resize', onWindowResize, false );\n\n\t\tif( config.touch ) touch.bind();\n\t\tif( config.keyboard ) keyboard.bind();\n\t\tif( config.progress ) progress.bind();\n\t\tif( config.respondToHashChanges ) location.bind();\n\t\tcontrols.bind();\n\t\tfocus.bind();\n\n\t\tdom.slides.addEventListener( 'click', onSlidesClicked, false );\n\t\tdom.slides.addEventListener( 'transitionend', onTransitionEnd, false );\n\t\tdom.pauseOverlay.addEventListener( 'click', resume, false );\n\n\t\tif( config.focusBodyOnPageVisibilityChange ) {\n\t\t\tdocument.addEventListener( 'visibilitychange', onPageVisibilityChange, false );\n\t\t}\n\n\t}\n\n\t/**\n\t * Unbinds all event listeners.\n\t */\n\tfunction removeEventListeners() {\n\n\t\teventsAreBound = false;\n\n\t\ttouch.unbind();\n\t\tfocus.unbind();\n\t\tkeyboard.unbind();\n\t\tcontrols.unbind();\n\t\tprogress.unbind();\n\t\tlocation.unbind();\n\n\t\twindow.removeEventListener( 'resize', onWindowResize, false );\n\n\t\tdom.slides.removeEventListener( 'click', onSlidesClicked, false );\n\t\tdom.slides.removeEventListener( 'transitionend', onTransitionEnd, false );\n\t\tdom.pauseOverlay.removeEventListener( 'click', resume, false );\n\n\t}\n\n\t/**\n\t * Uninitializes reveal.js by undoing changes made to the\n\t * DOM and removing all event listeners.\n\t */\n\tfunction destroy() {\n\n\t\tremoveEventListeners();\n\t\tcancelAutoSlide();\n\t\tdisablePreviewLinks();\n\n\t\t// Destroy controllers\n\t\tnotes.destroy();\n\t\tfocus.destroy();\n\t\tplugins.destroy();\n\t\tpointer.destroy();\n\t\tcontrols.destroy();\n\t\tprogress.destroy();\n\t\tbackgrounds.destroy();\n\t\tslideNumber.destroy();\n\t\tjumpToSlide.destroy();\n\n\t\t// Remove event listeners\n\t\tdocument.removeEventListener( 'fullscreenchange', onFullscreenChange );\n\t\tdocument.removeEventListener( 'webkitfullscreenchange', onFullscreenChange );\n\t\tdocument.removeEventListener( 'visibilitychange', onPageVisibilityChange, false );\n\t\twindow.removeEventListener( 'message', onPostMessage, false );\n\t\twindow.removeEventListener( 'load', layout, false );\n\n\t\t// Undo DOM changes\n\t\tif( dom.pauseOverlay ) dom.pauseOverlay.remove();\n\t\tif( dom.statusElement ) dom.statusElement.remove();\n\n\t\tdocument.documentElement.classList.remove( 'reveal-full-page' );\n\n\t\tdom.wrapper.classList.remove( 'ready', 'center', 'has-horizontal-slides', 'has-vertical-slides' );\n\t\tdom.wrapper.removeAttribute( 'data-transition-speed' );\n\t\tdom.wrapper.removeAttribute( 'data-background-transition' );\n\n\t\tdom.viewport.classList.remove( 'reveal-viewport' );\n\t\tdom.viewport.style.removeProperty( '--slide-width' );\n\t\tdom.viewport.style.removeProperty( '--slide-height' );\n\n\t\tdom.slides.style.removeProperty( 'width' );\n\t\tdom.slides.style.removeProperty( 'height' );\n\t\tdom.slides.style.removeProperty( 'zoom' );\n\t\tdom.slides.style.removeProperty( 'left' );\n\t\tdom.slides.style.removeProperty( 'top' );\n\t\tdom.slides.style.removeProperty( 'bottom' );\n\t\tdom.slides.style.removeProperty( 'right' );\n\t\tdom.slides.style.removeProperty( 'transform' );\n\n\t\tArray.from( dom.wrapper.querySelectorAll( SLIDES_SELECTOR ) ).forEach( slide => {\n\t\t\tslide.style.removeProperty( 'display' );\n\t\t\tslide.style.removeProperty( 'top' );\n\t\t\tslide.removeAttribute( 'hidden' );\n\t\t\tslide.removeAttribute( 'aria-hidden' );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Adds a listener to one of our custom reveal.js events,\n\t * like slidechanged.\n\t */\n\tfunction on( type, listener, useCapture ) {\n\n\t\trevealElement.addEventListener( type, listener, useCapture );\n\n\t}\n\n\t/**\n\t * Unsubscribes from a reveal.js event.\n\t */\n\tfunction off( type, listener, useCapture ) {\n\n\t\trevealElement.removeEventListener( type, listener, useCapture );\n\n\t}\n\n\t/**\n\t * Applies CSS transforms to the slides container. The container\n\t * is transformed from two separate sources: layout and the overview\n\t * mode.\n\t *\n\t * @param {object} transforms\n\t */\n\tfunction transformSlides( transforms ) {\n\n\t\t// Pick up new transforms from arguments\n\t\tif( typeof transforms.layout === 'string' ) slidesTransform.layout = transforms.layout;\n\t\tif( typeof transforms.overview === 'string' ) slidesTransform.overview = transforms.overview;\n\n\t\t// Apply the transforms to the slides container\n\t\tif( slidesTransform.layout ) {\n\t\t\tUtil.transformElement( dom.slides, slidesTransform.layout + ' ' + slidesTransform.overview );\n\t\t}\n\t\telse {\n\t\t\tUtil.transformElement( dom.slides, slidesTransform.overview );\n\t\t}\n\n\t}\n\n\t/**\n\t * Dispatches an event of the specified type from the\n\t * reveal DOM element.\n\t */\n\tfunction dispatchEvent({ target=dom.wrapper, type, data, bubbles=true }) {\n\n\t\tlet event = document.createEvent( 'HTMLEvents', 1, 2 );\n\t\tevent.initEvent( type, bubbles, true );\n\t\tUtil.extend( event, data );\n\t\ttarget.dispatchEvent( event );\n\n\t\tif( target === dom.wrapper ) {\n\t\t\t// If we're in an iframe, post each reveal.js event to the\n\t\t\t// parent window. Used by the notes plugin\n\t\t\tdispatchPostMessage( type );\n\t\t}\n\n\t\treturn event;\n\n\t}\n\n\t/**\n\t * Dispatched a postMessage of the given type from our window.\n\t */\n\tfunction dispatchPostMessage( type, data ) {\n\n\t\tif( config.postMessageEvents && window.parent !== window.self ) {\n\t\t\tlet message = {\n\t\t\t\tnamespace: 'reveal',\n\t\t\t\teventName: type,\n\t\t\t\tstate: getState()\n\t\t\t};\n\n\t\t\tUtil.extend( message, data );\n\n\t\t\twindow.parent.postMessage( JSON.stringify( message ), '*' );\n\t\t}\n\n\t}\n\n\t/**\n\t * Bind preview frame links.\n\t *\n\t * @param {string} [selector=a] - selector for anchors\n\t */\n\tfunction enablePreviewLinks( selector = 'a' ) {\n\n\t\tArray.from( dom.wrapper.querySelectorAll( selector ) ).forEach( element => {\n\t\t\tif( /^(http|www)/gi.test( element.getAttribute( 'href' ) ) ) {\n\t\t\t\telement.addEventListener( 'click', onPreviewLinkClicked, false );\n\t\t\t}\n\t\t} );\n\n\t}\n\n\t/**\n\t * Unbind preview frame links.\n\t */\n\tfunction disablePreviewLinks( selector = 'a' ) {\n\n\t\tArray.from( dom.wrapper.querySelectorAll( selector ) ).forEach( element => {\n\t\t\tif( /^(http|www)/gi.test( element.getAttribute( 'href' ) ) ) {\n\t\t\t\telement.removeEventListener( 'click', onPreviewLinkClicked, false );\n\t\t\t}\n\t\t} );\n\n\t}\n\n\t/**\n\t * Opens a preview window for the target URL.\n\t *\n\t * @param {string} url - url for preview iframe src\n\t */\n\tfunction showPreview( url ) {\n\n\t\tcloseOverlay();\n\n\t\tdom.overlay = document.createElement( 'div' );\n\t\tdom.overlay.classList.add( 'overlay' );\n\t\tdom.overlay.classList.add( 'overlay-preview' );\n\t\tdom.wrapper.appendChild( dom.overlay );\n\n\t\tdom.overlay.innerHTML =\n\t\t\t`<header>\n\t\t\t\t<a class=\"close\" href=\"#\"><span class=\"icon\"></span></a>\n\t\t\t\t<a class=\"external\" href=\"${url}\" target=\"_blank\"><span class=\"icon\"></span></a>\n\t\t\t</header>\n\t\t\t<div class=\"spinner\"></div>\n\t\t\t<div class=\"viewport\">\n\t\t\t\t<iframe src=\"${url}\"></iframe>\n\t\t\t\t<small class=\"viewport-inner\">\n\t\t\t\t\t<span class=\"x-frame-error\">Unable to load iframe. This is likely due to the site's policy (x-frame-options).</span>\n\t\t\t\t</small>\n\t\t\t</div>`;\n\n\t\tdom.overlay.querySelector( 'iframe' ).addEventListener( 'load', event => {\n\t\t\tdom.overlay.classList.add( 'loaded' );\n\t\t}, false );\n\n\t\tdom.overlay.querySelector( '.close' ).addEventListener( 'click', event => {\n\t\t\tcloseOverlay();\n\t\t\tevent.preventDefault();\n\t\t}, false );\n\n\t\tdom.overlay.querySelector( '.external' ).addEventListener( 'click', event => {\n\t\t\tcloseOverlay();\n\t\t}, false );\n\n\t}\n\n\t/**\n\t * Open or close help overlay window.\n\t *\n\t * @param {Boolean} [override] Flag which overrides the\n\t * toggle logic and forcibly sets the desired state. True means\n\t * help is open, false means it's closed.\n\t */\n\tfunction toggleHelp( override ){\n\n\t\tif( typeof override === 'boolean' ) {\n\t\t\toverride ? showHelp() : closeOverlay();\n\t\t}\n\t\telse {\n\t\t\tif( dom.overlay ) {\n\t\t\t\tcloseOverlay();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tshowHelp();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Opens an overlay window with help material.\n\t */\n\tfunction showHelp() {\n\n\t\tif( config.help ) {\n\n\t\t\tcloseOverlay();\n\n\t\t\tdom.overlay = document.createElement( 'div' );\n\t\t\tdom.overlay.classList.add( 'overlay' );\n\t\t\tdom.overlay.classList.add( 'overlay-help' );\n\t\t\tdom.wrapper.appendChild( dom.overlay );\n\n\t\t\tlet html = '<p class=\"title\">Keyboard Shortcuts</p><br/>';\n\n\t\t\tlet shortcuts = keyboard.getShortcuts(),\n\t\t\t\tbindings = keyboard.getBindings();\n\n\t\t\thtml += '<table><th>KEY</th><th>ACTION</th>';\n\t\t\tfor( let key in shortcuts ) {\n\t\t\t\thtml += `<tr><td>${key}</td><td>${shortcuts[ key ]}</td></tr>`;\n\t\t\t}\n\n\t\t\t// Add custom key bindings that have associated descriptions\n\t\t\tfor( let binding in bindings ) {\n\t\t\t\tif( bindings[binding].key && bindings[binding].description ) {\n\t\t\t\t\thtml += `<tr><td>${bindings[binding].key}</td><td>${bindings[binding].description}</td></tr>`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\thtml += '</table>';\n\n\t\t\tdom.overlay.innerHTML = `\n\t\t\t\t<header>\n\t\t\t\t\t<a class=\"close\" href=\"#\"><span class=\"icon\"></span></a>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"viewport\">\n\t\t\t\t\t<div class=\"viewport-inner\">${html}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tdom.overlay.querySelector( '.close' ).addEventListener( 'click', event => {\n\t\t\t\tcloseOverlay();\n\t\t\t\tevent.preventDefault();\n\t\t\t}, false );\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Closes any currently open overlay.\n\t */\n\tfunction closeOverlay() {\n\n\t\tif( dom.overlay ) {\n\t\t\tdom.overlay.parentNode.removeChild( dom.overlay );\n\t\t\tdom.overlay = null;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t/**\n\t * Applies JavaScript-controlled layout rules to the\n\t * presentation.\n\t */\n\tfunction layout() {\n\n\t\tif( dom.wrapper && !print.isPrintingPDF() ) {\n\n\t\t\tif( !config.disableLayout ) {\n\n\t\t\t\t// On some mobile devices '100vh' is taller than the visible\n\t\t\t\t// viewport which leads to part of the presentation being\n\t\t\t\t// cut off. To work around this we define our own '--vh' custom\n\t\t\t\t// property where 100x adds up to the correct height.\n\t\t\t\t//\n\t\t\t\t// https://css-tricks.com/the-trick-to-viewport-units-on-mobile/\n\t\t\t\tif( Device.isMobile && !config.embedded ) {\n\t\t\t\t\tdocument.documentElement.style.setProperty( '--vh', ( window.innerHeight * 0.01 ) + 'px' );\n\t\t\t\t}\n\n\t\t\t\tconst size = getComputedSlideSize();\n\n\t\t\t\tconst oldScale = scale;\n\n\t\t\t\t// Layout the contents of the slides\n\t\t\t\tlayoutSlideContents( config.width, config.height );\n\n\t\t\t\tdom.slides.style.width = size.width + 'px';\n\t\t\t\tdom.slides.style.height = size.height + 'px';\n\n\t\t\t\t// Determine scale of content to fit within available space\n\t\t\t\tscale = Math.min( size.presentationWidth / size.width, size.presentationHeight / size.height );\n\n\t\t\t\t// Respect max/min scale settings\n\t\t\t\tscale = Math.max( scale, config.minScale );\n\t\t\t\tscale = Math.min( scale, config.maxScale );\n\n\t\t\t\t// Don't apply any scaling styles if scale is 1\n\t\t\t\tif( scale === 1 ) {\n\t\t\t\t\tdom.slides.style.zoom = '';\n\t\t\t\t\tdom.slides.style.left = '';\n\t\t\t\t\tdom.slides.style.top = '';\n\t\t\t\t\tdom.slides.style.bottom = '';\n\t\t\t\t\tdom.slides.style.right = '';\n\t\t\t\t\ttransformSlides( { layout: '' } );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdom.slides.style.zoom = '';\n\t\t\t\t\tdom.slides.style.left = '50%';\n\t\t\t\t\tdom.slides.style.top = '50%';\n\t\t\t\t\tdom.slides.style.bottom = 'auto';\n\t\t\t\t\tdom.slides.style.right = 'auto';\n\t\t\t\t\ttransformSlides( { layout: 'translate(-50%, -50%) scale('+ scale +')' } );\n\t\t\t\t}\n\n\t\t\t\t// Select all slides, vertical and horizontal\n\t\t\t\tconst slides = Array.from( dom.wrapper.querySelectorAll( SLIDES_SELECTOR ) );\n\n\t\t\t\tfor( let i = 0, len = slides.length; i < len; i++ ) {\n\t\t\t\t\tconst slide = slides[ i ];\n\n\t\t\t\t\t// Don't bother updating invisible slides\n\t\t\t\t\tif( slide.style.display === 'none' ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif( config.center || slide.classList.contains( 'center' ) ) {\n\t\t\t\t\t\t// Vertical stacks are not centred since their section\n\t\t\t\t\t\t// children will be\n\t\t\t\t\t\tif( slide.classList.contains( 'stack' ) ) {\n\t\t\t\t\t\t\tslide.style.top = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tslide.style.top = Math.max( ( size.height - slide.scrollHeight ) / 2, 0 ) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tslide.style.top = '';\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif( oldScale !== scale ) {\n\t\t\t\t\tdispatchEvent({\n\t\t\t\t\t\ttype: 'resize',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\toldScale,\n\t\t\t\t\t\t\tscale,\n\t\t\t\t\t\t\tsize\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdom.viewport.style.setProperty( '--slide-scale', scale );\n\n\t\t\tprogress.update();\n\t\t\tbackgrounds.updateParallax();\n\n\t\t\tif( overview.isActive() ) {\n\t\t\t\toverview.update();\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Applies layout logic to the contents of all slides in\n\t * the presentation.\n\t *\n\t * @param {string|number} width\n\t * @param {string|number} height\n\t */\n\tfunction layoutSlideContents( width, height ) {\n\n\t\t// Handle sizing of elements with the 'r-stretch' class\n\t\tUtil.queryAll( dom.slides, 'section > .stretch, section > .r-stretch' ).forEach( element => {\n\n\t\t\t// Determine how much vertical space we can use\n\t\t\tlet remainingHeight = Util.getRemainingHeight( element, height );\n\n\t\t\t// Consider the aspect ratio of media elements\n\t\t\tif( /(img|video)/gi.test( element.nodeName ) ) {\n\t\t\t\tconst nw = element.naturalWidth || element.videoWidth,\n\t\t\t\t\t  nh = element.naturalHeight || element.videoHeight;\n\n\t\t\t\tconst es = Math.min( width / nw, remainingHeight / nh );\n\n\t\t\t\telement.style.width = ( nw * es ) + 'px';\n\t\t\t\telement.style.height = ( nh * es ) + 'px';\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\telement.style.width = width + 'px';\n\t\t\t\telement.style.height = remainingHeight + 'px';\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Calculates the computed pixel size of our slides. These\n\t * values are based on the width and height configuration\n\t * options.\n\t *\n\t * @param {number} [presentationWidth=dom.wrapper.offsetWidth]\n\t * @param {number} [presentationHeight=dom.wrapper.offsetHeight]\n\t */\n\tfunction getComputedSlideSize( presentationWidth, presentationHeight ) {\n\t\tlet width = config.width;\n\t\tlet height = config.height;\n\n\t\tif( config.disableLayout ) {\n\t\t\twidth = dom.slides.offsetWidth;\n\t\t\theight = dom.slides.offsetHeight;\n\t\t}\n\n\t\tconst size = {\n\t\t\t// Slide size\n\t\t\twidth: width,\n\t\t\theight: height,\n\n\t\t\t// Presentation size\n\t\t\tpresentationWidth: presentationWidth || dom.wrapper.offsetWidth,\n\t\t\tpresentationHeight: presentationHeight || dom.wrapper.offsetHeight\n\t\t};\n\n\t\t// Reduce available space by margin\n\t\tsize.presentationWidth -= ( size.presentationWidth * config.margin );\n\t\tsize.presentationHeight -= ( size.presentationHeight * config.margin );\n\n\t\t// Slide width may be a percentage of available width\n\t\tif( typeof size.width === 'string' && /%$/.test( size.width ) ) {\n\t\t\tsize.width = parseInt( size.width, 10 ) / 100 * size.presentationWidth;\n\t\t}\n\n\t\t// Slide height may be a percentage of available height\n\t\tif( typeof size.height === 'string' && /%$/.test( size.height ) ) {\n\t\t\tsize.height = parseInt( size.height, 10 ) / 100 * size.presentationHeight;\n\t\t}\n\n\t\treturn size;\n\n\t}\n\n\t/**\n\t * Stores the vertical index of a stack so that the same\n\t * vertical slide can be selected when navigating to and\n\t * from the stack.\n\t *\n\t * @param {HTMLElement} stack The vertical stack element\n\t * @param {string|number} [v=0] Index to memorize\n\t */\n\tfunction setPreviousVerticalIndex( stack, v ) {\n\n\t\tif( typeof stack === 'object' && typeof stack.setAttribute === 'function' ) {\n\t\t\tstack.setAttribute( 'data-previous-indexv', v || 0 );\n\t\t}\n\n\t}\n\n\t/**\n\t * Retrieves the vertical index which was stored using\n\t * #setPreviousVerticalIndex() or 0 if no previous index\n\t * exists.\n\t *\n\t * @param {HTMLElement} stack The vertical stack element\n\t */\n\tfunction getPreviousVerticalIndex( stack ) {\n\n\t\tif( typeof stack === 'object' && typeof stack.setAttribute === 'function' && stack.classList.contains( 'stack' ) ) {\n\t\t\t// Prefer manually defined start-indexv\n\t\t\tconst attributeName = stack.hasAttribute( 'data-start-indexv' ) ? 'data-start-indexv' : 'data-previous-indexv';\n\n\t\t\treturn parseInt( stack.getAttribute( attributeName ) || 0, 10 );\n\t\t}\n\n\t\treturn 0;\n\n\t}\n\n\t/**\n\t * Checks if the current or specified slide is vertical\n\t * (nested within another slide).\n\t *\n\t * @param {HTMLElement} [slide=currentSlide] The slide to check\n\t * orientation of\n\t * @return {Boolean}\n\t */\n\tfunction isVerticalSlide( slide = currentSlide ) {\n\n\t\treturn slide && slide.parentNode && !!slide.parentNode.nodeName.match( /section/i );\n\n\t}\n\n\t/**\n\t * Returns true if we're on the last slide in the current\n\t * vertical stack.\n\t */\n\tfunction isLastVerticalSlide() {\n\n\t\tif( currentSlide && isVerticalSlide( currentSlide ) ) {\n\t\t\t// Does this slide have a next sibling?\n\t\t\tif( currentSlide.nextElementSibling ) return false;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t/**\n\t * Returns true if we're currently on the first slide in\n\t * the presentation.\n\t */\n\tfunction isFirstSlide() {\n\n\t\treturn indexh === 0 && indexv === 0;\n\n\t}\n\n\t/**\n\t * Returns true if we're currently on the last slide in\n\t * the presenation. If the last slide is a stack, we only\n\t * consider this the last slide if it's at the end of the\n\t * stack.\n\t */\n\tfunction isLastSlide() {\n\n\t\tif( currentSlide ) {\n\t\t\t// Does this slide have a next sibling?\n\t\t\tif( currentSlide.nextElementSibling ) return false;\n\n\t\t\t// If it's vertical, does its parent have a next sibling?\n\t\t\tif( isVerticalSlide( currentSlide ) && currentSlide.parentNode.nextElementSibling ) return false;\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\n\t}\n\n\t/**\n\t * Enters the paused mode which fades everything on screen to\n\t * black.\n\t */\n\tfunction pause() {\n\n\t\tif( config.pause ) {\n\t\t\tconst wasPaused = dom.wrapper.classList.contains( 'paused' );\n\n\t\t\tcancelAutoSlide();\n\t\t\tdom.wrapper.classList.add( 'paused' );\n\n\t\t\tif( wasPaused === false ) {\n\t\t\t\tdispatchEvent({ type: 'paused' });\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Exits from the paused mode.\n\t */\n\tfunction resume() {\n\n\t\tconst wasPaused = dom.wrapper.classList.contains( 'paused' );\n\t\tdom.wrapper.classList.remove( 'paused' );\n\n\t\tcueAutoSlide();\n\n\t\tif( wasPaused ) {\n\t\t\tdispatchEvent({ type: 'resumed' });\n\t\t}\n\n\t}\n\n\t/**\n\t * Toggles the paused mode on and off.\n\t */\n\tfunction togglePause( override ) {\n\n\t\tif( typeof override === 'boolean' ) {\n\t\t\toverride ? pause() : resume();\n\t\t}\n\t\telse {\n\t\t\tisPaused() ? resume() : pause();\n\t\t}\n\n\t}\n\n\t/**\n\t * Checks if we are currently in the paused mode.\n\t *\n\t * @return {Boolean}\n\t */\n\tfunction isPaused() {\n\n\t\treturn dom.wrapper.classList.contains( 'paused' );\n\n\t}\n\n\t/**\n\t * Toggles visibility of the jump-to-slide UI.\n\t */\n\tfunction toggleJumpToSlide( override ) {\n\n\t\tif( typeof override === 'boolean' ) {\n\t\t\toverride ? jumpToSlide.show() : jumpToSlide.hide();\n\t\t}\n\t\telse {\n\t\t\tjumpToSlide.isVisible() ? jumpToSlide.hide() : jumpToSlide.show();\n\t\t}\n\n\t}\n\n\t/**\n\t * Toggles the auto slide mode on and off.\n\t *\n\t * @param {Boolean} [override] Flag which sets the desired state.\n\t * True means autoplay starts, false means it stops.\n\t */\n\n\tfunction toggleAutoSlide( override ) {\n\n\t\tif( typeof override === 'boolean' ) {\n\t\t\toverride ? resumeAutoSlide() : pauseAutoSlide();\n\t\t}\n\n\t\telse {\n\t\t\tautoSlidePaused ? resumeAutoSlide() : pauseAutoSlide();\n\t\t}\n\n\t}\n\n\t/**\n\t * Checks if the auto slide mode is currently on.\n\t *\n\t * @return {Boolean}\n\t */\n\tfunction isAutoSliding() {\n\n\t\treturn !!( autoSlide && !autoSlidePaused );\n\n\t}\n\n\t/**\n\t * Steps from the current point in the presentation to the\n\t * slide which matches the specified horizontal and vertical\n\t * indices.\n\t *\n\t * @param {number} [h=indexh] Horizontal index of the target slide\n\t * @param {number} [v=indexv] Vertical index of the target slide\n\t * @param {number} [f] Index of a fragment within the\n\t * target slide to activate\n\t * @param {number} [origin] Origin for use in multimaster environments\n\t */\n\tfunction slide( h, v, f, origin ) {\n\n\t\t// Dispatch an event before the slide\n\t\tconst slidechange = dispatchEvent({\n\t\t\ttype: 'beforeslidechange',\n\t\t\tdata: {\n\t\t\t\tindexh: h === undefined ? indexh : h,\n\t\t\t\tindexv: v === undefined ? indexv : v,\n\t\t\t\torigin\n\t\t\t}\n\t\t});\n\n\t\t// Abort if this slide change was prevented by an event listener\n\t\tif( slidechange.defaultPrevented ) return;\n\n\t\t// Remember where we were at before\n\t\tpreviousSlide = currentSlide;\n\n\t\t// Query all horizontal slides in the deck\n\t\tconst horizontalSlides = dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR );\n\n\t\t// Abort if there are no slides\n\t\tif( horizontalSlides.length === 0 ) return;\n\n\t\t// If no vertical index is specified and the upcoming slide is a\n\t\t// stack, resume at its previous vertical index\n\t\tif( v === undefined && !overview.isActive() ) {\n\t\t\tv = getPreviousVerticalIndex( horizontalSlides[ h ] );\n\t\t}\n\n\t\t// If we were on a vertical stack, remember what vertical index\n\t\t// it was on so we can resume at the same position when returning\n\t\tif( previousSlide && previousSlide.parentNode && previousSlide.parentNode.classList.contains( 'stack' ) ) {\n\t\t\tsetPreviousVerticalIndex( previousSlide.parentNode, indexv );\n\t\t}\n\n\t\t// Remember the state before this slide\n\t\tconst stateBefore = state.concat();\n\n\t\t// Reset the state array\n\t\tstate.length = 0;\n\n\t\tlet indexhBefore = indexh || 0,\n\t\t\tindexvBefore = indexv || 0;\n\n\t\t// Activate and transition to the new slide\n\t\tindexh = updateSlides( HORIZONTAL_SLIDES_SELECTOR, h === undefined ? indexh : h );\n\t\tindexv = updateSlides( VERTICAL_SLIDES_SELECTOR, v === undefined ? indexv : v );\n\n\t\t// Dispatch an event if the slide changed\n\t\tlet slideChanged = ( indexh !== indexhBefore || indexv !== indexvBefore );\n\n\t\t// Ensure that the previous slide is never the same as the current\n\t\tif( !slideChanged ) previousSlide = null;\n\n\t\t// Find the current horizontal slide and any possible vertical slides\n\t\t// within it\n\t\tlet currentHorizontalSlide = horizontalSlides[ indexh ],\n\t\t\tcurrentVerticalSlides = currentHorizontalSlide.querySelectorAll( 'section' );\n\n\t\t// Store references to the previous and current slides\n\t\tcurrentSlide = currentVerticalSlides[ indexv ] || currentHorizontalSlide;\n\n\t\tlet autoAnimateTransition = false;\n\n\t\t// Detect if we're moving between two auto-animated slides\n\t\tif( slideChanged && previousSlide && currentSlide && !overview.isActive() ) {\n\n\t\t\t// If this is an auto-animated transition, we disable the\n\t\t\t// regular slide transition\n\t\t\t//\n\t\t\t// Note 20-03-2020:\n\t\t\t// This needs to happen before we update slide visibility,\n\t\t\t// otherwise transitions will still run in Safari.\n\t\t\tif( previousSlide.hasAttribute( 'data-auto-animate' ) && currentSlide.hasAttribute( 'data-auto-animate' )\n\t\t\t\t\t&& previousSlide.getAttribute( 'data-auto-animate-id' ) === currentSlide.getAttribute( 'data-auto-animate-id' )\n\t\t\t\t\t&& !( ( indexh > indexhBefore || indexv > indexvBefore ) ? currentSlide : previousSlide ).hasAttribute( 'data-auto-animate-restart' ) ) {\n\n\t\t\t\tautoAnimateTransition = true;\n\t\t\t\tdom.slides.classList.add( 'disable-slide-transitions' );\n\t\t\t}\n\n\t\t\ttransition = 'running';\n\n\t\t}\n\n\t\t// Update the visibility of slides now that the indices have changed\n\t\tupdateSlidesVisibility();\n\n\t\tlayout();\n\n\t\t// Update the overview if it's currently active\n\t\tif( overview.isActive() ) {\n\t\t\toverview.update();\n\t\t}\n\n\t\t// Show fragment, if specified\n\t\tif( typeof f !== 'undefined' ) {\n\t\t\tfragments.goto( f );\n\t\t}\n\n\t\t// Solves an edge case where the previous slide maintains the\n\t\t// 'present' class when navigating between adjacent vertical\n\t\t// stacks\n\t\tif( previousSlide && previousSlide !== currentSlide ) {\n\t\t\tpreviousSlide.classList.remove( 'present' );\n\t\t\tpreviousSlide.setAttribute( 'aria-hidden', 'true' );\n\n\t\t\t// Reset all slides upon navigate to home\n\t\t\tif( isFirstSlide() ) {\n\t\t\t\t// Launch async task\n\t\t\t\tsetTimeout( () => {\n\t\t\t\t\tgetVerticalStacks().forEach( slide => {\n\t\t\t\t\t\tsetPreviousVerticalIndex( slide, 0 );\n\t\t\t\t\t} );\n\t\t\t\t}, 0 );\n\t\t\t}\n\t\t}\n\n\t\t// Apply the new state\n\t\tstateLoop: for( let i = 0, len = state.length; i < len; i++ ) {\n\t\t\t// Check if this state existed on the previous slide. If it\n\t\t\t// did, we will avoid adding it repeatedly\n\t\t\tfor( let j = 0; j < stateBefore.length; j++ ) {\n\t\t\t\tif( stateBefore[j] === state[i] ) {\n\t\t\t\t\tstateBefore.splice( j, 1 );\n\t\t\t\t\tcontinue stateLoop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdom.viewport.classList.add( state[i] );\n\n\t\t\t// Dispatch custom event matching the state's name\n\t\t\tdispatchEvent({ type: state[i] });\n\t\t}\n\n\t\t// Clean up the remains of the previous state\n\t\twhile( stateBefore.length ) {\n\t\t\tdom.viewport.classList.remove( stateBefore.pop() );\n\t\t}\n\n\t\tif( slideChanged ) {\n\t\t\tdispatchEvent({\n\t\t\t\ttype: 'slidechanged',\n\t\t\t\tdata: {\n\t\t\t\t\tindexh,\n\t\t\t\t\tindexv,\n\t\t\t\t\tpreviousSlide,\n\t\t\t\t\tcurrentSlide,\n\t\t\t\t\torigin\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Handle embedded content\n\t\tif( slideChanged || !previousSlide ) {\n\t\t\tslideContent.stopEmbeddedContent( previousSlide );\n\t\t\tslideContent.startEmbeddedContent( currentSlide );\n\t\t}\n\n\t\t// Announce the current slide contents to screen readers\n\t\t// Use animation frame to prevent getComputedStyle in getStatusText\n\t\t// from triggering layout mid-frame\n\t\trequestAnimationFrame( () => {\n\t\t\tannounceStatus( getStatusText( currentSlide ) );\n\t\t});\n\n\t\tprogress.update();\n\t\tcontrols.update();\n\t\tnotes.update();\n\t\tbackgrounds.update();\n\t\tbackgrounds.updateParallax();\n\t\tslideNumber.update();\n\t\tfragments.update();\n\n\t\t// Update the URL hash\n\t\tlocation.writeURL();\n\n\t\tcueAutoSlide();\n\n\t\t// Auto-animation\n\t\tif( autoAnimateTransition ) {\n\n\t\t\tsetTimeout( () => {\n\t\t\t\tdom.slides.classList.remove( 'disable-slide-transitions' );\n\t\t\t}, 0 );\n\n\t\t\tif( config.autoAnimate ) {\n\t\t\t\t// Run the auto-animation between our slides\n\t\t\t\tautoAnimate.run( previousSlide, currentSlide );\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Syncs the presentation with the current DOM. Useful\n\t * when new slides or control elements are added or when\n\t * the configuration has changed.\n\t */\n\tfunction sync() {\n\n\t\t// Subscribe to input\n\t\tremoveEventListeners();\n\t\taddEventListeners();\n\n\t\t// Force a layout to make sure the current config is accounted for\n\t\tlayout();\n\n\t\t// Reflect the current autoSlide value\n\t\tautoSlide = config.autoSlide;\n\n\t\t// Start auto-sliding if it's enabled\n\t\tcueAutoSlide();\n\n\t\t// Re-create all slide backgrounds\n\t\tbackgrounds.create();\n\n\t\t// Write the current hash to the URL\n\t\tlocation.writeURL();\n\n\t\tif( config.sortFragmentsOnSync === true ) {\n\t\t\tfragments.sortAll();\n\t\t}\n\n\t\tcontrols.update();\n\t\tprogress.update();\n\n\t\tupdateSlidesVisibility();\n\n\t\tnotes.update();\n\t\tnotes.updateVisibility();\n\t\tbackgrounds.update( true );\n\t\tslideNumber.update();\n\t\tslideContent.formatEmbeddedContent();\n\n\t\t// Start or stop embedded content depending on global config\n\t\tif( config.autoPlayMedia === false ) {\n\t\t\tslideContent.stopEmbeddedContent( currentSlide, { unloadIframes: false } );\n\t\t}\n\t\telse {\n\t\t\tslideContent.startEmbeddedContent( currentSlide );\n\t\t}\n\n\t\tif( overview.isActive() ) {\n\t\t\toverview.layout();\n\t\t}\n\n\t}\n\n\t/**\n\t * Updates reveal.js to keep in sync with new slide attributes. For\n\t * example, if you add a new `data-background-image` you can call\n\t * this to have reveal.js render the new background image.\n\t *\n\t * Similar to #sync() but more efficient when you only need to\n\t * refresh a specific slide.\n\t *\n\t * @param {HTMLElement} slide\n\t */\n\tfunction syncSlide( slide = currentSlide ) {\n\n\t\tbackgrounds.sync( slide );\n\t\tfragments.sync( slide );\n\n\t\tslideContent.load( slide );\n\n\t\tbackgrounds.update();\n\t\tnotes.update();\n\n\t}\n\n\t/**\n\t * Resets all vertical slides so that only the first\n\t * is visible.\n\t */\n\tfunction resetVerticalSlides() {\n\n\t\tgetHorizontalSlides().forEach( horizontalSlide => {\n\n\t\t\tUtil.queryAll( horizontalSlide, 'section' ).forEach( ( verticalSlide, y ) => {\n\n\t\t\t\tif( y > 0 ) {\n\t\t\t\t\tverticalSlide.classList.remove( 'present' );\n\t\t\t\t\tverticalSlide.classList.remove( 'past' );\n\t\t\t\t\tverticalSlide.classList.add( 'future' );\n\t\t\t\t\tverticalSlide.setAttribute( 'aria-hidden', 'true' );\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Randomly shuffles all slides in the deck.\n\t */\n\tfunction shuffle( slides = getHorizontalSlides() ) {\n\n\t\tslides.forEach( ( slide, i ) => {\n\n\t\t\t// Insert the slide next to a randomly picked sibling slide\n\t\t\t// slide. This may cause the slide to insert before itself,\n\t\t\t// but that's not an issue.\n\t\t\tlet beforeSlide = slides[ Math.floor( Math.random() * slides.length ) ];\n\t\t\tif( beforeSlide.parentNode === slide.parentNode ) {\n\t\t\t\tslide.parentNode.insertBefore( slide, beforeSlide );\n\t\t\t}\n\n\t\t\t// Randomize the order of vertical slides (if there are any)\n\t\t\tlet verticalSlides = slide.querySelectorAll( 'section' );\n\t\t\tif( verticalSlides.length ) {\n\t\t\t\tshuffle( verticalSlides );\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Updates one dimension of slides by showing the slide\n\t * with the specified index.\n\t *\n\t * @param {string} selector A CSS selector that will fetch\n\t * the group of slides we are working with\n\t * @param {number} index The index of the slide that should be\n\t * shown\n\t *\n\t * @return {number} The index of the slide that is now shown,\n\t * might differ from the passed in index if it was out of\n\t * bounds.\n\t */\n\tfunction updateSlides( selector, index ) {\n\n\t\t// Select all slides and convert the NodeList result to\n\t\t// an array\n\t\tlet slides = Util.queryAll( dom.wrapper, selector ),\n\t\t\tslidesLength = slides.length;\n\n\t\tlet printMode = print.isPrintingPDF();\n\t\tlet loopedForwards = false;\n\t\tlet loopedBackwards = false;\n\n\t\tif( slidesLength ) {\n\n\t\t\t// Should the index loop?\n\t\t\tif( config.loop ) {\n\t\t\t\tif( index >= slidesLength ) loopedForwards = true;\n\n\t\t\t\tindex %= slidesLength;\n\n\t\t\t\tif( index < 0 ) {\n\t\t\t\t\tindex = slidesLength + index;\n\t\t\t\t\tloopedBackwards = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Enforce max and minimum index bounds\n\t\t\tindex = Math.max( Math.min( index, slidesLength - 1 ), 0 );\n\n\t\t\tfor( let i = 0; i < slidesLength; i++ ) {\n\t\t\t\tlet element = slides[i];\n\n\t\t\t\tlet reverse = config.rtl && !isVerticalSlide( element );\n\n\t\t\t\t// Avoid .remove() with multiple args for IE11 support\n\t\t\t\telement.classList.remove( 'past' );\n\t\t\t\telement.classList.remove( 'present' );\n\t\t\t\telement.classList.remove( 'future' );\n\n\t\t\t\t// http://www.w3.org/html/wg/drafts/html/master/editing.html#the-hidden-attribute\n\t\t\t\telement.setAttribute( 'hidden', '' );\n\t\t\t\telement.setAttribute( 'aria-hidden', 'true' );\n\n\t\t\t\t// If this element contains vertical slides\n\t\t\t\tif( element.querySelector( 'section' ) ) {\n\t\t\t\t\telement.classList.add( 'stack' );\n\t\t\t\t}\n\n\t\t\t\t// If we're printing static slides, all slides are \"present\"\n\t\t\t\tif( printMode ) {\n\t\t\t\t\telement.classList.add( 'present' );\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif( i < index ) {\n\t\t\t\t\t// Any element previous to index is given the 'past' class\n\t\t\t\t\telement.classList.add( reverse ? 'future' : 'past' );\n\n\t\t\t\t\tif( config.fragments ) {\n\t\t\t\t\t\t// Show all fragments in prior slides\n\t\t\t\t\t\tshowFragmentsIn( element );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if( i > index ) {\n\t\t\t\t\t// Any element subsequent to index is given the 'future' class\n\t\t\t\t\telement.classList.add( reverse ? 'past' : 'future' );\n\n\t\t\t\t\tif( config.fragments ) {\n\t\t\t\t\t\t// Hide all fragments in future slides\n\t\t\t\t\t\thideFragmentsIn( element );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Update the visibility of fragments when a presentation loops\n\t\t\t\t// in either direction\n\t\t\t\telse if( i === index && config.fragments ) {\n\t\t\t\t\tif( loopedForwards ) {\n\t\t\t\t\t\thideFragmentsIn( element );\n\t\t\t\t\t}\n\t\t\t\t\telse if( loopedBackwards ) {\n\t\t\t\t\t\tshowFragmentsIn( element );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet slide = slides[index];\n\t\t\tlet wasPresent = slide.classList.contains( 'present' );\n\n\t\t\t// Mark the current slide as present\n\t\t\tslide.classList.add( 'present' );\n\t\t\tslide.removeAttribute( 'hidden' );\n\t\t\tslide.removeAttribute( 'aria-hidden' );\n\n\t\t\tif( !wasPresent ) {\n\t\t\t\t// Dispatch an event indicating the slide is now visible\n\t\t\t\tdispatchEvent({\n\t\t\t\t\ttarget: slide,\n\t\t\t\t\ttype: 'visible',\n\t\t\t\t\tbubbles: false\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// If this slide has a state associated with it, add it\n\t\t\t// onto the current state of the deck\n\t\t\tlet slideState = slide.getAttribute( 'data-state' );\n\t\t\tif( slideState ) {\n\t\t\t\tstate = state.concat( slideState.split( ' ' ) );\n\t\t\t}\n\n\t\t}\n\t\telse {\n\t\t\t// Since there are no slides we can't be anywhere beyond the\n\t\t\t// zeroth index\n\t\t\tindex = 0;\n\t\t}\n\n\t\treturn index;\n\n\t}\n\n\t/**\n\t * Shows all fragment elements within the given contaienr.\n\t */\n\tfunction showFragmentsIn( container ) {\n\n\t\tUtil.queryAll( container, '.fragment' ).forEach( fragment => {\n\t\t\tfragment.classList.add( 'visible' );\n\t\t\tfragment.classList.remove( 'current-fragment' );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Hides all fragment elements within the given contaienr.\n\t */\n\tfunction hideFragmentsIn( container ) {\n\n\t\tUtil.queryAll( container, '.fragment.visible' ).forEach( fragment => {\n\t\t\tfragment.classList.remove( 'visible', 'current-fragment' );\n\t\t} );\n\n\t}\n\n\t/**\n\t * Optimization method; hide all slides that are far away\n\t * from the present slide.\n\t */\n\tfunction updateSlidesVisibility() {\n\n\t\t// Select all slides and convert the NodeList result to\n\t\t// an array\n\t\tlet horizontalSlides = getHorizontalSlides(),\n\t\t\thorizontalSlidesLength = horizontalSlides.length,\n\t\t\tdistanceX,\n\t\t\tdistanceY;\n\n\t\tif( horizontalSlidesLength && typeof indexh !== 'undefined' ) {\n\n\t\t\t// The number of steps away from the present slide that will\n\t\t\t// be visible\n\t\t\tlet viewDistance = overview.isActive() ? 10 : config.viewDistance;\n\n\t\t\t// Shorten the view distance on devices that typically have\n\t\t\t// less resources\n\t\t\tif( Device.isMobile ) {\n\t\t\t\tviewDistance = overview.isActive() ? 6 : config.mobileViewDistance;\n\t\t\t}\n\n\t\t\t// All slides need to be visible when exporting to PDF\n\t\t\tif( print.isPrintingPDF() ) {\n\t\t\t\tviewDistance = Number.MAX_VALUE;\n\t\t\t}\n\n\t\t\tfor( let x = 0; x < horizontalSlidesLength; x++ ) {\n\t\t\t\tlet horizontalSlide = horizontalSlides[x];\n\n\t\t\t\tlet verticalSlides = Util.queryAll( horizontalSlide, 'section' ),\n\t\t\t\t\tverticalSlidesLength = verticalSlides.length;\n\n\t\t\t\t// Determine how far away this slide is from the present\n\t\t\t\tdistanceX = Math.abs( ( indexh || 0 ) - x ) || 0;\n\n\t\t\t\t// If the presentation is looped, distance should measure\n\t\t\t\t// 1 between the first and last slides\n\t\t\t\tif( config.loop ) {\n\t\t\t\t\tdistanceX = Math.abs( ( ( indexh || 0 ) - x ) % ( horizontalSlidesLength - viewDistance ) ) || 0;\n\t\t\t\t}\n\n\t\t\t\t// Show the horizontal slide if it's within the view distance\n\t\t\t\tif( distanceX < viewDistance ) {\n\t\t\t\t\tslideContent.load( horizontalSlide );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tslideContent.unload( horizontalSlide );\n\t\t\t\t}\n\n\t\t\t\tif( verticalSlidesLength ) {\n\n\t\t\t\t\tlet oy = getPreviousVerticalIndex( horizontalSlide );\n\n\t\t\t\t\tfor( let y = 0; y < verticalSlidesLength; y++ ) {\n\t\t\t\t\t\tlet verticalSlide = verticalSlides[y];\n\n\t\t\t\t\t\tdistanceY = x === ( indexh || 0 ) ? Math.abs( ( indexv || 0 ) - y ) : Math.abs( y - oy );\n\n\t\t\t\t\t\tif( distanceX + distanceY < viewDistance ) {\n\t\t\t\t\t\t\tslideContent.load( verticalSlide );\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tslideContent.unload( verticalSlide );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Flag if there are ANY vertical slides, anywhere in the deck\n\t\t\tif( hasVerticalSlides() ) {\n\t\t\t\tdom.wrapper.classList.add( 'has-vertical-slides' );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdom.wrapper.classList.remove( 'has-vertical-slides' );\n\t\t\t}\n\n\t\t\t// Flag if there are ANY horizontal slides, anywhere in the deck\n\t\t\tif( hasHorizontalSlides() ) {\n\t\t\t\tdom.wrapper.classList.add( 'has-horizontal-slides' );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdom.wrapper.classList.remove( 'has-horizontal-slides' );\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Determine what available routes there are for navigation.\n\t *\n\t * @return {{left: boolean, right: boolean, up: boolean, down: boolean}}\n\t */\n\tfunction availableRoutes({ includeFragments = false } = {}) {\n\n\t\tlet horizontalSlides = dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ),\n\t\t\tverticalSlides = dom.wrapper.querySelectorAll( VERTICAL_SLIDES_SELECTOR );\n\n\t\tlet routes = {\n\t\t\tleft: indexh > 0,\n\t\t\tright: indexh < horizontalSlides.length - 1,\n\t\t\tup: indexv > 0,\n\t\t\tdown: indexv < verticalSlides.length - 1\n\t\t};\n\n\t\t// Looped presentations can always be navigated as long as\n\t\t// there are slides available\n\t\tif( config.loop ) {\n\t\t\tif( horizontalSlides.length > 1 ) {\n\t\t\t\troutes.left = true;\n\t\t\t\troutes.right = true;\n\t\t\t}\n\n\t\t\tif( verticalSlides.length > 1 ) {\n\t\t\t\troutes.up = true;\n\t\t\t\troutes.down = true;\n\t\t\t}\n\t\t}\n\n\t\tif ( horizontalSlides.length > 1 && config.navigationMode === 'linear' ) {\n\t\t\troutes.right = routes.right || routes.down;\n\t\t\troutes.left = routes.left || routes.up;\n\t\t}\n\n\t\t// If includeFragments is set, a route will be considered\n\t\t// available if either a slid OR fragment is available in\n\t\t// the given direction\n\t\tif( includeFragments === true ) {\n\t\t\tlet fragmentRoutes = fragments.availableRoutes();\n\t\t\troutes.left = routes.left || fragmentRoutes.prev;\n\t\t\troutes.up = routes.up || fragmentRoutes.prev;\n\t\t\troutes.down = routes.down || fragmentRoutes.next;\n\t\t\troutes.right = routes.right || fragmentRoutes.next;\n\t\t}\n\n\t\t// Reverse horizontal controls for rtl\n\t\tif( config.rtl ) {\n\t\t\tlet left = routes.left;\n\t\t\troutes.left = routes.right;\n\t\t\troutes.right = left;\n\t\t}\n\n\t\treturn routes;\n\n\t}\n\n\t/**\n\t * Returns the number of past slides. This can be used as a global\n\t * flattened index for slides.\n\t *\n\t * @param {HTMLElement} [slide=currentSlide] The slide we're counting before\n\t *\n\t * @return {number} Past slide count\n\t */\n\tfunction getSlidePastCount( slide = currentSlide ) {\n\n\t\tlet horizontalSlides = getHorizontalSlides();\n\n\t\t// The number of past slides\n\t\tlet pastCount = 0;\n\n\t\t// Step through all slides and count the past ones\n\t\tmainLoop: for( let i = 0; i < horizontalSlides.length; i++ ) {\n\n\t\t\tlet horizontalSlide = horizontalSlides[i];\n\t\t\tlet verticalSlides = horizontalSlide.querySelectorAll( 'section' );\n\n\t\t\tfor( let j = 0; j < verticalSlides.length; j++ ) {\n\n\t\t\t\t// Stop as soon as we arrive at the present\n\t\t\t\tif( verticalSlides[j] === slide ) {\n\t\t\t\t\tbreak mainLoop;\n\t\t\t\t}\n\n\t\t\t\t// Don't count slides with the \"uncounted\" class\n\t\t\t\tif( verticalSlides[j].dataset.visibility !== 'uncounted' ) {\n\t\t\t\t\tpastCount++;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Stop as soon as we arrive at the present\n\t\t\tif( horizontalSlide === slide ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// Don't count the wrapping section for vertical slides and\n\t\t\t// slides marked as uncounted\n\t\t\tif( horizontalSlide.classList.contains( 'stack' ) === false && horizontalSlide.dataset.visibility !== 'uncounted' ) {\n\t\t\t\tpastCount++;\n\t\t\t}\n\n\t\t}\n\n\t\treturn pastCount;\n\n\t}\n\n\t/**\n\t * Returns a value ranging from 0-1 that represents\n\t * how far into the presentation we have navigated.\n\t *\n\t * @return {number}\n\t */\n\tfunction getProgress() {\n\n\t\t// The number of past and total slides\n\t\tlet totalCount = getTotalSlides();\n\t\tlet pastCount = getSlidePastCount();\n\n\t\tif( currentSlide ) {\n\n\t\t\tlet allFragments = currentSlide.querySelectorAll( '.fragment' );\n\n\t\t\t// If there are fragments in the current slide those should be\n\t\t\t// accounted for in the progress.\n\t\t\tif( allFragments.length > 0 ) {\n\t\t\t\tlet visibleFragments = currentSlide.querySelectorAll( '.fragment.visible' );\n\n\t\t\t\t// This value represents how big a portion of the slide progress\n\t\t\t\t// that is made up by its fragments (0-1)\n\t\t\t\tlet fragmentWeight = 0.9;\n\n\t\t\t\t// Add fragment progress to the past slide count\n\t\t\t\tpastCount += ( visibleFragments.length / allFragments.length ) * fragmentWeight;\n\t\t\t}\n\n\t\t}\n\n\t\treturn Math.min( pastCount / ( totalCount - 1 ), 1 );\n\n\t}\n\n\t/**\n\t * Retrieves the h/v location and fragment of the current,\n\t * or specified, slide.\n\t *\n\t * @param {HTMLElement} [slide] If specified, the returned\n\t * index will be for this slide rather than the currently\n\t * active one\n\t *\n\t * @return {{h: number, v: number, f: number}}\n\t */\n\tfunction getIndices( slide ) {\n\n\t\t// By default, return the current indices\n\t\tlet h = indexh,\n\t\t\tv = indexv,\n\t\t\tf;\n\n\t\t// If a slide is specified, return the indices of that slide\n\t\tif( slide ) {\n\t\t\tlet isVertical = isVerticalSlide( slide );\n\t\t\tlet slideh = isVertical ? slide.parentNode : slide;\n\n\t\t\t// Select all horizontal slides\n\t\t\tlet horizontalSlides = getHorizontalSlides();\n\n\t\t\t// Now that we know which the horizontal slide is, get its index\n\t\t\th = Math.max( horizontalSlides.indexOf( slideh ), 0 );\n\n\t\t\t// Assume we're not vertical\n\t\t\tv = undefined;\n\n\t\t\t// If this is a vertical slide, grab the vertical index\n\t\t\tif( isVertical ) {\n\t\t\t\tv = Math.max( Util.queryAll( slide.parentNode, 'section' ).indexOf( slide ), 0 );\n\t\t\t}\n\t\t}\n\n\t\tif( !slide && currentSlide ) {\n\t\t\tlet hasFragments = currentSlide.querySelectorAll( '.fragment' ).length > 0;\n\t\t\tif( hasFragments ) {\n\t\t\t\tlet currentFragment = currentSlide.querySelector( '.current-fragment' );\n\t\t\t\tif( currentFragment && currentFragment.hasAttribute( 'data-fragment-index' ) ) {\n\t\t\t\t\tf = parseInt( currentFragment.getAttribute( 'data-fragment-index' ), 10 );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tf = currentSlide.querySelectorAll( '.fragment.visible' ).length - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn { h, v, f };\n\n\t}\n\n\t/**\n\t * Retrieves all slides in this presentation.\n\t */\n\tfunction getSlides() {\n\n\t\treturn Util.queryAll( dom.wrapper, SLIDES_SELECTOR + ':not(.stack):not([data-visibility=\"uncounted\"])' );\n\n\t}\n\n\t/**\n\t * Returns a list of all horizontal slides in the deck. Each\n\t * vertical stack is included as one horizontal slide in the\n\t * resulting array.\n\t */\n\tfunction getHorizontalSlides() {\n\n\t\treturn Util.queryAll( dom.wrapper, HORIZONTAL_SLIDES_SELECTOR );\n\n\t}\n\n\t/**\n\t * Returns all vertical slides that exist within this deck.\n\t */\n\tfunction getVerticalSlides() {\n\n\t\treturn Util.queryAll( dom.wrapper, '.slides>section>section' );\n\n\t}\n\n\t/**\n\t * Returns all vertical stacks (each stack can contain multiple slides).\n\t */\n\tfunction getVerticalStacks() {\n\n\t\treturn Util.queryAll( dom.wrapper, HORIZONTAL_SLIDES_SELECTOR + '.stack');\n\n\t}\n\n\t/**\n\t * Returns true if there are at least two horizontal slides.\n\t */\n\tfunction hasHorizontalSlides() {\n\n\t\treturn getHorizontalSlides().length > 1;\n\t}\n\n\t/**\n\t * Returns true if there are at least two vertical slides.\n\t */\n\tfunction hasVerticalSlides() {\n\n\t\treturn getVerticalSlides().length > 1;\n\n\t}\n\n\t/**\n\t * Returns an array of objects where each object represents the\n\t * attributes on its respective slide.\n\t */\n\tfunction getSlidesAttributes() {\n\n\t\treturn getSlides().map( slide => {\n\n\t\t\tlet attributes = {};\n\t\t\tfor( let i = 0; i < slide.attributes.length; i++ ) {\n\t\t\t\tlet attribute = slide.attributes[ i ];\n\t\t\t\tattributes[ attribute.name ] = attribute.value;\n\t\t\t}\n\t\t\treturn attributes;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Retrieves the total number of slides in this presentation.\n\t *\n\t * @return {number}\n\t */\n\tfunction getTotalSlides() {\n\n\t\treturn getSlides().length;\n\n\t}\n\n\t/**\n\t * Returns the slide element matching the specified index.\n\t *\n\t * @return {HTMLElement}\n\t */\n\tfunction getSlide( x, y ) {\n\n\t\tlet horizontalSlide = getHorizontalSlides()[ x ];\n\t\tlet verticalSlides = horizontalSlide && horizontalSlide.querySelectorAll( 'section' );\n\n\t\tif( verticalSlides && verticalSlides.length && typeof y === 'number' ) {\n\t\t\treturn verticalSlides ? verticalSlides[ y ] : undefined;\n\t\t}\n\n\t\treturn horizontalSlide;\n\n\t}\n\n\t/**\n\t * Returns the background element for the given slide.\n\t * All slides, even the ones with no background properties\n\t * defined, have a background element so as long as the\n\t * index is valid an element will be returned.\n\t *\n\t * @param {mixed} x Horizontal background index OR a slide\n\t * HTML element\n\t * @param {number} y Vertical background index\n\t * @return {(HTMLElement[]|*)}\n\t */\n\tfunction getSlideBackground( x, y ) {\n\n\t\tlet slide = typeof x === 'number' ? getSlide( x, y ) : x;\n\t\tif( slide ) {\n\t\t\treturn slide.slideBackgroundElement;\n\t\t}\n\n\t\treturn undefined;\n\n\t}\n\n\t/**\n\t * Retrieves the current state of the presentation as\n\t * an object. This state can then be restored at any\n\t * time.\n\t *\n\t * @return {{indexh: number, indexv: number, indexf: number, paused: boolean, overview: boolean}}\n\t */\n\tfunction getState() {\n\n\t\tlet indices = getIndices();\n\n\t\treturn {\n\t\t\tindexh: indices.h,\n\t\t\tindexv: indices.v,\n\t\t\tindexf: indices.f,\n\t\t\tpaused: isPaused(),\n\t\t\toverview: overview.isActive()\n\t\t};\n\n\t}\n\n\t/**\n\t * Restores the presentation to the given state.\n\t *\n\t * @param {object} state As generated by getState()\n\t * @see {@link getState} generates the parameter `state`\n\t */\n\tfunction setState( state ) {\n\n\t\tif( typeof state === 'object' ) {\n\t\t\tslide( Util.deserialize( state.indexh ), Util.deserialize( state.indexv ), Util.deserialize( state.indexf ) );\n\n\t\t\tlet pausedFlag = Util.deserialize( state.paused ),\n\t\t\t\toverviewFlag = Util.deserialize( state.overview );\n\n\t\t\tif( typeof pausedFlag === 'boolean' && pausedFlag !== isPaused() ) {\n\t\t\t\ttogglePause( pausedFlag );\n\t\t\t}\n\n\t\t\tif( typeof overviewFlag === 'boolean' && overviewFlag !== overview.isActive() ) {\n\t\t\t\toverview.toggle( overviewFlag );\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Cues a new automated slide if enabled in the config.\n\t */\n\tfunction cueAutoSlide() {\n\n\t\tcancelAutoSlide();\n\n\t\tif( currentSlide && config.autoSlide !== false ) {\n\n\t\t\tlet fragment = currentSlide.querySelector( '.current-fragment[data-autoslide]' );\n\n\t\t\tlet fragmentAutoSlide = fragment ? fragment.getAttribute( 'data-autoslide' ) : null;\n\t\t\tlet parentAutoSlide = currentSlide.parentNode ? currentSlide.parentNode.getAttribute( 'data-autoslide' ) : null;\n\t\t\tlet slideAutoSlide = currentSlide.getAttribute( 'data-autoslide' );\n\n\t\t\t// Pick value in the following priority order:\n\t\t\t// 1. Current fragment's data-autoslide\n\t\t\t// 2. Current slide's data-autoslide\n\t\t\t// 3. Parent slide's data-autoslide\n\t\t\t// 4. Global autoSlide setting\n\t\t\tif( fragmentAutoSlide ) {\n\t\t\t\tautoSlide = parseInt( fragmentAutoSlide, 10 );\n\t\t\t}\n\t\t\telse if( slideAutoSlide ) {\n\t\t\t\tautoSlide = parseInt( slideAutoSlide, 10 );\n\t\t\t}\n\t\t\telse if( parentAutoSlide ) {\n\t\t\t\tautoSlide = parseInt( parentAutoSlide, 10 );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tautoSlide = config.autoSlide;\n\n\t\t\t\t// If there are media elements with data-autoplay,\n\t\t\t\t// automatically set the autoSlide duration to the\n\t\t\t\t// length of that media. Not applicable if the slide\n\t\t\t\t// is divided up into fragments.\n\t\t\t\t// playbackRate is accounted for in the duration.\n\t\t\t\tif( currentSlide.querySelectorAll( '.fragment' ).length === 0 ) {\n\t\t\t\t\tUtil.queryAll( currentSlide, 'video, audio' ).forEach( el => {\n\t\t\t\t\t\tif( el.hasAttribute( 'data-autoplay' ) ) {\n\t\t\t\t\t\t\tif( autoSlide && (el.duration * 1000 / el.playbackRate ) > autoSlide ) {\n\t\t\t\t\t\t\t\tautoSlide = ( el.duration * 1000 / el.playbackRate ) + 1000;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Cue the next auto-slide if:\n\t\t\t// - There is an autoSlide value\n\t\t\t// - Auto-sliding isn't paused by the user\n\t\t\t// - The presentation isn't paused\n\t\t\t// - The overview isn't active\n\t\t\t// - The presentation isn't over\n\t\t\tif( autoSlide && !autoSlidePaused && !isPaused() && !overview.isActive() && ( !isLastSlide() || fragments.availableRoutes().next || config.loop === true ) ) {\n\t\t\t\tautoSlideTimeout = setTimeout( () => {\n\t\t\t\t\tif( typeof config.autoSlideMethod === 'function' ) {\n\t\t\t\t\t\tconfig.autoSlideMethod()\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tnavigateNext();\n\t\t\t\t\t}\n\t\t\t\t\tcueAutoSlide();\n\t\t\t\t}, autoSlide );\n\t\t\t\tautoSlideStartTime = Date.now();\n\t\t\t}\n\n\t\t\tif( autoSlidePlayer ) {\n\t\t\t\tautoSlidePlayer.setPlaying( autoSlideTimeout !== -1 );\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Cancels any ongoing request to auto-slide.\n\t */\n\tfunction cancelAutoSlide() {\n\n\t\tclearTimeout( autoSlideTimeout );\n\t\tautoSlideTimeout = -1;\n\n\t}\n\n\tfunction pauseAutoSlide() {\n\n\t\tif( autoSlide && !autoSlidePaused ) {\n\t\t\tautoSlidePaused = true;\n\t\t\tdispatchEvent({ type: 'autoslidepaused' });\n\t\t\tclearTimeout( autoSlideTimeout );\n\n\t\t\tif( autoSlidePlayer ) {\n\t\t\t\tautoSlidePlayer.setPlaying( false );\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction resumeAutoSlide() {\n\n\t\tif( autoSlide && autoSlidePaused ) {\n\t\t\tautoSlidePaused = false;\n\t\t\tdispatchEvent({ type: 'autoslideresumed' });\n\t\t\tcueAutoSlide();\n\t\t}\n\n\t}\n\n\tfunction navigateLeft({skipFragments=false}={}) {\n\n\t\tnavigationHistory.hasNavigatedHorizontally = true;\n\n\t\t// Reverse for RTL\n\t\tif( config.rtl ) {\n\t\t\tif( ( overview.isActive() || skipFragments || fragments.next() === false ) && availableRoutes().left ) {\n\t\t\t\tslide( indexh + 1, config.navigationMode === 'grid' ? indexv : undefined );\n\t\t\t}\n\t\t}\n\t\t// Normal navigation\n\t\telse if( ( overview.isActive() || skipFragments || fragments.prev() === false ) && availableRoutes().left ) {\n\t\t\tslide( indexh - 1, config.navigationMode === 'grid' ? indexv : undefined );\n\t\t}\n\n\t}\n\n\tfunction navigateRight({skipFragments=false}={}) {\n\n\t\tnavigationHistory.hasNavigatedHorizontally = true;\n\n\t\t// Reverse for RTL\n\t\tif( config.rtl ) {\n\t\t\tif( ( overview.isActive() || skipFragments || fragments.prev() === false ) && availableRoutes().right ) {\n\t\t\t\tslide( indexh - 1, config.navigationMode === 'grid' ? indexv : undefined );\n\t\t\t}\n\t\t}\n\t\t// Normal navigation\n\t\telse if( ( overview.isActive() || skipFragments || fragments.next() === false ) && availableRoutes().right ) {\n\t\t\tslide( indexh + 1, config.navigationMode === 'grid' ? indexv : undefined );\n\t\t}\n\n\t}\n\n\tfunction navigateUp({skipFragments=false}={}) {\n\n\t\t// Prioritize hiding fragments\n\t\tif( ( overview.isActive() || skipFragments || fragments.prev() === false ) && availableRoutes().up ) {\n\t\t\tslide( indexh, indexv - 1 );\n\t\t}\n\n\t}\n\n\tfunction navigateDown({skipFragments=false}={}) {\n\n\t\tnavigationHistory.hasNavigatedVertically = true;\n\n\t\t// Prioritize revealing fragments\n\t\tif( ( overview.isActive() || skipFragments || fragments.next() === false ) && availableRoutes().down ) {\n\t\t\tslide( indexh, indexv + 1 );\n\t\t}\n\n\t}\n\n\t/**\n\t * Navigates backwards, prioritized in the following order:\n\t * 1) Previous fragment\n\t * 2) Previous vertical slide\n\t * 3) Previous horizontal slide\n\t */\n\tfunction navigatePrev({skipFragments=false}={}) {\n\n\t\t// Prioritize revealing fragments\n\t\tif( skipFragments || fragments.prev() === false ) {\n\t\t\tif( availableRoutes().up ) {\n\t\t\t\tnavigateUp({skipFragments});\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Fetch the previous horizontal slide, if there is one\n\t\t\t\tlet previousSlide;\n\n\t\t\t\tif( config.rtl ) {\n\t\t\t\t\tpreviousSlide = Util.queryAll( dom.wrapper, HORIZONTAL_SLIDES_SELECTOR + '.future' ).pop();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpreviousSlide = Util.queryAll( dom.wrapper, HORIZONTAL_SLIDES_SELECTOR + '.past' ).pop();\n\t\t\t\t}\n\n\t\t\t\t// When going backwards and arriving on a stack we start\n\t\t\t\t// at the bottom of the stack\n\t\t\t\tif( previousSlide && previousSlide.classList.contains( 'stack' ) ) {\n\t\t\t\t\tlet v = ( previousSlide.querySelectorAll( 'section' ).length - 1 ) || undefined;\n\t\t\t\t\tlet h = indexh - 1;\n\t\t\t\t\tslide( h, v );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnavigateLeft({skipFragments});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * The reverse of #navigatePrev().\n\t */\n\tfunction navigateNext({skipFragments=false}={}) {\n\n\t\tnavigationHistory.hasNavigatedHorizontally = true;\n\t\tnavigationHistory.hasNavigatedVertically = true;\n\n\t\t// Prioritize revealing fragments\n\t\tif( skipFragments || fragments.next() === false ) {\n\n\t\t\tlet routes = availableRoutes();\n\n\t\t\t// When looping is enabled `routes.down` is always available\n\t\t\t// so we need a separate check for when we've reached the\n\t\t\t// end of a stack and should move horizontally\n\t\t\tif( routes.down && routes.right && config.loop && isLastVerticalSlide() ) {\n\t\t\t\troutes.down = false;\n\t\t\t}\n\n\t\t\tif( routes.down ) {\n\t\t\t\tnavigateDown({skipFragments});\n\t\t\t}\n\t\t\telse if( config.rtl ) {\n\t\t\t\tnavigateLeft({skipFragments});\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnavigateRight({skipFragments});\n\t\t\t}\n\t\t}\n\n\t}\n\n\n\t// --------------------------------------------------------------------//\n\t// ----------------------------- EVENTS -------------------------------//\n\t// --------------------------------------------------------------------//\n\n\t/**\n\t * Called by all event handlers that are based on user\n\t * input.\n\t *\n\t * @param {object} [event]\n\t */\n\tfunction onUserInput( event ) {\n\n\t\tif( config.autoSlideStoppable ) {\n\t\t\tpauseAutoSlide();\n\t\t}\n\n\t}\n\n\t/**\n\t* Listener for post message events posted to this window.\n\t*/\n\tfunction onPostMessage( event ) {\n\n\t\tlet data = event.data;\n\n\t\t// Make sure we're dealing with JSON\n\t\tif( typeof data === 'string' && data.charAt( 0 ) === '{' && data.charAt( data.length - 1 ) === '}' ) {\n\t\t\tdata = JSON.parse( data );\n\n\t\t\t// Check if the requested method can be found\n\t\t\tif( data.method && typeof Reveal[data.method] === 'function' ) {\n\n\t\t\t\tif( POST_MESSAGE_METHOD_BLACKLIST.test( data.method ) === false ) {\n\n\t\t\t\t\tconst result = Reveal[data.method].apply( Reveal, data.args );\n\n\t\t\t\t\t// Dispatch a postMessage event with the returned value from\n\t\t\t\t\t// our method invocation for getter functions\n\t\t\t\t\tdispatchPostMessage( 'callback', { method: data.method, result: result } );\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconsole.warn( 'reveal.js: \"'+ data.method +'\" is is blacklisted from the postMessage API' );\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Event listener for transition end on the current slide.\n\t *\n\t * @param {object} [event]\n\t */\n\tfunction onTransitionEnd( event ) {\n\n\t\tif( transition === 'running' && /section/gi.test( event.target.nodeName ) ) {\n\t\t\ttransition = 'idle';\n\t\t\tdispatchEvent({\n\t\t\t\ttype: 'slidetransitionend',\n\t\t\t\tdata: { indexh, indexv, previousSlide, currentSlide }\n\t\t\t});\n\t\t}\n\n\t}\n\n\t/**\n\t * A global listener for all click events inside of the\n\t * .slides container.\n\t *\n\t * @param {object} [event]\n\t */\n\tfunction onSlidesClicked( event ) {\n\n\t\tconst anchor = Util.closest( event.target, 'a[href^=\"#\"]' );\n\n\t\t// If a hash link is clicked, we find the target slide\n\t\t// and navigate to it. We previously relied on 'hashchange'\n\t\t// for links like these but that prevented media with\n\t\t// audio tracks from playing in mobile browsers since it\n\t\t// wasn't considered a direct interaction with the document.\n\t\tif( anchor ) {\n\t\t\tconst hash = anchor.getAttribute( 'href' );\n\t\t\tconst indices = location.getIndicesFromHash( hash );\n\n\t\t\tif( indices ) {\n\t\t\t\tReveal.slide( indices.h, indices.v, indices.f );\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Handler for the window level 'resize' event.\n\t *\n\t * @param {object} [event]\n\t */\n\tfunction onWindowResize( event ) {\n\n\t\tlayout();\n\n\t}\n\n\t/**\n\t * Handle for the window level 'visibilitychange' event.\n\t *\n\t * @param {object} [event]\n\t */\n\tfunction onPageVisibilityChange( event ) {\n\n\t\t// If, after clicking a link or similar and we're coming back,\n\t\t// focus the document.body to ensure we can use keyboard shortcuts\n\t\tif( document.hidden === false && document.activeElement !== document.body ) {\n\t\t\t// Not all elements support .blur() - SVGs among them.\n\t\t\tif( typeof document.activeElement.blur === 'function' ) {\n\t\t\t\tdocument.activeElement.blur();\n\t\t\t}\n\t\t\tdocument.body.focus();\n\t\t}\n\n\t}\n\n\t/**\n\t * Handler for the document level 'fullscreenchange' event.\n\t *\n\t * @param {object} [event]\n\t */\n\tfunction onFullscreenChange( event ) {\n\n\t\tlet element = document.fullscreenElement || document.webkitFullscreenElement;\n\t\tif( element === dom.wrapper ) {\n\t\t\tevent.stopImmediatePropagation();\n\n\t\t\t// Timeout to avoid layout shift in Safari\n\t\t\tsetTimeout( () => {\n\t\t\t\tReveal.layout();\n\t\t\t\tReveal.focus.focus(); // focus.focus :'(\n\t\t\t}, 1 );\n\t\t}\n\n\t}\n\n\t/**\n\t * Handles clicks on links that are set to preview in the\n\t * iframe overlay.\n\t *\n\t * @param {object} event\n\t */\n\tfunction onPreviewLinkClicked( event ) {\n\n\t\tif( event.currentTarget && event.currentTarget.hasAttribute( 'href' ) ) {\n\t\t\tlet url = event.currentTarget.getAttribute( 'href' );\n\t\t\tif( url ) {\n\t\t\t\tshowPreview( url );\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t}\n\n\t}\n\n\t/**\n\t * Handles click on the auto-sliding controls element.\n\t *\n\t * @param {object} [event]\n\t */\n\tfunction onAutoSlidePlayerClick( event ) {\n\n\t\t// Replay\n\t\tif( isLastSlide() && config.loop === false ) {\n\t\t\tslide( 0, 0 );\n\t\t\tresumeAutoSlide();\n\t\t}\n\t\t// Resume\n\t\telse if( autoSlidePaused ) {\n\t\t\tresumeAutoSlide();\n\t\t}\n\t\t// Pause\n\t\telse {\n\t\t\tpauseAutoSlide();\n\t\t}\n\n\t}\n\n\n\t// --------------------------------------------------------------------//\n\t// ------------------------------- API --------------------------------//\n\t// --------------------------------------------------------------------//\n\n\t// The public reveal.js API\n\tconst API = {\n\t\tVERSION,\n\n\t\tinitialize,\n\t\tconfigure,\n\t\tdestroy,\n\n\t\tsync,\n\t\tsyncSlide,\n\t\tsyncFragments: fragments.sync.bind( fragments ),\n\n\t\t// Navigation methods\n\t\tslide,\n\t\tleft: navigateLeft,\n\t\tright: navigateRight,\n\t\tup: navigateUp,\n\t\tdown: navigateDown,\n\t\tprev: navigatePrev,\n\t\tnext: navigateNext,\n\n\t\t// Navigation aliases\n\t\tnavigateLeft, navigateRight, navigateUp, navigateDown, navigatePrev, navigateNext,\n\n\t\t// Fragment methods\n\t\tnavigateFragment: fragments.goto.bind( fragments ),\n\t\tprevFragment: fragments.prev.bind( fragments ),\n\t\tnextFragment: fragments.next.bind( fragments ),\n\n\t\t// Event binding\n\t\ton,\n\t\toff,\n\n\t\t// Legacy event binding methods left in for backwards compatibility\n\t\taddEventListener: on,\n\t\tremoveEventListener: off,\n\n\t\t// Forces an update in slide layout\n\t\tlayout,\n\n\t\t// Randomizes the order of slides\n\t\tshuffle,\n\n\t\t// Returns an object with the available routes as booleans (left/right/top/bottom)\n\t\tavailableRoutes,\n\n\t\t// Returns an object with the available fragments as booleans (prev/next)\n\t\tavailableFragments: fragments.availableRoutes.bind( fragments ),\n\n\t\t// Toggles a help overlay with keyboard shortcuts\n\t\ttoggleHelp,\n\n\t\t// Toggles the overview mode on/off\n\t\ttoggleOverview: overview.toggle.bind( overview ),\n\n\t\t// Toggles the \"black screen\" mode on/off\n\t\ttogglePause,\n\n\t\t// Toggles the auto slide mode on/off\n\t\ttoggleAutoSlide,\n\n\t\t// Toggles visibility of the jump-to-slide UI\n\t\ttoggleJumpToSlide,\n\n\t\t// Slide navigation checks\n\t\tisFirstSlide,\n\t\tisLastSlide,\n\t\tisLastVerticalSlide,\n\t\tisVerticalSlide,\n\n\t\t// State checks\n\t\tisPaused,\n\t\tisAutoSliding,\n\t\tisSpeakerNotes: notes.isSpeakerNotesWindow.bind( notes ),\n\t\tisOverview: overview.isActive.bind( overview ),\n\t\tisFocused: focus.isFocused.bind( focus ),\n\t\tisPrintingPDF: print.isPrintingPDF.bind( print ),\n\n\t\t// Checks if reveal.js has been loaded and is ready for use\n\t\tisReady: () => ready,\n\n\t\t// Slide preloading\n\t\tloadSlide: slideContent.load.bind( slideContent ),\n\t\tunloadSlide: slideContent.unload.bind( slideContent ),\n\n\t\t// Media playback\n\t\tstartEmbeddedContent: () => slideContent.startEmbeddedContent( currentSlide ),\n\t\tstopEmbeddedContent: () => slideContent.stopEmbeddedContent( currentSlide, { unloadIframes: false } ),\n\n\t\t// Preview management\n\t\tshowPreview,\n\t\thidePreview: closeOverlay,\n\n\t\t// Adds or removes all internal event listeners\n\t\taddEventListeners,\n\t\tremoveEventListeners,\n\t\tdispatchEvent,\n\n\t\t// Facility for persisting and restoring the presentation state\n\t\tgetState,\n\t\tsetState,\n\n\t\t// Presentation progress on range of 0-1\n\t\tgetProgress,\n\n\t\t// Returns the indices of the current, or specified, slide\n\t\tgetIndices,\n\n\t\t// Returns an Array of key:value maps of the attributes of each\n\t\t// slide in the deck\n\t\tgetSlidesAttributes,\n\n\t\t// Returns the number of slides that we have passed\n\t\tgetSlidePastCount,\n\n\t\t// Returns the total number of slides\n\t\tgetTotalSlides,\n\n\t\t// Returns the slide element at the specified index\n\t\tgetSlide,\n\n\t\t// Returns the previous slide element, may be null\n\t\tgetPreviousSlide: () => previousSlide,\n\n\t\t// Returns the current slide element\n\t\tgetCurrentSlide: () => currentSlide,\n\n\t\t// Returns the slide background element at the specified index\n\t\tgetSlideBackground,\n\n\t\t// Returns the speaker notes string for a slide, or null\n\t\tgetSlideNotes: notes.getSlideNotes.bind( notes ),\n\n\t\t// Returns an Array of all slides\n\t\tgetSlides,\n\n\t\t// Returns an array with all horizontal/vertical slides in the deck\n\t\tgetHorizontalSlides,\n\t\tgetVerticalSlides,\n\n\t\t// Checks if the presentation contains two or more horizontal\n\t\t// and vertical slides\n\t\thasHorizontalSlides,\n\t\thasVerticalSlides,\n\n\t\t// Checks if the deck has navigated on either axis at least once\n\t\thasNavigatedHorizontally: () => navigationHistory.hasNavigatedHorizontally,\n\t\thasNavigatedVertically: () => navigationHistory.hasNavigatedVertically,\n\n\t\t// Adds/removes a custom key binding\n\t\taddKeyBinding: keyboard.addKeyBinding.bind( keyboard ),\n\t\tremoveKeyBinding: keyboard.removeKeyBinding.bind( keyboard ),\n\n\t\t// Programmatically triggers a keyboard event\n\t\ttriggerKey: keyboard.triggerKey.bind( keyboard ),\n\n\t\t// Registers a new shortcut to include in the help overlay\n\t\tregisterKeyboardShortcut: keyboard.registerKeyboardShortcut.bind( keyboard ),\n\n\t\tgetComputedSlideSize,\n\n\t\t// Returns the current scale of the presentation content\n\t\tgetScale: () => scale,\n\n\t\t// Returns the current configuration object\n\t\tgetConfig: () => config,\n\n\t\t// Helper method, retrieves query string as a key:value map\n\t\tgetQueryHash: Util.getQueryHash,\n\n\t\t// Returns the path to the current slide as represented in the URL\n\t\tgetSlidePath: location.getHash.bind( location ),\n\n\t\t// Returns reveal.js DOM elements\n\t\tgetRevealElement: () => revealElement,\n\t\tgetSlidesElement: () => dom.slides,\n\t\tgetViewportElement: () => dom.viewport,\n\t\tgetBackgroundsElement: () => backgrounds.element,\n\n\t\t// API for registering and retrieving plugins\n\t\tregisterPlugin: plugins.registerPlugin.bind( plugins ),\n\t\thasPlugin: plugins.hasPlugin.bind( plugins ),\n\t\tgetPlugin: plugins.getPlugin.bind( plugins ),\n\t\tgetPlugins: plugins.getRegisteredPlugins.bind( plugins )\n\n\t};\n\n\t// Our internal API which controllers have access to\n\tUtil.extend( Reveal, {\n\t\t...API,\n\n\t\t// Methods for announcing content to screen readers\n\t\tannounceStatus,\n\t\tgetStatusText,\n\n\t\t// Controllers\n\t\tprint,\n\t\tfocus,\n\t\tprogress,\n\t\tcontrols,\n\t\tlocation,\n\t\toverview,\n\t\tfragments,\n\t\tslideContent,\n\t\tslideNumber,\n\n\t\tonUserInput,\n\t\tcloseOverlay,\n\t\tupdateSlidesVisibility,\n\t\tlayoutSlideContents,\n\t\ttransformSlides,\n\t\tcueAutoSlide,\n\t\tcancelAutoSlide\n\t} );\n\n\treturn API;\n\n};\n","/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview Firebase constants.  Some of these (@defines) can be overridden at compile-time.\r\n */\r\nconst CONSTANTS = {\r\n    /**\r\n     * @define {boolean} Whether this is the client Node.js SDK.\r\n     */\r\n    NODE_CLIENT: false,\r\n    /**\r\n     * @define {boolean} Whether this is the Admin Node.js SDK.\r\n     */\r\n    NODE_ADMIN: false,\r\n    /**\r\n     * Firebase SDK Version\r\n     */\r\n    SDK_VERSION: '${JSCORE_VERSION}'\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Throws an error if the provided assertion is falsy\r\n */\r\nconst assert = function (assertion, message) {\r\n    if (!assertion) {\r\n        throw assertionError(message);\r\n    }\r\n};\r\n/**\r\n * Returns an Error object suitable for throwing.\r\n */\r\nconst assertionError = function (message) {\r\n    return new Error('Firebase Database (' +\r\n        CONSTANTS.SDK_VERSION +\r\n        ') INTERNAL ASSERT FAILED: ' +\r\n        message);\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst stringToByteArray$1 = function (str) {\r\n    // TODO(user): Use native implementations if/when available\r\n    const out = [];\r\n    let p = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        let c = str.charCodeAt(i);\r\n        if (c < 128) {\r\n            out[p++] = c;\r\n        }\r\n        else if (c < 2048) {\r\n            out[p++] = (c >> 6) | 192;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else if ((c & 0xfc00) === 0xd800 &&\r\n            i + 1 < str.length &&\r\n            (str.charCodeAt(i + 1) & 0xfc00) === 0xdc00) {\r\n            // Surrogate Pair\r\n            c = 0x10000 + ((c & 0x03ff) << 10) + (str.charCodeAt(++i) & 0x03ff);\r\n            out[p++] = (c >> 18) | 240;\r\n            out[p++] = ((c >> 12) & 63) | 128;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else {\r\n            out[p++] = (c >> 12) | 224;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n    }\r\n    return out;\r\n};\r\n/**\r\n * Turns an array of numbers into the string given by the concatenation of the\r\n * characters to which the numbers correspond.\r\n * @param bytes Array of numbers representing characters.\r\n * @return Stringification of the array.\r\n */\r\nconst byteArrayToString = function (bytes) {\r\n    // TODO(user): Use native implementations if/when available\r\n    const out = [];\r\n    let pos = 0, c = 0;\r\n    while (pos < bytes.length) {\r\n        const c1 = bytes[pos++];\r\n        if (c1 < 128) {\r\n            out[c++] = String.fromCharCode(c1);\r\n        }\r\n        else if (c1 > 191 && c1 < 224) {\r\n            const c2 = bytes[pos++];\r\n            out[c++] = String.fromCharCode(((c1 & 31) << 6) | (c2 & 63));\r\n        }\r\n        else if (c1 > 239 && c1 < 365) {\r\n            // Surrogate Pair\r\n            const c2 = bytes[pos++];\r\n            const c3 = bytes[pos++];\r\n            const c4 = bytes[pos++];\r\n            const u = (((c1 & 7) << 18) | ((c2 & 63) << 12) | ((c3 & 63) << 6) | (c4 & 63)) -\r\n                0x10000;\r\n            out[c++] = String.fromCharCode(0xd800 + (u >> 10));\r\n            out[c++] = String.fromCharCode(0xdc00 + (u & 1023));\r\n        }\r\n        else {\r\n            const c2 = bytes[pos++];\r\n            const c3 = bytes[pos++];\r\n            out[c++] = String.fromCharCode(((c1 & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\r\n        }\r\n    }\r\n    return out.join('');\r\n};\r\n// We define it as an object literal instead of a class because a class compiled down to es5 can't\r\n// be treeshaked. https://github.com/rollup/rollup/issues/1691\r\n// Static lookup maps, lazily populated by init_()\r\nconst base64 = {\r\n    /**\r\n     * Maps bytes to characters.\r\n     */\r\n    byteToCharMap_: null,\r\n    /**\r\n     * Maps characters to bytes.\r\n     */\r\n    charToByteMap_: null,\r\n    /**\r\n     * Maps bytes to websafe characters.\r\n     * @private\r\n     */\r\n    byteToCharMapWebSafe_: null,\r\n    /**\r\n     * Maps websafe characters to bytes.\r\n     * @private\r\n     */\r\n    charToByteMapWebSafe_: null,\r\n    /**\r\n     * Our default alphabet, shared between\r\n     * ENCODED_VALS and ENCODED_VALS_WEBSAFE\r\n     */\r\n    ENCODED_VALS_BASE: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '0123456789',\r\n    /**\r\n     * Our default alphabet. Value 64 (=) is special; it means \"nothing.\"\r\n     */\r\n    get ENCODED_VALS() {\r\n        return this.ENCODED_VALS_BASE + '+/=';\r\n    },\r\n    /**\r\n     * Our websafe alphabet.\r\n     */\r\n    get ENCODED_VALS_WEBSAFE() {\r\n        return this.ENCODED_VALS_BASE + '-_.';\r\n    },\r\n    /**\r\n     * Whether this browser supports the atob and btoa functions. This extension\r\n     * started at Mozilla but is now implemented by many browsers. We use the\r\n     * ASSUME_* variables to avoid pulling in the full useragent detection library\r\n     * but still allowing the standard per-browser compilations.\r\n     *\r\n     */\r\n    HAS_NATIVE_SUPPORT: typeof atob === 'function',\r\n    /**\r\n     * Base64-encode an array of bytes.\r\n     *\r\n     * @param input An array of bytes (numbers with\r\n     *     value in [0, 255]) to encode.\r\n     * @param webSafe Boolean indicating we should use the\r\n     *     alternative alphabet.\r\n     * @return The base64 encoded string.\r\n     */\r\n    encodeByteArray(input, webSafe) {\r\n        if (!Array.isArray(input)) {\r\n            throw Error('encodeByteArray takes an array as a parameter');\r\n        }\r\n        this.init_();\r\n        const byteToCharMap = webSafe\r\n            ? this.byteToCharMapWebSafe_\r\n            : this.byteToCharMap_;\r\n        const output = [];\r\n        for (let i = 0; i < input.length; i += 3) {\r\n            const byte1 = input[i];\r\n            const haveByte2 = i + 1 < input.length;\r\n            const byte2 = haveByte2 ? input[i + 1] : 0;\r\n            const haveByte3 = i + 2 < input.length;\r\n            const byte3 = haveByte3 ? input[i + 2] : 0;\r\n            const outByte1 = byte1 >> 2;\r\n            const outByte2 = ((byte1 & 0x03) << 4) | (byte2 >> 4);\r\n            let outByte3 = ((byte2 & 0x0f) << 2) | (byte3 >> 6);\r\n            let outByte4 = byte3 & 0x3f;\r\n            if (!haveByte3) {\r\n                outByte4 = 64;\r\n                if (!haveByte2) {\r\n                    outByte3 = 64;\r\n                }\r\n            }\r\n            output.push(byteToCharMap[outByte1], byteToCharMap[outByte2], byteToCharMap[outByte3], byteToCharMap[outByte4]);\r\n        }\r\n        return output.join('');\r\n    },\r\n    /**\r\n     * Base64-encode a string.\r\n     *\r\n     * @param input A string to encode.\r\n     * @param webSafe If true, we should use the\r\n     *     alternative alphabet.\r\n     * @return The base64 encoded string.\r\n     */\r\n    encodeString(input, webSafe) {\r\n        // Shortcut for Mozilla browsers that implement\r\n        // a native base64 encoder in the form of \"btoa/atob\"\r\n        if (this.HAS_NATIVE_SUPPORT && !webSafe) {\r\n            return btoa(input);\r\n        }\r\n        return this.encodeByteArray(stringToByteArray$1(input), webSafe);\r\n    },\r\n    /**\r\n     * Base64-decode a string.\r\n     *\r\n     * @param input to decode.\r\n     * @param webSafe True if we should use the\r\n     *     alternative alphabet.\r\n     * @return string representing the decoded value.\r\n     */\r\n    decodeString(input, webSafe) {\r\n        // Shortcut for Mozilla browsers that implement\r\n        // a native base64 encoder in the form of \"btoa/atob\"\r\n        if (this.HAS_NATIVE_SUPPORT && !webSafe) {\r\n            return atob(input);\r\n        }\r\n        return byteArrayToString(this.decodeStringToByteArray(input, webSafe));\r\n    },\r\n    /**\r\n     * Base64-decode a string.\r\n     *\r\n     * In base-64 decoding, groups of four characters are converted into three\r\n     * bytes.  If the encoder did not apply padding, the input length may not\r\n     * be a multiple of 4.\r\n     *\r\n     * In this case, the last group will have fewer than 4 characters, and\r\n     * padding will be inferred.  If the group has one or two characters, it decodes\r\n     * to one byte.  If the group has three characters, it decodes to two bytes.\r\n     *\r\n     * @param input Input to decode.\r\n     * @param webSafe True if we should use the web-safe alphabet.\r\n     * @return bytes representing the decoded value.\r\n     */\r\n    decodeStringToByteArray(input, webSafe) {\r\n        this.init_();\r\n        const charToByteMap = webSafe\r\n            ? this.charToByteMapWebSafe_\r\n            : this.charToByteMap_;\r\n        const output = [];\r\n        for (let i = 0; i < input.length;) {\r\n            const byte1 = charToByteMap[input.charAt(i++)];\r\n            const haveByte2 = i < input.length;\r\n            const byte2 = haveByte2 ? charToByteMap[input.charAt(i)] : 0;\r\n            ++i;\r\n            const haveByte3 = i < input.length;\r\n            const byte3 = haveByte3 ? charToByteMap[input.charAt(i)] : 64;\r\n            ++i;\r\n            const haveByte4 = i < input.length;\r\n            const byte4 = haveByte4 ? charToByteMap[input.charAt(i)] : 64;\r\n            ++i;\r\n            if (byte1 == null || byte2 == null || byte3 == null || byte4 == null) {\r\n                throw new DecodeBase64StringError();\r\n            }\r\n            const outByte1 = (byte1 << 2) | (byte2 >> 4);\r\n            output.push(outByte1);\r\n            if (byte3 !== 64) {\r\n                const outByte2 = ((byte2 << 4) & 0xf0) | (byte3 >> 2);\r\n                output.push(outByte2);\r\n                if (byte4 !== 64) {\r\n                    const outByte3 = ((byte3 << 6) & 0xc0) | byte4;\r\n                    output.push(outByte3);\r\n                }\r\n            }\r\n        }\r\n        return output;\r\n    },\r\n    /**\r\n     * Lazy static initialization function. Called before\r\n     * accessing any of the static map variables.\r\n     * @private\r\n     */\r\n    init_() {\r\n        if (!this.byteToCharMap_) {\r\n            this.byteToCharMap_ = {};\r\n            this.charToByteMap_ = {};\r\n            this.byteToCharMapWebSafe_ = {};\r\n            this.charToByteMapWebSafe_ = {};\r\n            // We want quick mappings back and forth, so we precompute two maps.\r\n            for (let i = 0; i < this.ENCODED_VALS.length; i++) {\r\n                this.byteToCharMap_[i] = this.ENCODED_VALS.charAt(i);\r\n                this.charToByteMap_[this.byteToCharMap_[i]] = i;\r\n                this.byteToCharMapWebSafe_[i] = this.ENCODED_VALS_WEBSAFE.charAt(i);\r\n                this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]] = i;\r\n                // Be forgiving when decoding and correctly decode both encodings.\r\n                if (i >= this.ENCODED_VALS_BASE.length) {\r\n                    this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)] = i;\r\n                    this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)] = i;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n/**\r\n * An error encountered while decoding base64 string.\r\n */\r\nclass DecodeBase64StringError extends Error {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.name = 'DecodeBase64StringError';\r\n    }\r\n}\r\n/**\r\n * URL-safe base64 encoding\r\n */\r\nconst base64Encode = function (str) {\r\n    const utf8Bytes = stringToByteArray$1(str);\r\n    return base64.encodeByteArray(utf8Bytes, true);\r\n};\r\n/**\r\n * URL-safe base64 encoding (without \".\" padding in the end).\r\n * e.g. Used in JSON Web Token (JWT) parts.\r\n */\r\nconst base64urlEncodeWithoutPadding = function (str) {\r\n    // Use base64url encoding and remove padding in the end (dot characters).\r\n    return base64Encode(str).replace(/\\./g, '');\r\n};\r\n/**\r\n * URL-safe base64 decoding\r\n *\r\n * NOTE: DO NOT use the global atob() function - it does NOT support the\r\n * base64Url variant encoding.\r\n *\r\n * @param str To be decoded\r\n * @return Decoded result, if possible\r\n */\r\nconst base64Decode = function (str) {\r\n    try {\r\n        return base64.decodeString(str, true);\r\n    }\r\n    catch (e) {\r\n        console.error('base64Decode failed: ', e);\r\n    }\r\n    return null;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Do a deep-copy of basic JavaScript Objects or Arrays.\r\n */\r\nfunction deepCopy(value) {\r\n    return deepExtend(undefined, value);\r\n}\r\n/**\r\n * Copy properties from source to target (recursively allows extension\r\n * of Objects and Arrays).  Scalar values in the target are over-written.\r\n * If target is undefined, an object of the appropriate type will be created\r\n * (and returned).\r\n *\r\n * We recursively copy all child properties of plain Objects in the source- so\r\n * that namespace- like dictionaries are merged.\r\n *\r\n * Note that the target can be a function, in which case the properties in\r\n * the source Object are copied onto it as static properties of the Function.\r\n *\r\n * Note: we don't merge __proto__ to prevent prototype pollution\r\n */\r\nfunction deepExtend(target, source) {\r\n    if (!(source instanceof Object)) {\r\n        return source;\r\n    }\r\n    switch (source.constructor) {\r\n        case Date:\r\n            // Treat Dates like scalars; if the target date object had any child\r\n            // properties - they will be lost!\r\n            const dateValue = source;\r\n            return new Date(dateValue.getTime());\r\n        case Object:\r\n            if (target === undefined) {\r\n                target = {};\r\n            }\r\n            break;\r\n        case Array:\r\n            // Always copy the array source and overwrite the target.\r\n            target = [];\r\n            break;\r\n        default:\r\n            // Not a plain Object - treat it as a scalar.\r\n            return source;\r\n    }\r\n    for (const prop in source) {\r\n        // use isValidKey to guard against prototype pollution. See https://snyk.io/vuln/SNYK-JS-LODASH-450202\r\n        if (!source.hasOwnProperty(prop) || !isValidKey(prop)) {\r\n            continue;\r\n        }\r\n        target[prop] = deepExtend(target[prop], source[prop]);\r\n    }\r\n    return target;\r\n}\r\nfunction isValidKey(key) {\r\n    return key !== '__proto__';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2022 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Polyfill for `globalThis` object.\r\n * @returns the `globalThis` object for the given environment.\r\n * @public\r\n */\r\nfunction getGlobal() {\r\n    if (typeof self !== 'undefined') {\r\n        return self;\r\n    }\r\n    if (typeof window !== 'undefined') {\r\n        return window;\r\n    }\r\n    if (typeof global !== 'undefined') {\r\n        return global;\r\n    }\r\n    throw new Error('Unable to locate global object.');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2022 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst getDefaultsFromGlobal = () => getGlobal().__FIREBASE_DEFAULTS__;\r\n/**\r\n * Attempt to read defaults from a JSON string provided to\r\n * process(.)env(.)__FIREBASE_DEFAULTS__ or a JSON file whose path is in\r\n * process(.)env(.)__FIREBASE_DEFAULTS_PATH__\r\n * The dots are in parens because certain compilers (Vite?) cannot\r\n * handle seeing that variable in comments.\r\n * See https://github.com/firebase/firebase-js-sdk/issues/6838\r\n */\r\nconst getDefaultsFromEnvVariable = () => {\r\n    if (typeof process === 'undefined' || typeof process.env === 'undefined') {\r\n        return;\r\n    }\r\n    const defaultsJsonString = process.env.__FIREBASE_DEFAULTS__;\r\n    if (defaultsJsonString) {\r\n        return JSON.parse(defaultsJsonString);\r\n    }\r\n};\r\nconst getDefaultsFromCookie = () => {\r\n    if (typeof document === 'undefined') {\r\n        return;\r\n    }\r\n    let match;\r\n    try {\r\n        match = document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/);\r\n    }\r\n    catch (e) {\r\n        // Some environments such as Angular Universal SSR have a\r\n        // `document` object but error on accessing `document.cookie`.\r\n        return;\r\n    }\r\n    const decoded = match && base64Decode(match[1]);\r\n    return decoded && JSON.parse(decoded);\r\n};\r\n/**\r\n * Get the __FIREBASE_DEFAULTS__ object. It checks in order:\r\n * (1) if such an object exists as a property of `globalThis`\r\n * (2) if such an object was provided on a shell environment variable\r\n * (3) if such an object exists in a cookie\r\n * @public\r\n */\r\nconst getDefaults = () => {\r\n    try {\r\n        return (getDefaultsFromGlobal() ||\r\n            getDefaultsFromEnvVariable() ||\r\n            getDefaultsFromCookie());\r\n    }\r\n    catch (e) {\r\n        /**\r\n         * Catch-all for being unable to get __FIREBASE_DEFAULTS__ due\r\n         * to any environment case we have not accounted for. Log to\r\n         * info instead of swallowing so we can find these unknown cases\r\n         * and add paths for them if needed.\r\n         */\r\n        console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);\r\n        return;\r\n    }\r\n};\r\n/**\r\n * Returns emulator host stored in the __FIREBASE_DEFAULTS__ object\r\n * for the given product.\r\n * @returns a URL host formatted like `127.0.0.1:9999` or `[::1]:4000` if available\r\n * @public\r\n */\r\nconst getDefaultEmulatorHost = (productName) => { var _a, _b; return (_b = (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.emulatorHosts) === null || _b === void 0 ? void 0 : _b[productName]; };\r\n/**\r\n * Returns emulator hostname and port stored in the __FIREBASE_DEFAULTS__ object\r\n * for the given product.\r\n * @returns a pair of hostname and port like `[\"::1\", 4000]` if available\r\n * @public\r\n */\r\nconst getDefaultEmulatorHostnameAndPort = (productName) => {\r\n    const host = getDefaultEmulatorHost(productName);\r\n    if (!host) {\r\n        return undefined;\r\n    }\r\n    const separatorIndex = host.lastIndexOf(':'); // Finding the last since IPv6 addr also has colons.\r\n    if (separatorIndex <= 0 || separatorIndex + 1 === host.length) {\r\n        throw new Error(`Invalid host ${host} with no separate hostname and port!`);\r\n    }\r\n    // eslint-disable-next-line no-restricted-globals\r\n    const port = parseInt(host.substring(separatorIndex + 1), 10);\r\n    if (host[0] === '[') {\r\n        // Bracket-quoted `[ipv6addr]:port` => return \"ipv6addr\" (without brackets).\r\n        return [host.substring(1, separatorIndex - 1), port];\r\n    }\r\n    else {\r\n        return [host.substring(0, separatorIndex), port];\r\n    }\r\n};\r\n/**\r\n * Returns Firebase app config stored in the __FIREBASE_DEFAULTS__ object.\r\n * @public\r\n */\r\nconst getDefaultAppConfig = () => { var _a; return (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.config; };\r\n/**\r\n * Returns an experimental setting on the __FIREBASE_DEFAULTS__ object (properties\r\n * prefixed by \"_\")\r\n * @public\r\n */\r\nconst getExperimentalSetting = (name) => { var _a; return (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a[`_${name}`]; };\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nclass Deferred {\r\n    constructor() {\r\n        this.reject = () => { };\r\n        this.resolve = () => { };\r\n        this.promise = new Promise((resolve, reject) => {\r\n            this.resolve = resolve;\r\n            this.reject = reject;\r\n        });\r\n    }\r\n    /**\r\n     * Our API internals are not promiseified and cannot because our callback APIs have subtle expectations around\r\n     * invoking promises inline, which Promises are forbidden to do. This method accepts an optional node-style callback\r\n     * and returns a node-style callback which will resolve or reject the Deferred's promise.\r\n     */\r\n    wrapCallback(callback) {\r\n        return (error, value) => {\r\n            if (error) {\r\n                this.reject(error);\r\n            }\r\n            else {\r\n                this.resolve(value);\r\n            }\r\n            if (typeof callback === 'function') {\r\n                // Attaching noop handler just in case developer wasn't expecting\r\n                // promises\r\n                this.promise.catch(() => { });\r\n                // Some of our callbacks don't expect a value and our own tests\r\n                // assert that the parameter length is 1\r\n                if (callback.length === 1) {\r\n                    callback(error);\r\n                }\r\n                else {\r\n                    callback(error, value);\r\n                }\r\n            }\r\n        };\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction createMockUserToken(token, projectId) {\r\n    if (token.uid) {\r\n        throw new Error('The \"uid\" field is no longer supported by mockUserToken. Please use \"sub\" instead for Firebase Auth User ID.');\r\n    }\r\n    // Unsecured JWTs use \"none\" as the algorithm.\r\n    const header = {\r\n        alg: 'none',\r\n        type: 'JWT'\r\n    };\r\n    const project = projectId || 'demo-project';\r\n    const iat = token.iat || 0;\r\n    const sub = token.sub || token.user_id;\r\n    if (!sub) {\r\n        throw new Error(\"mockUserToken must contain 'sub' or 'user_id' field!\");\r\n    }\r\n    const payload = Object.assign({ \r\n        // Set all required fields to decent defaults\r\n        iss: `https://securetoken.google.com/${project}`, aud: project, iat, exp: iat + 3600, auth_time: iat, sub, user_id: sub, firebase: {\r\n            sign_in_provider: 'custom',\r\n            identities: {}\r\n        } }, token);\r\n    // Unsecured JWTs use the empty string as a signature.\r\n    const signature = '';\r\n    return [\r\n        base64urlEncodeWithoutPadding(JSON.stringify(header)),\r\n        base64urlEncodeWithoutPadding(JSON.stringify(payload)),\r\n        signature\r\n    ].join('.');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns navigator.userAgent string or '' if it's not defined.\r\n * @return user agent string\r\n */\r\nfunction getUA() {\r\n    if (typeof navigator !== 'undefined' &&\r\n        typeof navigator['userAgent'] === 'string') {\r\n        return navigator['userAgent'];\r\n    }\r\n    else {\r\n        return '';\r\n    }\r\n}\r\n/**\r\n * Detect Cordova / PhoneGap / Ionic frameworks on a mobile device.\r\n *\r\n * Deliberately does not rely on checking `file://` URLs (as this fails PhoneGap\r\n * in the Ripple emulator) nor Cordova `onDeviceReady`, which would normally\r\n * wait for a callback.\r\n */\r\nfunction isMobileCordova() {\r\n    return (typeof window !== 'undefined' &&\r\n        // @ts-ignore Setting up an broadly applicable index signature for Window\r\n        // just to deal with this case would probably be a bad idea.\r\n        !!(window['cordova'] || window['phonegap'] || window['PhoneGap']) &&\r\n        /ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA()));\r\n}\r\n/**\r\n * Detect Node.js.\r\n *\r\n * @return true if Node.js environment is detected or specified.\r\n */\r\n// Node detection logic from: https://github.com/iliakan/detect-node/\r\nfunction isNode() {\r\n    var _a;\r\n    const forceEnvironment = (_a = getDefaults()) === null || _a === void 0 ? void 0 : _a.forceEnvironment;\r\n    if (forceEnvironment === 'node') {\r\n        return true;\r\n    }\r\n    else if (forceEnvironment === 'browser') {\r\n        return false;\r\n    }\r\n    try {\r\n        return (Object.prototype.toString.call(global.process) === '[object process]');\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * Detect Browser Environment\r\n */\r\nfunction isBrowser() {\r\n    return typeof self === 'object' && self.self === self;\r\n}\r\nfunction isBrowserExtension() {\r\n    const runtime = typeof chrome === 'object'\r\n        ? chrome.runtime\r\n        : typeof browser === 'object'\r\n            ? browser.runtime\r\n            : undefined;\r\n    return typeof runtime === 'object' && runtime.id !== undefined;\r\n}\r\n/**\r\n * Detect React Native.\r\n *\r\n * @return true if ReactNative environment is detected.\r\n */\r\nfunction isReactNative() {\r\n    return (typeof navigator === 'object' && navigator['product'] === 'ReactNative');\r\n}\r\n/** Detects Electron apps. */\r\nfunction isElectron() {\r\n    return getUA().indexOf('Electron/') >= 0;\r\n}\r\n/** Detects Internet Explorer. */\r\nfunction isIE() {\r\n    const ua = getUA();\r\n    return ua.indexOf('MSIE ') >= 0 || ua.indexOf('Trident/') >= 0;\r\n}\r\n/** Detects Universal Windows Platform apps. */\r\nfunction isUWP() {\r\n    return getUA().indexOf('MSAppHost/') >= 0;\r\n}\r\n/**\r\n * Detect whether the current SDK build is the Node version.\r\n *\r\n * @return true if it's the Node SDK build.\r\n */\r\nfunction isNodeSdk() {\r\n    return CONSTANTS.NODE_CLIENT === true || CONSTANTS.NODE_ADMIN === true;\r\n}\r\n/** Returns true if we are running in Safari. */\r\nfunction isSafari() {\r\n    return (!isNode() &&\r\n        navigator.userAgent.includes('Safari') &&\r\n        !navigator.userAgent.includes('Chrome'));\r\n}\r\n/**\r\n * This method checks if indexedDB is supported by current browser/service worker context\r\n * @return true if indexedDB is supported by current browser/service worker context\r\n */\r\nfunction isIndexedDBAvailable() {\r\n    try {\r\n        return typeof indexedDB === 'object';\r\n    }\r\n    catch (e) {\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * This method validates browser/sw context for indexedDB by opening a dummy indexedDB database and reject\r\n * if errors occur during the database open operation.\r\n *\r\n * @throws exception if current browser/sw context can't run idb.open (ex: Safari iframe, Firefox\r\n * private browsing)\r\n */\r\nfunction validateIndexedDBOpenable() {\r\n    return new Promise((resolve, reject) => {\r\n        try {\r\n            let preExist = true;\r\n            const DB_CHECK_NAME = 'validate-browser-context-for-indexeddb-analytics-module';\r\n            const request = self.indexedDB.open(DB_CHECK_NAME);\r\n            request.onsuccess = () => {\r\n                request.result.close();\r\n                // delete database only when it doesn't pre-exist\r\n                if (!preExist) {\r\n                    self.indexedDB.deleteDatabase(DB_CHECK_NAME);\r\n                }\r\n                resolve(true);\r\n            };\r\n            request.onupgradeneeded = () => {\r\n                preExist = false;\r\n            };\r\n            request.onerror = () => {\r\n                var _a;\r\n                reject(((_a = request.error) === null || _a === void 0 ? void 0 : _a.message) || '');\r\n            };\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    });\r\n}\r\n/**\r\n *\r\n * This method checks whether cookie is enabled within current browser\r\n * @return true if cookie is enabled within current browser\r\n */\r\nfunction areCookiesEnabled() {\r\n    if (typeof navigator === 'undefined' || !navigator.cookieEnabled) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview Standardized Firebase Error.\r\n *\r\n * Usage:\r\n *\r\n *   // Typescript string literals for type-safe codes\r\n *   type Err =\r\n *     'unknown' |\r\n *     'object-not-found'\r\n *     ;\r\n *\r\n *   // Closure enum for type-safe error codes\r\n *   // at-enum {string}\r\n *   var Err = {\r\n *     UNKNOWN: 'unknown',\r\n *     OBJECT_NOT_FOUND: 'object-not-found',\r\n *   }\r\n *\r\n *   let errors: Map<Err, string> = {\r\n *     'generic-error': \"Unknown error\",\r\n *     'file-not-found': \"Could not find file: {$file}\",\r\n *   };\r\n *\r\n *   // Type-safe function - must pass a valid error code as param.\r\n *   let error = new ErrorFactory<Err>('service', 'Service', errors);\r\n *\r\n *   ...\r\n *   throw error.create(Err.GENERIC);\r\n *   ...\r\n *   throw error.create(Err.FILE_NOT_FOUND, {'file': fileName});\r\n *   ...\r\n *   // Service: Could not file file: foo.txt (service/file-not-found).\r\n *\r\n *   catch (e) {\r\n *     assert(e.message === \"Could not find file: foo.txt.\");\r\n *     if ((e as FirebaseError)?.code === 'service/file-not-found') {\r\n *       console.log(\"Could not read file: \" + e['file']);\r\n *     }\r\n *   }\r\n */\r\nconst ERROR_NAME = 'FirebaseError';\r\n// Based on code from:\r\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types\r\nclass FirebaseError extends Error {\r\n    constructor(\r\n    /** The error code for this error. */\r\n    code, message, \r\n    /** Custom data for this error. */\r\n    customData) {\r\n        super(message);\r\n        this.code = code;\r\n        this.customData = customData;\r\n        /** The custom name for all FirebaseErrors. */\r\n        this.name = ERROR_NAME;\r\n        // Fix For ES5\r\n        // https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\r\n        Object.setPrototypeOf(this, FirebaseError.prototype);\r\n        // Maintains proper stack trace for where our error was thrown.\r\n        // Only available on V8.\r\n        if (Error.captureStackTrace) {\r\n            Error.captureStackTrace(this, ErrorFactory.prototype.create);\r\n        }\r\n    }\r\n}\r\nclass ErrorFactory {\r\n    constructor(service, serviceName, errors) {\r\n        this.service = service;\r\n        this.serviceName = serviceName;\r\n        this.errors = errors;\r\n    }\r\n    create(code, ...data) {\r\n        const customData = data[0] || {};\r\n        const fullCode = `${this.service}/${code}`;\r\n        const template = this.errors[code];\r\n        const message = template ? replaceTemplate(template, customData) : 'Error';\r\n        // Service Name: Error message (service/code).\r\n        const fullMessage = `${this.serviceName}: ${message} (${fullCode}).`;\r\n        const error = new FirebaseError(fullCode, fullMessage, customData);\r\n        return error;\r\n    }\r\n}\r\nfunction replaceTemplate(template, data) {\r\n    return template.replace(PATTERN, (_, key) => {\r\n        const value = data[key];\r\n        return value != null ? String(value) : `<${key}?>`;\r\n    });\r\n}\r\nconst PATTERN = /\\{\\$([^}]+)}/g;\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Evaluates a JSON string into a javascript object.\r\n *\r\n * @param {string} str A string containing JSON.\r\n * @return {*} The javascript object representing the specified JSON.\r\n */\r\nfunction jsonEval(str) {\r\n    return JSON.parse(str);\r\n}\r\n/**\r\n * Returns JSON representing a javascript object.\r\n * @param {*} data Javascript object to be stringified.\r\n * @return {string} The JSON contents of the object.\r\n */\r\nfunction stringify(data) {\r\n    return JSON.stringify(data);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Decodes a Firebase auth. token into constituent parts.\r\n *\r\n * Notes:\r\n * - May return with invalid / incomplete claims if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst decode = function (token) {\r\n    let header = {}, claims = {}, data = {}, signature = '';\r\n    try {\r\n        const parts = token.split('.');\r\n        header = jsonEval(base64Decode(parts[0]) || '');\r\n        claims = jsonEval(base64Decode(parts[1]) || '');\r\n        signature = parts[2];\r\n        data = claims['d'] || {};\r\n        delete claims['d'];\r\n    }\r\n    catch (e) { }\r\n    return {\r\n        header,\r\n        claims,\r\n        data,\r\n        signature\r\n    };\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its time-based claims. Will return true if the\r\n * token is within the time window authorized by the 'nbf' (not-before) and 'iat' (issued-at) claims.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst isValidTimestamp = function (token) {\r\n    const claims = decode(token).claims;\r\n    const now = Math.floor(new Date().getTime() / 1000);\r\n    let validSince = 0, validUntil = 0;\r\n    if (typeof claims === 'object') {\r\n        if (claims.hasOwnProperty('nbf')) {\r\n            validSince = claims['nbf'];\r\n        }\r\n        else if (claims.hasOwnProperty('iat')) {\r\n            validSince = claims['iat'];\r\n        }\r\n        if (claims.hasOwnProperty('exp')) {\r\n            validUntil = claims['exp'];\r\n        }\r\n        else {\r\n            // token will expire after 24h by default\r\n            validUntil = validSince + 86400;\r\n        }\r\n    }\r\n    return (!!now &&\r\n        !!validSince &&\r\n        !!validUntil &&\r\n        now >= validSince &&\r\n        now <= validUntil);\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and returns its issued at time if valid, null otherwise.\r\n *\r\n * Notes:\r\n * - May return null if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst issuedAtTime = function (token) {\r\n    const claims = decode(token).claims;\r\n    if (typeof claims === 'object' && claims.hasOwnProperty('iat')) {\r\n        return claims['iat'];\r\n    }\r\n    return null;\r\n};\r\n/**\r\n * Decodes a Firebase auth. token and checks the validity of its format. Expects a valid issued-at time.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst isValidFormat = function (token) {\r\n    const decoded = decode(token), claims = decoded.claims;\r\n    return !!claims && typeof claims === 'object' && claims.hasOwnProperty('iat');\r\n};\r\n/**\r\n * Attempts to peer into an auth token and determine if it's an admin auth token by looking at the claims portion.\r\n *\r\n * Notes:\r\n * - May return a false negative if there's no native base64 decoding support.\r\n * - Doesn't check if the token is actually valid.\r\n */\r\nconst isAdmin = function (token) {\r\n    const claims = decode(token).claims;\r\n    return typeof claims === 'object' && claims['admin'] === true;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction contains(obj, key) {\r\n    return Object.prototype.hasOwnProperty.call(obj, key);\r\n}\r\nfunction safeGet(obj, key) {\r\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n        return obj[key];\r\n    }\r\n    else {\r\n        return undefined;\r\n    }\r\n}\r\nfunction isEmpty(obj) {\r\n    for (const key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction map(obj, fn, contextObj) {\r\n    const res = {};\r\n    for (const key in obj) {\r\n        if (Object.prototype.hasOwnProperty.call(obj, key)) {\r\n            res[key] = fn.call(contextObj, obj[key], key, obj);\r\n        }\r\n    }\r\n    return res;\r\n}\r\n/**\r\n * Deep equal two objects. Support Arrays and Objects.\r\n */\r\nfunction deepEqual(a, b) {\r\n    if (a === b) {\r\n        return true;\r\n    }\r\n    const aKeys = Object.keys(a);\r\n    const bKeys = Object.keys(b);\r\n    for (const k of aKeys) {\r\n        if (!bKeys.includes(k)) {\r\n            return false;\r\n        }\r\n        const aProp = a[k];\r\n        const bProp = b[k];\r\n        if (isObject(aProp) && isObject(bProp)) {\r\n            if (!deepEqual(aProp, bProp)) {\r\n                return false;\r\n            }\r\n        }\r\n        else if (aProp !== bProp) {\r\n            return false;\r\n        }\r\n    }\r\n    for (const k of bKeys) {\r\n        if (!aKeys.includes(k)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction isObject(thing) {\r\n    return thing !== null && typeof thing === 'object';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2022 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Rejects if the given promise doesn't resolve in timeInMS milliseconds.\r\n * @internal\r\n */\r\nfunction promiseWithTimeout(promise, timeInMS = 2000) {\r\n    const deferredPromise = new Deferred();\r\n    setTimeout(() => deferredPromise.reject('timeout!'), timeInMS);\r\n    promise.then(deferredPromise.resolve, deferredPromise.reject);\r\n    return deferredPromise.promise;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a querystring-formatted string (e.g. &arg=val&arg2=val2) from a\r\n * params object (e.g. {arg: 'val', arg2: 'val2'})\r\n * Note: You must prepend it with ? when adding it to a URL.\r\n */\r\nfunction querystring(querystringParams) {\r\n    const params = [];\r\n    for (const [key, value] of Object.entries(querystringParams)) {\r\n        if (Array.isArray(value)) {\r\n            value.forEach(arrayVal => {\r\n                params.push(encodeURIComponent(key) + '=' + encodeURIComponent(arrayVal));\r\n            });\r\n        }\r\n        else {\r\n            params.push(encodeURIComponent(key) + '=' + encodeURIComponent(value));\r\n        }\r\n    }\r\n    return params.length ? '&' + params.join('&') : '';\r\n}\r\n/**\r\n * Decodes a querystring (e.g. ?arg=val&arg2=val2) into a params object\r\n * (e.g. {arg: 'val', arg2: 'val2'})\r\n */\r\nfunction querystringDecode(querystring) {\r\n    const obj = {};\r\n    const tokens = querystring.replace(/^\\?/, '').split('&');\r\n    tokens.forEach(token => {\r\n        if (token) {\r\n            const [key, value] = token.split('=');\r\n            obj[decodeURIComponent(key)] = decodeURIComponent(value);\r\n        }\r\n    });\r\n    return obj;\r\n}\r\n/**\r\n * Extract the query string part of a URL, including the leading question mark (if present).\r\n */\r\nfunction extractQuerystring(url) {\r\n    const queryStart = url.indexOf('?');\r\n    if (!queryStart) {\r\n        return '';\r\n    }\r\n    const fragmentStart = url.indexOf('#', queryStart);\r\n    return url.substring(queryStart, fragmentStart > 0 ? fragmentStart : undefined);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @fileoverview SHA-1 cryptographic hash.\r\n * Variable names follow the notation in FIPS PUB 180-3:\r\n * http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf.\r\n *\r\n * Usage:\r\n *   var sha1 = new sha1();\r\n *   sha1.update(bytes);\r\n *   var hash = sha1.digest();\r\n *\r\n * Performance:\r\n *   Chrome 23:   ~400 Mbit/s\r\n *   Firefox 16:  ~250 Mbit/s\r\n *\r\n */\r\n/**\r\n * SHA-1 cryptographic hash constructor.\r\n *\r\n * The properties declared here are discussed in the above algorithm document.\r\n * @constructor\r\n * @final\r\n * @struct\r\n */\r\nclass Sha1 {\r\n    constructor() {\r\n        /**\r\n         * Holds the previous values of accumulated variables a-e in the compress_\r\n         * function.\r\n         * @private\r\n         */\r\n        this.chain_ = [];\r\n        /**\r\n         * A buffer holding the partially computed hash result.\r\n         * @private\r\n         */\r\n        this.buf_ = [];\r\n        /**\r\n         * An array of 80 bytes, each a part of the message to be hashed.  Referred to\r\n         * as the message schedule in the docs.\r\n         * @private\r\n         */\r\n        this.W_ = [];\r\n        /**\r\n         * Contains data needed to pad messages less than 64 bytes.\r\n         * @private\r\n         */\r\n        this.pad_ = [];\r\n        /**\r\n         * @private {number}\r\n         */\r\n        this.inbuf_ = 0;\r\n        /**\r\n         * @private {number}\r\n         */\r\n        this.total_ = 0;\r\n        this.blockSize = 512 / 8;\r\n        this.pad_[0] = 128;\r\n        for (let i = 1; i < this.blockSize; ++i) {\r\n            this.pad_[i] = 0;\r\n        }\r\n        this.reset();\r\n    }\r\n    reset() {\r\n        this.chain_[0] = 0x67452301;\r\n        this.chain_[1] = 0xefcdab89;\r\n        this.chain_[2] = 0x98badcfe;\r\n        this.chain_[3] = 0x10325476;\r\n        this.chain_[4] = 0xc3d2e1f0;\r\n        this.inbuf_ = 0;\r\n        this.total_ = 0;\r\n    }\r\n    /**\r\n     * Internal compress helper function.\r\n     * @param buf Block to compress.\r\n     * @param offset Offset of the block in the buffer.\r\n     * @private\r\n     */\r\n    compress_(buf, offset) {\r\n        if (!offset) {\r\n            offset = 0;\r\n        }\r\n        const W = this.W_;\r\n        // get 16 big endian words\r\n        if (typeof buf === 'string') {\r\n            for (let i = 0; i < 16; i++) {\r\n                // TODO(user): [bug 8140122] Recent versions of Safari for Mac OS and iOS\r\n                // have a bug that turns the post-increment ++ operator into pre-increment\r\n                // during JIT compilation.  We have code that depends heavily on SHA-1 for\r\n                // correctness and which is affected by this bug, so I've removed all uses\r\n                // of post-increment ++ in which the result value is used.  We can revert\r\n                // this change once the Safari bug\r\n                // (https://bugs.webkit.org/show_bug.cgi?id=109036) has been fixed and\r\n                // most clients have been updated.\r\n                W[i] =\r\n                    (buf.charCodeAt(offset) << 24) |\r\n                        (buf.charCodeAt(offset + 1) << 16) |\r\n                        (buf.charCodeAt(offset + 2) << 8) |\r\n                        buf.charCodeAt(offset + 3);\r\n                offset += 4;\r\n            }\r\n        }\r\n        else {\r\n            for (let i = 0; i < 16; i++) {\r\n                W[i] =\r\n                    (buf[offset] << 24) |\r\n                        (buf[offset + 1] << 16) |\r\n                        (buf[offset + 2] << 8) |\r\n                        buf[offset + 3];\r\n                offset += 4;\r\n            }\r\n        }\r\n        // expand to 80 words\r\n        for (let i = 16; i < 80; i++) {\r\n            const t = W[i - 3] ^ W[i - 8] ^ W[i - 14] ^ W[i - 16];\r\n            W[i] = ((t << 1) | (t >>> 31)) & 0xffffffff;\r\n        }\r\n        let a = this.chain_[0];\r\n        let b = this.chain_[1];\r\n        let c = this.chain_[2];\r\n        let d = this.chain_[3];\r\n        let e = this.chain_[4];\r\n        let f, k;\r\n        // TODO(user): Try to unroll this loop to speed up the computation.\r\n        for (let i = 0; i < 80; i++) {\r\n            if (i < 40) {\r\n                if (i < 20) {\r\n                    f = d ^ (b & (c ^ d));\r\n                    k = 0x5a827999;\r\n                }\r\n                else {\r\n                    f = b ^ c ^ d;\r\n                    k = 0x6ed9eba1;\r\n                }\r\n            }\r\n            else {\r\n                if (i < 60) {\r\n                    f = (b & c) | (d & (b | c));\r\n                    k = 0x8f1bbcdc;\r\n                }\r\n                else {\r\n                    f = b ^ c ^ d;\r\n                    k = 0xca62c1d6;\r\n                }\r\n            }\r\n            const t = (((a << 5) | (a >>> 27)) + f + e + k + W[i]) & 0xffffffff;\r\n            e = d;\r\n            d = c;\r\n            c = ((b << 30) | (b >>> 2)) & 0xffffffff;\r\n            b = a;\r\n            a = t;\r\n        }\r\n        this.chain_[0] = (this.chain_[0] + a) & 0xffffffff;\r\n        this.chain_[1] = (this.chain_[1] + b) & 0xffffffff;\r\n        this.chain_[2] = (this.chain_[2] + c) & 0xffffffff;\r\n        this.chain_[3] = (this.chain_[3] + d) & 0xffffffff;\r\n        this.chain_[4] = (this.chain_[4] + e) & 0xffffffff;\r\n    }\r\n    update(bytes, length) {\r\n        // TODO(johnlenz): tighten the function signature and remove this check\r\n        if (bytes == null) {\r\n            return;\r\n        }\r\n        if (length === undefined) {\r\n            length = bytes.length;\r\n        }\r\n        const lengthMinusBlock = length - this.blockSize;\r\n        let n = 0;\r\n        // Using local instead of member variables gives ~5% speedup on Firefox 16.\r\n        const buf = this.buf_;\r\n        let inbuf = this.inbuf_;\r\n        // The outer while loop should execute at most twice.\r\n        while (n < length) {\r\n            // When we have no data in the block to top up, we can directly process the\r\n            // input buffer (assuming it contains sufficient data). This gives ~25%\r\n            // speedup on Chrome 23 and ~15% speedup on Firefox 16, but requires that\r\n            // the data is provided in large chunks (or in multiples of 64 bytes).\r\n            if (inbuf === 0) {\r\n                while (n <= lengthMinusBlock) {\r\n                    this.compress_(bytes, n);\r\n                    n += this.blockSize;\r\n                }\r\n            }\r\n            if (typeof bytes === 'string') {\r\n                while (n < length) {\r\n                    buf[inbuf] = bytes.charCodeAt(n);\r\n                    ++inbuf;\r\n                    ++n;\r\n                    if (inbuf === this.blockSize) {\r\n                        this.compress_(buf);\r\n                        inbuf = 0;\r\n                        // Jump to the outer loop so we use the full-block optimization.\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                while (n < length) {\r\n                    buf[inbuf] = bytes[n];\r\n                    ++inbuf;\r\n                    ++n;\r\n                    if (inbuf === this.blockSize) {\r\n                        this.compress_(buf);\r\n                        inbuf = 0;\r\n                        // Jump to the outer loop so we use the full-block optimization.\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.inbuf_ = inbuf;\r\n        this.total_ += length;\r\n    }\r\n    /** @override */\r\n    digest() {\r\n        const digest = [];\r\n        let totalBits = this.total_ * 8;\r\n        // Add pad 0x80 0x00*.\r\n        if (this.inbuf_ < 56) {\r\n            this.update(this.pad_, 56 - this.inbuf_);\r\n        }\r\n        else {\r\n            this.update(this.pad_, this.blockSize - (this.inbuf_ - 56));\r\n        }\r\n        // Add # bits.\r\n        for (let i = this.blockSize - 1; i >= 56; i--) {\r\n            this.buf_[i] = totalBits & 255;\r\n            totalBits /= 256; // Don't use bit-shifting here!\r\n        }\r\n        this.compress_(this.buf_);\r\n        let n = 0;\r\n        for (let i = 0; i < 5; i++) {\r\n            for (let j = 24; j >= 0; j -= 8) {\r\n                digest[n] = (this.chain_[i] >> j) & 255;\r\n                ++n;\r\n            }\r\n        }\r\n        return digest;\r\n    }\r\n}\n\n/**\r\n * Helper to make a Subscribe function (just like Promise helps make a\r\n * Thenable).\r\n *\r\n * @param executor Function which can make calls to a single Observer\r\n *     as a proxy.\r\n * @param onNoObservers Callback when count of Observers goes to zero.\r\n */\r\nfunction createSubscribe(executor, onNoObservers) {\r\n    const proxy = new ObserverProxy(executor, onNoObservers);\r\n    return proxy.subscribe.bind(proxy);\r\n}\r\n/**\r\n * Implement fan-out for any number of Observers attached via a subscribe\r\n * function.\r\n */\r\nclass ObserverProxy {\r\n    /**\r\n     * @param executor Function which can make calls to a single Observer\r\n     *     as a proxy.\r\n     * @param onNoObservers Callback when count of Observers goes to zero.\r\n     */\r\n    constructor(executor, onNoObservers) {\r\n        this.observers = [];\r\n        this.unsubscribes = [];\r\n        this.observerCount = 0;\r\n        // Micro-task scheduling by calling task.then().\r\n        this.task = Promise.resolve();\r\n        this.finalized = false;\r\n        this.onNoObservers = onNoObservers;\r\n        // Call the executor asynchronously so subscribers that are called\r\n        // synchronously after the creation of the subscribe function\r\n        // can still receive the very first value generated in the executor.\r\n        this.task\r\n            .then(() => {\r\n            executor(this);\r\n        })\r\n            .catch(e => {\r\n            this.error(e);\r\n        });\r\n    }\r\n    next(value) {\r\n        this.forEachObserver((observer) => {\r\n            observer.next(value);\r\n        });\r\n    }\r\n    error(error) {\r\n        this.forEachObserver((observer) => {\r\n            observer.error(error);\r\n        });\r\n        this.close(error);\r\n    }\r\n    complete() {\r\n        this.forEachObserver((observer) => {\r\n            observer.complete();\r\n        });\r\n        this.close();\r\n    }\r\n    /**\r\n     * Subscribe function that can be used to add an Observer to the fan-out list.\r\n     *\r\n     * - We require that no event is sent to a subscriber sychronously to their\r\n     *   call to subscribe().\r\n     */\r\n    subscribe(nextOrObserver, error, complete) {\r\n        let observer;\r\n        if (nextOrObserver === undefined &&\r\n            error === undefined &&\r\n            complete === undefined) {\r\n            throw new Error('Missing Observer.');\r\n        }\r\n        // Assemble an Observer object when passed as callback functions.\r\n        if (implementsAnyMethods(nextOrObserver, [\r\n            'next',\r\n            'error',\r\n            'complete'\r\n        ])) {\r\n            observer = nextOrObserver;\r\n        }\r\n        else {\r\n            observer = {\r\n                next: nextOrObserver,\r\n                error,\r\n                complete\r\n            };\r\n        }\r\n        if (observer.next === undefined) {\r\n            observer.next = noop;\r\n        }\r\n        if (observer.error === undefined) {\r\n            observer.error = noop;\r\n        }\r\n        if (observer.complete === undefined) {\r\n            observer.complete = noop;\r\n        }\r\n        const unsub = this.unsubscribeOne.bind(this, this.observers.length);\r\n        // Attempt to subscribe to a terminated Observable - we\r\n        // just respond to the Observer with the final error or complete\r\n        // event.\r\n        if (this.finalized) {\r\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n            this.task.then(() => {\r\n                try {\r\n                    if (this.finalError) {\r\n                        observer.error(this.finalError);\r\n                    }\r\n                    else {\r\n                        observer.complete();\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // nothing\r\n                }\r\n                return;\r\n            });\r\n        }\r\n        this.observers.push(observer);\r\n        return unsub;\r\n    }\r\n    // Unsubscribe is synchronous - we guarantee that no events are sent to\r\n    // any unsubscribed Observer.\r\n    unsubscribeOne(i) {\r\n        if (this.observers === undefined || this.observers[i] === undefined) {\r\n            return;\r\n        }\r\n        delete this.observers[i];\r\n        this.observerCount -= 1;\r\n        if (this.observerCount === 0 && this.onNoObservers !== undefined) {\r\n            this.onNoObservers(this);\r\n        }\r\n    }\r\n    forEachObserver(fn) {\r\n        if (this.finalized) {\r\n            // Already closed by previous event....just eat the additional values.\r\n            return;\r\n        }\r\n        // Since sendOne calls asynchronously - there is no chance that\r\n        // this.observers will become undefined.\r\n        for (let i = 0; i < this.observers.length; i++) {\r\n            this.sendOne(i, fn);\r\n        }\r\n    }\r\n    // Call the Observer via one of it's callback function. We are careful to\r\n    // confirm that the observe has not been unsubscribed since this asynchronous\r\n    // function had been queued.\r\n    sendOne(i, fn) {\r\n        // Execute the callback asynchronously\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.task.then(() => {\r\n            if (this.observers !== undefined && this.observers[i] !== undefined) {\r\n                try {\r\n                    fn(this.observers[i]);\r\n                }\r\n                catch (e) {\r\n                    // Ignore exceptions raised in Observers or missing methods of an\r\n                    // Observer.\r\n                    // Log error to console. b/31404806\r\n                    if (typeof console !== 'undefined' && console.error) {\r\n                        console.error(e);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    close(err) {\r\n        if (this.finalized) {\r\n            return;\r\n        }\r\n        this.finalized = true;\r\n        if (err !== undefined) {\r\n            this.finalError = err;\r\n        }\r\n        // Proxy is no longer needed - garbage collect references\r\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\r\n        this.task.then(() => {\r\n            this.observers = undefined;\r\n            this.onNoObservers = undefined;\r\n        });\r\n    }\r\n}\r\n/** Turn synchronous function into one called asynchronously. */\r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\nfunction async(fn, onError) {\r\n    return (...args) => {\r\n        Promise.resolve(true)\r\n            .then(() => {\r\n            fn(...args);\r\n        })\r\n            .catch((error) => {\r\n            if (onError) {\r\n                onError(error);\r\n            }\r\n        });\r\n    };\r\n}\r\n/**\r\n * Return true if the object passed in implements any of the named methods.\r\n */\r\nfunction implementsAnyMethods(obj, methods) {\r\n    if (typeof obj !== 'object' || obj === null) {\r\n        return false;\r\n    }\r\n    for (const method of methods) {\r\n        if (method in obj && typeof obj[method] === 'function') {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nfunction noop() {\r\n    // do nothing\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Check to make sure the appropriate number of arguments are provided for a public function.\r\n * Throws an error if it fails.\r\n *\r\n * @param fnName The function name\r\n * @param minCount The minimum number of arguments to allow for the function call\r\n * @param maxCount The maximum number of argument to allow for the function call\r\n * @param argCount The actual number of arguments provided.\r\n */\r\nconst validateArgCount = function (fnName, minCount, maxCount, argCount) {\r\n    let argError;\r\n    if (argCount < minCount) {\r\n        argError = 'at least ' + minCount;\r\n    }\r\n    else if (argCount > maxCount) {\r\n        argError = maxCount === 0 ? 'none' : 'no more than ' + maxCount;\r\n    }\r\n    if (argError) {\r\n        const error = fnName +\r\n            ' failed: Was called with ' +\r\n            argCount +\r\n            (argCount === 1 ? ' argument.' : ' arguments.') +\r\n            ' Expects ' +\r\n            argError +\r\n            '.';\r\n        throw new Error(error);\r\n    }\r\n};\r\n/**\r\n * Generates a string to prefix an error message about failed argument validation\r\n *\r\n * @param fnName The function name\r\n * @param argName The name of the argument\r\n * @return The prefix to add to the error thrown for validation.\r\n */\r\nfunction errorPrefix(fnName, argName) {\r\n    return `${fnName} failed: ${argName} argument `;\r\n}\r\n/**\r\n * @param fnName\r\n * @param argumentNumber\r\n * @param namespace\r\n * @param optional\r\n */\r\nfunction validateNamespace(fnName, namespace, optional) {\r\n    if (optional && !namespace) {\r\n        return;\r\n    }\r\n    if (typeof namespace !== 'string') {\r\n        //TODO: I should do more validation here. We only allow certain chars in namespaces.\r\n        throw new Error(errorPrefix(fnName, 'namespace') + 'must be a valid firebase namespace.');\r\n    }\r\n}\r\nfunction validateCallback(fnName, argumentName, \r\n// eslint-disable-next-line @typescript-eslint/ban-types\r\ncallback, optional) {\r\n    if (optional && !callback) {\r\n        return;\r\n    }\r\n    if (typeof callback !== 'function') {\r\n        throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid function.');\r\n    }\r\n}\r\nfunction validateContextObject(fnName, argumentName, context, optional) {\r\n    if (optional && !context) {\r\n        return;\r\n    }\r\n    if (typeof context !== 'object' || context === null) {\r\n        throw new Error(errorPrefix(fnName, argumentName) + 'must be a valid context object.');\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n// Code originally came from goog.crypt.stringToUtf8ByteArray, but for some reason they\r\n// automatically replaced '\\r\\n' with '\\n', and they didn't handle surrogate pairs,\r\n// so it's been modified.\r\n// Note that not all Unicode characters appear as single characters in JavaScript strings.\r\n// fromCharCode returns the UTF-16 encoding of a character - so some Unicode characters\r\n// use 2 characters in Javascript.  All 4-byte UTF-8 characters begin with a first\r\n// character in the range 0xD800 - 0xDBFF (the first character of a so-called surrogate\r\n// pair).\r\n// See http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.3\r\n/**\r\n * @param {string} str\r\n * @return {Array}\r\n */\r\nconst stringToByteArray = function (str) {\r\n    const out = [];\r\n    let p = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        let c = str.charCodeAt(i);\r\n        // Is this the lead surrogate in a surrogate pair?\r\n        if (c >= 0xd800 && c <= 0xdbff) {\r\n            const high = c - 0xd800; // the high 10 bits.\r\n            i++;\r\n            assert(i < str.length, 'Surrogate pair missing trail surrogate.');\r\n            const low = str.charCodeAt(i) - 0xdc00; // the low 10 bits.\r\n            c = 0x10000 + (high << 10) + low;\r\n        }\r\n        if (c < 128) {\r\n            out[p++] = c;\r\n        }\r\n        else if (c < 2048) {\r\n            out[p++] = (c >> 6) | 192;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else if (c < 65536) {\r\n            out[p++] = (c >> 12) | 224;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n        else {\r\n            out[p++] = (c >> 18) | 240;\r\n            out[p++] = ((c >> 12) & 63) | 128;\r\n            out[p++] = ((c >> 6) & 63) | 128;\r\n            out[p++] = (c & 63) | 128;\r\n        }\r\n    }\r\n    return out;\r\n};\r\n/**\r\n * Calculate length without actually converting; useful for doing cheaper validation.\r\n * @param {string} str\r\n * @return {number}\r\n */\r\nconst stringLength = function (str) {\r\n    let p = 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n        const c = str.charCodeAt(i);\r\n        if (c < 128) {\r\n            p++;\r\n        }\r\n        else if (c < 2048) {\r\n            p += 2;\r\n        }\r\n        else if (c >= 0xd800 && c <= 0xdbff) {\r\n            // Lead surrogate of a surrogate pair.  The pair together will take 4 bytes to represent.\r\n            p += 4;\r\n            i++; // skip trail surrogate.\r\n        }\r\n        else {\r\n            p += 3;\r\n        }\r\n    }\r\n    return p;\r\n};\n\n/**\r\n * @license\r\n * Copyright 2022 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Copied from https://stackoverflow.com/a/2117523\r\n * Generates a new uuid.\r\n * @public\r\n */\r\nconst uuidv4 = function () {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n        const r = (Math.random() * 16) | 0, v = c === 'x' ? r : (r & 0x3) | 0x8;\r\n        return v.toString(16);\r\n    });\r\n};\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * The amount of milliseconds to exponentially increase.\r\n */\r\nconst DEFAULT_INTERVAL_MILLIS = 1000;\r\n/**\r\n * The factor to backoff by.\r\n * Should be a number greater than 1.\r\n */\r\nconst DEFAULT_BACKOFF_FACTOR = 2;\r\n/**\r\n * The maximum milliseconds to increase to.\r\n *\r\n * <p>Visible for testing\r\n */\r\nconst MAX_VALUE_MILLIS = 4 * 60 * 60 * 1000; // Four hours, like iOS and Android.\r\n/**\r\n * The percentage of backoff time to randomize by.\r\n * See\r\n * http://go/safe-client-behavior#step-1-determine-the-appropriate-retry-interval-to-handle-spike-traffic\r\n * for context.\r\n *\r\n * <p>Visible for testing\r\n */\r\nconst RANDOM_FACTOR = 0.5;\r\n/**\r\n * Based on the backoff method from\r\n * https://github.com/google/closure-library/blob/master/closure/goog/math/exponentialbackoff.js.\r\n * Extracted here so we don't need to pass metadata and a stateful ExponentialBackoff object around.\r\n */\r\nfunction calculateBackoffMillis(backoffCount, intervalMillis = DEFAULT_INTERVAL_MILLIS, backoffFactor = DEFAULT_BACKOFF_FACTOR) {\r\n    // Calculates an exponentially increasing value.\r\n    // Deviation: calculates value from count and a constant interval, so we only need to save value\r\n    // and count to restore state.\r\n    const currBaseValue = intervalMillis * Math.pow(backoffFactor, backoffCount);\r\n    // A random \"fuzz\" to avoid waves of retries.\r\n    // Deviation: randomFactor is required.\r\n    const randomWait = Math.round(\r\n    // A fraction of the backoff value to add/subtract.\r\n    // Deviation: changes multiplication order to improve readability.\r\n    RANDOM_FACTOR *\r\n        currBaseValue *\r\n        // A random float (rounded to int by Math.round above) in the range [-1, 1]. Determines\r\n        // if we add or subtract.\r\n        (Math.random() - 0.5) *\r\n        2);\r\n    // Limits backoff to max to avoid effectively permanent backoff.\r\n    return Math.min(MAX_VALUE_MILLIS, currBaseValue + randomWait);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Provide English ordinal letters after a number\r\n */\r\nfunction ordinal(i) {\r\n    if (!Number.isFinite(i)) {\r\n        return `${i}`;\r\n    }\r\n    return i + indicator(i);\r\n}\r\nfunction indicator(i) {\r\n    i = Math.abs(i);\r\n    const cent = i % 100;\r\n    if (cent >= 10 && cent <= 20) {\r\n        return 'th';\r\n    }\r\n    const dec = i % 10;\r\n    if (dec === 1) {\r\n        return 'st';\r\n    }\r\n    if (dec === 2) {\r\n        return 'nd';\r\n    }\r\n    if (dec === 3) {\r\n        return 'rd';\r\n    }\r\n    return 'th';\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getModularInstance(service) {\r\n    if (service && service._delegate) {\r\n        return service._delegate;\r\n    }\r\n    else {\r\n        return service;\r\n    }\r\n}\n\nexport { CONSTANTS, DecodeBase64StringError, Deferred, ErrorFactory, FirebaseError, MAX_VALUE_MILLIS, RANDOM_FACTOR, Sha1, areCookiesEnabled, assert, assertionError, async, base64, base64Decode, base64Encode, base64urlEncodeWithoutPadding, calculateBackoffMillis, contains, createMockUserToken, createSubscribe, decode, deepCopy, deepEqual, deepExtend, errorPrefix, extractQuerystring, getDefaultAppConfig, getDefaultEmulatorHost, getDefaultEmulatorHostnameAndPort, getDefaults, getExperimentalSetting, getGlobal, getModularInstance, getUA, isAdmin, isBrowser, isBrowserExtension, isElectron, isEmpty, isIE, isIndexedDBAvailable, isMobileCordova, isNode, isNodeSdk, isReactNative, isSafari, isUWP, isValidFormat, isValidTimestamp, issuedAtTime, jsonEval, map, ordinal, promiseWithTimeout, querystring, querystringDecode, safeGet, stringLength, stringToByteArray, stringify, uuidv4, validateArgCount, validateCallback, validateContextObject, validateIndexedDBOpenable, validateNamespace };\n//# sourceMappingURL=index.esm2017.js.map\n","import { Deferred } from '@firebase/util';\n\n/**\r\n * Component for service name T, e.g. `auth`, `auth-internal`\r\n */\r\nclass Component {\r\n    /**\r\n     *\r\n     * @param name The public service name, e.g. app, auth, firestore, database\r\n     * @param instanceFactory Service factory responsible for creating the public interface\r\n     * @param type whether the service provided by the component is public or private\r\n     */\r\n    constructor(name, instanceFactory, type) {\r\n        this.name = name;\r\n        this.instanceFactory = instanceFactory;\r\n        this.type = type;\r\n        this.multipleInstances = false;\r\n        /**\r\n         * Properties to be added to the service namespace\r\n         */\r\n        this.serviceProps = {};\r\n        this.instantiationMode = \"LAZY\" /* InstantiationMode.LAZY */;\r\n        this.onInstanceCreated = null;\r\n    }\r\n    setInstantiationMode(mode) {\r\n        this.instantiationMode = mode;\r\n        return this;\r\n    }\r\n    setMultipleInstances(multipleInstances) {\r\n        this.multipleInstances = multipleInstances;\r\n        return this;\r\n    }\r\n    setServiceProps(props) {\r\n        this.serviceProps = props;\r\n        return this;\r\n    }\r\n    setInstanceCreatedCallback(callback) {\r\n        this.onInstanceCreated = callback;\r\n        return this;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DEFAULT_ENTRY_NAME = '[DEFAULT]';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Provider for instance for service name T, e.g. 'auth', 'auth-internal'\r\n * NameServiceMapping[T] is an alias for the type of the instance\r\n */\r\nclass Provider {\r\n    constructor(name, container) {\r\n        this.name = name;\r\n        this.container = container;\r\n        this.component = null;\r\n        this.instances = new Map();\r\n        this.instancesDeferred = new Map();\r\n        this.instancesOptions = new Map();\r\n        this.onInitCallbacks = new Map();\r\n    }\r\n    /**\r\n     * @param identifier A provider can provide mulitple instances of a service\r\n     * if this.component.multipleInstances is true.\r\n     */\r\n    get(identifier) {\r\n        // if multipleInstances is not supported, use the default name\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\r\n        if (!this.instancesDeferred.has(normalizedIdentifier)) {\r\n            const deferred = new Deferred();\r\n            this.instancesDeferred.set(normalizedIdentifier, deferred);\r\n            if (this.isInitialized(normalizedIdentifier) ||\r\n                this.shouldAutoInitialize()) {\r\n                // initialize the service if it can be auto-initialized\r\n                try {\r\n                    const instance = this.getOrInitializeService({\r\n                        instanceIdentifier: normalizedIdentifier\r\n                    });\r\n                    if (instance) {\r\n                        deferred.resolve(instance);\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    // when the instance factory throws an exception during get(), it should not cause\r\n                    // a fatal error. We just return the unresolved promise in this case.\r\n                }\r\n            }\r\n        }\r\n        return this.instancesDeferred.get(normalizedIdentifier).promise;\r\n    }\r\n    getImmediate(options) {\r\n        var _a;\r\n        // if multipleInstances is not supported, use the default name\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(options === null || options === void 0 ? void 0 : options.identifier);\r\n        const optional = (_a = options === null || options === void 0 ? void 0 : options.optional) !== null && _a !== void 0 ? _a : false;\r\n        if (this.isInitialized(normalizedIdentifier) ||\r\n            this.shouldAutoInitialize()) {\r\n            try {\r\n                return this.getOrInitializeService({\r\n                    instanceIdentifier: normalizedIdentifier\r\n                });\r\n            }\r\n            catch (e) {\r\n                if (optional) {\r\n                    return null;\r\n                }\r\n                else {\r\n                    throw e;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            // In case a component is not initialized and should/can not be auto-initialized at the moment, return null if the optional flag is set, or throw\r\n            if (optional) {\r\n                return null;\r\n            }\r\n            else {\r\n                throw Error(`Service ${this.name} is not available`);\r\n            }\r\n        }\r\n    }\r\n    getComponent() {\r\n        return this.component;\r\n    }\r\n    setComponent(component) {\r\n        if (component.name !== this.name) {\r\n            throw Error(`Mismatching Component ${component.name} for Provider ${this.name}.`);\r\n        }\r\n        if (this.component) {\r\n            throw Error(`Component for ${this.name} has already been provided`);\r\n        }\r\n        this.component = component;\r\n        // return early without attempting to initialize the component if the component requires explicit initialization (calling `Provider.initialize()`)\r\n        if (!this.shouldAutoInitialize()) {\r\n            return;\r\n        }\r\n        // if the service is eager, initialize the default instance\r\n        if (isComponentEager(component)) {\r\n            try {\r\n                this.getOrInitializeService({ instanceIdentifier: DEFAULT_ENTRY_NAME });\r\n            }\r\n            catch (e) {\r\n                // when the instance factory for an eager Component throws an exception during the eager\r\n                // initialization, it should not cause a fatal error.\r\n                // TODO: Investigate if we need to make it configurable, because some component may want to cause\r\n                // a fatal error in this case?\r\n            }\r\n        }\r\n        // Create service instances for the pending promises and resolve them\r\n        // NOTE: if this.multipleInstances is false, only the default instance will be created\r\n        // and all promises with resolve with it regardless of the identifier.\r\n        for (const [instanceIdentifier, instanceDeferred] of this.instancesDeferred.entries()) {\r\n            const normalizedIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);\r\n            try {\r\n                // `getOrInitializeService()` should always return a valid instance since a component is guaranteed. use ! to make typescript happy.\r\n                const instance = this.getOrInitializeService({\r\n                    instanceIdentifier: normalizedIdentifier\r\n                });\r\n                instanceDeferred.resolve(instance);\r\n            }\r\n            catch (e) {\r\n                // when the instance factory throws an exception, it should not cause\r\n                // a fatal error. We just leave the promise unresolved.\r\n            }\r\n        }\r\n    }\r\n    clearInstance(identifier = DEFAULT_ENTRY_NAME) {\r\n        this.instancesDeferred.delete(identifier);\r\n        this.instancesOptions.delete(identifier);\r\n        this.instances.delete(identifier);\r\n    }\r\n    // app.delete() will call this method on every provider to delete the services\r\n    // TODO: should we mark the provider as deleted?\r\n    async delete() {\r\n        const services = Array.from(this.instances.values());\r\n        await Promise.all([\r\n            ...services\r\n                .filter(service => 'INTERNAL' in service) // legacy services\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                .map(service => service.INTERNAL.delete()),\r\n            ...services\r\n                .filter(service => '_delete' in service) // modularized services\r\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n                .map(service => service._delete())\r\n        ]);\r\n    }\r\n    isComponentSet() {\r\n        return this.component != null;\r\n    }\r\n    isInitialized(identifier = DEFAULT_ENTRY_NAME) {\r\n        return this.instances.has(identifier);\r\n    }\r\n    getOptions(identifier = DEFAULT_ENTRY_NAME) {\r\n        return this.instancesOptions.get(identifier) || {};\r\n    }\r\n    initialize(opts = {}) {\r\n        const { options = {} } = opts;\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(opts.instanceIdentifier);\r\n        if (this.isInitialized(normalizedIdentifier)) {\r\n            throw Error(`${this.name}(${normalizedIdentifier}) has already been initialized`);\r\n        }\r\n        if (!this.isComponentSet()) {\r\n            throw Error(`Component ${this.name} has not been registered yet`);\r\n        }\r\n        const instance = this.getOrInitializeService({\r\n            instanceIdentifier: normalizedIdentifier,\r\n            options\r\n        });\r\n        // resolve any pending promise waiting for the service instance\r\n        for (const [instanceIdentifier, instanceDeferred] of this.instancesDeferred.entries()) {\r\n            const normalizedDeferredIdentifier = this.normalizeInstanceIdentifier(instanceIdentifier);\r\n            if (normalizedIdentifier === normalizedDeferredIdentifier) {\r\n                instanceDeferred.resolve(instance);\r\n            }\r\n        }\r\n        return instance;\r\n    }\r\n    /**\r\n     *\r\n     * @param callback - a function that will be invoked  after the provider has been initialized by calling provider.initialize().\r\n     * The function is invoked SYNCHRONOUSLY, so it should not execute any longrunning tasks in order to not block the program.\r\n     *\r\n     * @param identifier An optional instance identifier\r\n     * @returns a function to unregister the callback\r\n     */\r\n    onInit(callback, identifier) {\r\n        var _a;\r\n        const normalizedIdentifier = this.normalizeInstanceIdentifier(identifier);\r\n        const existingCallbacks = (_a = this.onInitCallbacks.get(normalizedIdentifier)) !== null && _a !== void 0 ? _a : new Set();\r\n        existingCallbacks.add(callback);\r\n        this.onInitCallbacks.set(normalizedIdentifier, existingCallbacks);\r\n        const existingInstance = this.instances.get(normalizedIdentifier);\r\n        if (existingInstance) {\r\n            callback(existingInstance, normalizedIdentifier);\r\n        }\r\n        return () => {\r\n            existingCallbacks.delete(callback);\r\n        };\r\n    }\r\n    /**\r\n     * Invoke onInit callbacks synchronously\r\n     * @param instance the service instance`\r\n     */\r\n    invokeOnInitCallbacks(instance, identifier) {\r\n        const callbacks = this.onInitCallbacks.get(identifier);\r\n        if (!callbacks) {\r\n            return;\r\n        }\r\n        for (const callback of callbacks) {\r\n            try {\r\n                callback(instance, identifier);\r\n            }\r\n            catch (_a) {\r\n                // ignore errors in the onInit callback\r\n            }\r\n        }\r\n    }\r\n    getOrInitializeService({ instanceIdentifier, options = {} }) {\r\n        let instance = this.instances.get(instanceIdentifier);\r\n        if (!instance && this.component) {\r\n            instance = this.component.instanceFactory(this.container, {\r\n                instanceIdentifier: normalizeIdentifierForFactory(instanceIdentifier),\r\n                options\r\n            });\r\n            this.instances.set(instanceIdentifier, instance);\r\n            this.instancesOptions.set(instanceIdentifier, options);\r\n            /**\r\n             * Invoke onInit listeners.\r\n             * Note this.component.onInstanceCreated is different, which is used by the component creator,\r\n             * while onInit listeners are registered by consumers of the provider.\r\n             */\r\n            this.invokeOnInitCallbacks(instance, instanceIdentifier);\r\n            /**\r\n             * Order is important\r\n             * onInstanceCreated() should be called after this.instances.set(instanceIdentifier, instance); which\r\n             * makes `isInitialized()` return true.\r\n             */\r\n            if (this.component.onInstanceCreated) {\r\n                try {\r\n                    this.component.onInstanceCreated(this.container, instanceIdentifier, instance);\r\n                }\r\n                catch (_a) {\r\n                    // ignore errors in the onInstanceCreatedCallback\r\n                }\r\n            }\r\n        }\r\n        return instance || null;\r\n    }\r\n    normalizeInstanceIdentifier(identifier = DEFAULT_ENTRY_NAME) {\r\n        if (this.component) {\r\n            return this.component.multipleInstances ? identifier : DEFAULT_ENTRY_NAME;\r\n        }\r\n        else {\r\n            return identifier; // assume multiple instances are supported before the component is provided.\r\n        }\r\n    }\r\n    shouldAutoInitialize() {\r\n        return (!!this.component &&\r\n            this.component.instantiationMode !== \"EXPLICIT\" /* InstantiationMode.EXPLICIT */);\r\n    }\r\n}\r\n// undefined should be passed to the service factory for the default instance\r\nfunction normalizeIdentifierForFactory(identifier) {\r\n    return identifier === DEFAULT_ENTRY_NAME ? undefined : identifier;\r\n}\r\nfunction isComponentEager(component) {\r\n    return component.instantiationMode === \"EAGER\" /* InstantiationMode.EAGER */;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * ComponentContainer that provides Providers for service name T, e.g. `auth`, `auth-internal`\r\n */\r\nclass ComponentContainer {\r\n    constructor(name) {\r\n        this.name = name;\r\n        this.providers = new Map();\r\n    }\r\n    /**\r\n     *\r\n     * @param component Component being added\r\n     * @param overwrite When a component with the same name has already been registered,\r\n     * if overwrite is true: overwrite the existing component with the new component and create a new\r\n     * provider with the new component. It can be useful in tests where you want to use different mocks\r\n     * for different tests.\r\n     * if overwrite is false: throw an exception\r\n     */\r\n    addComponent(component) {\r\n        const provider = this.getProvider(component.name);\r\n        if (provider.isComponentSet()) {\r\n            throw new Error(`Component ${component.name} has already been registered with ${this.name}`);\r\n        }\r\n        provider.setComponent(component);\r\n    }\r\n    addOrOverwriteComponent(component) {\r\n        const provider = this.getProvider(component.name);\r\n        if (provider.isComponentSet()) {\r\n            // delete the existing provider from the container, so we can register the new component\r\n            this.providers.delete(component.name);\r\n        }\r\n        this.addComponent(component);\r\n    }\r\n    /**\r\n     * getProvider provides a type safe interface where it can only be called with a field name\r\n     * present in NameServiceMapping interface.\r\n     *\r\n     * Firebase SDKs providing services should extend NameServiceMapping interface to register\r\n     * themselves.\r\n     */\r\n    getProvider(name) {\r\n        if (this.providers.has(name)) {\r\n            return this.providers.get(name);\r\n        }\r\n        // create a Provider for a service that hasn't registered with Firebase\r\n        const provider = new Provider(name, this);\r\n        this.providers.set(name, provider);\r\n        return provider;\r\n    }\r\n    getProviders() {\r\n        return Array.from(this.providers.values());\r\n    }\r\n}\n\nexport { Component, ComponentContainer, Provider };\n//# sourceMappingURL=index.esm2017.js.map\n","/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * A container for all of the Logger instances\r\n */\r\nconst instances = [];\r\n/**\r\n * The JS SDK supports 5 log levels and also allows a user the ability to\r\n * silence the logs altogether.\r\n *\r\n * The order is a follows:\r\n * DEBUG < VERBOSE < INFO < WARN < ERROR\r\n *\r\n * All of the log types above the current log level will be captured (i.e. if\r\n * you set the log level to `INFO`, errors will still be logged, but `DEBUG` and\r\n * `VERBOSE` logs will not)\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"DEBUG\"] = 0] = \"DEBUG\";\r\n    LogLevel[LogLevel[\"VERBOSE\"] = 1] = \"VERBOSE\";\r\n    LogLevel[LogLevel[\"INFO\"] = 2] = \"INFO\";\r\n    LogLevel[LogLevel[\"WARN\"] = 3] = \"WARN\";\r\n    LogLevel[LogLevel[\"ERROR\"] = 4] = \"ERROR\";\r\n    LogLevel[LogLevel[\"SILENT\"] = 5] = \"SILENT\";\r\n})(LogLevel || (LogLevel = {}));\r\nconst levelStringToEnum = {\r\n    'debug': LogLevel.DEBUG,\r\n    'verbose': LogLevel.VERBOSE,\r\n    'info': LogLevel.INFO,\r\n    'warn': LogLevel.WARN,\r\n    'error': LogLevel.ERROR,\r\n    'silent': LogLevel.SILENT\r\n};\r\n/**\r\n * The default log level\r\n */\r\nconst defaultLogLevel = LogLevel.INFO;\r\n/**\r\n * By default, `console.debug` is not displayed in the developer console (in\r\n * chrome). To avoid forcing users to have to opt-in to these logs twice\r\n * (i.e. once for firebase, and once in the console), we are sending `DEBUG`\r\n * logs to the `console.log` function.\r\n */\r\nconst ConsoleMethod = {\r\n    [LogLevel.DEBUG]: 'log',\r\n    [LogLevel.VERBOSE]: 'log',\r\n    [LogLevel.INFO]: 'info',\r\n    [LogLevel.WARN]: 'warn',\r\n    [LogLevel.ERROR]: 'error'\r\n};\r\n/**\r\n * The default log handler will forward DEBUG, VERBOSE, INFO, WARN, and ERROR\r\n * messages on to their corresponding console counterparts (if the log method\r\n * is supported by the current log level)\r\n */\r\nconst defaultLogHandler = (instance, logType, ...args) => {\r\n    if (logType < instance.logLevel) {\r\n        return;\r\n    }\r\n    const now = new Date().toISOString();\r\n    const method = ConsoleMethod[logType];\r\n    if (method) {\r\n        console[method](`[${now}]  ${instance.name}:`, ...args);\r\n    }\r\n    else {\r\n        throw new Error(`Attempted to log a message with an invalid logType (value: ${logType})`);\r\n    }\r\n};\r\nclass Logger {\r\n    /**\r\n     * Gives you an instance of a Logger to capture messages according to\r\n     * Firebase's logging scheme.\r\n     *\r\n     * @param name The name that the logs will be associated with\r\n     */\r\n    constructor(name) {\r\n        this.name = name;\r\n        /**\r\n         * The log level of the given Logger instance.\r\n         */\r\n        this._logLevel = defaultLogLevel;\r\n        /**\r\n         * The main (internal) log handler for the Logger instance.\r\n         * Can be set to a new function in internal package code but not by user.\r\n         */\r\n        this._logHandler = defaultLogHandler;\r\n        /**\r\n         * The optional, additional, user-defined log handler for the Logger instance.\r\n         */\r\n        this._userLogHandler = null;\r\n        /**\r\n         * Capture the current instance for later use\r\n         */\r\n        instances.push(this);\r\n    }\r\n    get logLevel() {\r\n        return this._logLevel;\r\n    }\r\n    set logLevel(val) {\r\n        if (!(val in LogLevel)) {\r\n            throw new TypeError(`Invalid value \"${val}\" assigned to \\`logLevel\\``);\r\n        }\r\n        this._logLevel = val;\r\n    }\r\n    // Workaround for setter/getter having to be the same type.\r\n    setLogLevel(val) {\r\n        this._logLevel = typeof val === 'string' ? levelStringToEnum[val] : val;\r\n    }\r\n    get logHandler() {\r\n        return this._logHandler;\r\n    }\r\n    set logHandler(val) {\r\n        if (typeof val !== 'function') {\r\n            throw new TypeError('Value assigned to `logHandler` must be a function');\r\n        }\r\n        this._logHandler = val;\r\n    }\r\n    get userLogHandler() {\r\n        return this._userLogHandler;\r\n    }\r\n    set userLogHandler(val) {\r\n        this._userLogHandler = val;\r\n    }\r\n    /**\r\n     * The functions below are all based on the `console` interface\r\n     */\r\n    debug(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.DEBUG, ...args);\r\n        this._logHandler(this, LogLevel.DEBUG, ...args);\r\n    }\r\n    log(...args) {\r\n        this._userLogHandler &&\r\n            this._userLogHandler(this, LogLevel.VERBOSE, ...args);\r\n        this._logHandler(this, LogLevel.VERBOSE, ...args);\r\n    }\r\n    info(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.INFO, ...args);\r\n        this._logHandler(this, LogLevel.INFO, ...args);\r\n    }\r\n    warn(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.WARN, ...args);\r\n        this._logHandler(this, LogLevel.WARN, ...args);\r\n    }\r\n    error(...args) {\r\n        this._userLogHandler && this._userLogHandler(this, LogLevel.ERROR, ...args);\r\n        this._logHandler(this, LogLevel.ERROR, ...args);\r\n    }\r\n}\r\nfunction setLogLevel(level) {\r\n    instances.forEach(inst => {\r\n        inst.setLogLevel(level);\r\n    });\r\n}\r\nfunction setUserLogHandler(logCallback, options) {\r\n    for (const instance of instances) {\r\n        let customLogLevel = null;\r\n        if (options && options.level) {\r\n            customLogLevel = levelStringToEnum[options.level];\r\n        }\r\n        if (logCallback === null) {\r\n            instance.userLogHandler = null;\r\n        }\r\n        else {\r\n            instance.userLogHandler = (instance, level, ...args) => {\r\n                const message = args\r\n                    .map(arg => {\r\n                    if (arg == null) {\r\n                        return null;\r\n                    }\r\n                    else if (typeof arg === 'string') {\r\n                        return arg;\r\n                    }\r\n                    else if (typeof arg === 'number' || typeof arg === 'boolean') {\r\n                        return arg.toString();\r\n                    }\r\n                    else if (arg instanceof Error) {\r\n                        return arg.message;\r\n                    }\r\n                    else {\r\n                        try {\r\n                            return JSON.stringify(arg);\r\n                        }\r\n                        catch (ignored) {\r\n                            return null;\r\n                        }\r\n                    }\r\n                })\r\n                    .filter(arg => arg)\r\n                    .join(' ');\r\n                if (level >= (customLogLevel !== null && customLogLevel !== void 0 ? customLogLevel : instance.logLevel)) {\r\n                    logCallback({\r\n                        level: LogLevel[level].toLowerCase(),\r\n                        message,\r\n                        args,\r\n                        type: instance.name\r\n                    });\r\n                }\r\n            };\r\n        }\r\n    }\r\n}\n\nexport { LogLevel, Logger, setLogLevel, setUserLogHandler };\n//# sourceMappingURL=index.esm2017.js.map\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction), event);\n        });\n    }\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event.newVersion, event));\n    }\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking) {\n            db.addEventListener('versionchange', (event) => blocking(event.oldVersion, event.newVersion, event));\n        }\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked) {\n        request.addEventListener('blocked', (event) => blocked(\n        // Casting due to https://github.com/microsoft/TypeScript-DOM-lib-generator/pull/1405\n        event.oldVersion, event));\n    }\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","import { Component, ComponentContainer } from '@firebase/component';\nimport { Logger, setUserLogHandler, setLogLevel as setLogLevel$1 } from '@firebase/logger';\nimport { ErrorFactory, getDefaultAppConfig, deepEqual, FirebaseError, base64urlEncodeWithoutPadding, isIndexedDBAvailable, validateIndexedDBOpenable } from '@firebase/util';\nexport { FirebaseError } from '@firebase/util';\nimport { openDB } from 'idb';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nclass PlatformLoggerServiceImpl {\r\n    constructor(container) {\r\n        this.container = container;\r\n    }\r\n    // In initial implementation, this will be called by installations on\r\n    // auth token refresh, and installations will send this string.\r\n    getPlatformInfoString() {\r\n        const providers = this.container.getProviders();\r\n        // Loop through providers and get library/version pairs from any that are\r\n        // version components.\r\n        return providers\r\n            .map(provider => {\r\n            if (isVersionServiceProvider(provider)) {\r\n                const service = provider.getImmediate();\r\n                return `${service.library}/${service.version}`;\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        })\r\n            .filter(logString => logString)\r\n            .join(' ');\r\n    }\r\n}\r\n/**\r\n *\r\n * @param provider check if this provider provides a VersionService\r\n *\r\n * NOTE: Using Provider<'app-version'> is a hack to indicate that the provider\r\n * provides VersionService. The provider is not necessarily a 'app-version'\r\n * provider.\r\n */\r\nfunction isVersionServiceProvider(provider) {\r\n    const component = provider.getComponent();\r\n    return (component === null || component === void 0 ? void 0 : component.type) === \"VERSION\" /* ComponentType.VERSION */;\r\n}\n\nconst name$o = \"@firebase/app\";\nconst version$1 = \"0.9.18\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst logger = new Logger('@firebase/app');\n\nconst name$n = \"@firebase/app-compat\";\n\nconst name$m = \"@firebase/analytics-compat\";\n\nconst name$l = \"@firebase/analytics\";\n\nconst name$k = \"@firebase/app-check-compat\";\n\nconst name$j = \"@firebase/app-check\";\n\nconst name$i = \"@firebase/auth\";\n\nconst name$h = \"@firebase/auth-compat\";\n\nconst name$g = \"@firebase/database\";\n\nconst name$f = \"@firebase/database-compat\";\n\nconst name$e = \"@firebase/functions\";\n\nconst name$d = \"@firebase/functions-compat\";\n\nconst name$c = \"@firebase/installations\";\n\nconst name$b = \"@firebase/installations-compat\";\n\nconst name$a = \"@firebase/messaging\";\n\nconst name$9 = \"@firebase/messaging-compat\";\n\nconst name$8 = \"@firebase/performance\";\n\nconst name$7 = \"@firebase/performance-compat\";\n\nconst name$6 = \"@firebase/remote-config\";\n\nconst name$5 = \"@firebase/remote-config-compat\";\n\nconst name$4 = \"@firebase/storage\";\n\nconst name$3 = \"@firebase/storage-compat\";\n\nconst name$2 = \"@firebase/firestore\";\n\nconst name$1 = \"@firebase/firestore-compat\";\n\nconst name = \"firebase\";\nconst version = \"10.3.1\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * The default app name\r\n *\r\n * @internal\r\n */\r\nconst DEFAULT_ENTRY_NAME = '[DEFAULT]';\r\nconst PLATFORM_LOG_STRING = {\r\n    [name$o]: 'fire-core',\r\n    [name$n]: 'fire-core-compat',\r\n    [name$l]: 'fire-analytics',\r\n    [name$m]: 'fire-analytics-compat',\r\n    [name$j]: 'fire-app-check',\r\n    [name$k]: 'fire-app-check-compat',\r\n    [name$i]: 'fire-auth',\r\n    [name$h]: 'fire-auth-compat',\r\n    [name$g]: 'fire-rtdb',\r\n    [name$f]: 'fire-rtdb-compat',\r\n    [name$e]: 'fire-fn',\r\n    [name$d]: 'fire-fn-compat',\r\n    [name$c]: 'fire-iid',\r\n    [name$b]: 'fire-iid-compat',\r\n    [name$a]: 'fire-fcm',\r\n    [name$9]: 'fire-fcm-compat',\r\n    [name$8]: 'fire-perf',\r\n    [name$7]: 'fire-perf-compat',\r\n    [name$6]: 'fire-rc',\r\n    [name$5]: 'fire-rc-compat',\r\n    [name$4]: 'fire-gcs',\r\n    [name$3]: 'fire-gcs-compat',\r\n    [name$2]: 'fire-fst',\r\n    [name$1]: 'fire-fst-compat',\r\n    'fire-js': 'fire-js',\r\n    [name]: 'fire-js-all'\r\n};\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * @internal\r\n */\r\nconst _apps = new Map();\r\n/**\r\n * Registered components.\r\n *\r\n * @internal\r\n */\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\nconst _components = new Map();\r\n/**\r\n * @param component - the component being added to this app's container\r\n *\r\n * @internal\r\n */\r\nfunction _addComponent(app, component) {\r\n    try {\r\n        app.container.addComponent(component);\r\n    }\r\n    catch (e) {\r\n        logger.debug(`Component ${component.name} failed to register with FirebaseApp ${app.name}`, e);\r\n    }\r\n}\r\n/**\r\n *\r\n * @internal\r\n */\r\nfunction _addOrOverwriteComponent(app, component) {\r\n    app.container.addOrOverwriteComponent(component);\r\n}\r\n/**\r\n *\r\n * @param component - the component to register\r\n * @returns whether or not the component is registered successfully\r\n *\r\n * @internal\r\n */\r\nfunction _registerComponent(component) {\r\n    const componentName = component.name;\r\n    if (_components.has(componentName)) {\r\n        logger.debug(`There were multiple attempts to register component ${componentName}.`);\r\n        return false;\r\n    }\r\n    _components.set(componentName, component);\r\n    // add the component to existing app instances\r\n    for (const app of _apps.values()) {\r\n        _addComponent(app, component);\r\n    }\r\n    return true;\r\n}\r\n/**\r\n *\r\n * @param app - FirebaseApp instance\r\n * @param name - service name\r\n *\r\n * @returns the provider for the service with the matching name\r\n *\r\n * @internal\r\n */\r\nfunction _getProvider(app, name) {\r\n    const heartbeatController = app.container\r\n        .getProvider('heartbeat')\r\n        .getImmediate({ optional: true });\r\n    if (heartbeatController) {\r\n        void heartbeatController.triggerHeartbeat();\r\n    }\r\n    return app.container.getProvider(name);\r\n}\r\n/**\r\n *\r\n * @param app - FirebaseApp instance\r\n * @param name - service name\r\n * @param instanceIdentifier - service instance identifier in case the service supports multiple instances\r\n *\r\n * @internal\r\n */\r\nfunction _removeServiceInstance(app, name, instanceIdentifier = DEFAULT_ENTRY_NAME) {\r\n    _getProvider(app, name).clearInstance(instanceIdentifier);\r\n}\r\n/**\r\n * Test only\r\n *\r\n * @internal\r\n */\r\nfunction _clearComponents() {\r\n    _components.clear();\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERRORS = {\r\n    [\"no-app\" /* AppError.NO_APP */]: \"No Firebase App '{$appName}' has been created - \" +\r\n        'call initializeApp() first',\r\n    [\"bad-app-name\" /* AppError.BAD_APP_NAME */]: \"Illegal App name: '{$appName}\",\r\n    [\"duplicate-app\" /* AppError.DUPLICATE_APP */]: \"Firebase App named '{$appName}' already exists with different options or config\",\r\n    [\"app-deleted\" /* AppError.APP_DELETED */]: \"Firebase App named '{$appName}' already deleted\",\r\n    [\"no-options\" /* AppError.NO_OPTIONS */]: 'Need to provide options, when not being deployed to hosting via source.',\r\n    [\"invalid-app-argument\" /* AppError.INVALID_APP_ARGUMENT */]: 'firebase.{$appName}() takes either no argument or a ' +\r\n        'Firebase App instance.',\r\n    [\"invalid-log-argument\" /* AppError.INVALID_LOG_ARGUMENT */]: 'First argument to `onLog` must be null or a function.',\r\n    [\"idb-open\" /* AppError.IDB_OPEN */]: 'Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.',\r\n    [\"idb-get\" /* AppError.IDB_GET */]: 'Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.',\r\n    [\"idb-set\" /* AppError.IDB_WRITE */]: 'Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.',\r\n    [\"idb-delete\" /* AppError.IDB_DELETE */]: 'Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.'\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory('app', 'Firebase', ERRORS);\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nclass FirebaseAppImpl {\r\n    constructor(options, config, container) {\r\n        this._isDeleted = false;\r\n        this._options = Object.assign({}, options);\r\n        this._config = Object.assign({}, config);\r\n        this._name = config.name;\r\n        this._automaticDataCollectionEnabled =\r\n            config.automaticDataCollectionEnabled;\r\n        this._container = container;\r\n        this.container.addComponent(new Component('app', () => this, \"PUBLIC\" /* ComponentType.PUBLIC */));\r\n    }\r\n    get automaticDataCollectionEnabled() {\r\n        this.checkDestroyed();\r\n        return this._automaticDataCollectionEnabled;\r\n    }\r\n    set automaticDataCollectionEnabled(val) {\r\n        this.checkDestroyed();\r\n        this._automaticDataCollectionEnabled = val;\r\n    }\r\n    get name() {\r\n        this.checkDestroyed();\r\n        return this._name;\r\n    }\r\n    get options() {\r\n        this.checkDestroyed();\r\n        return this._options;\r\n    }\r\n    get config() {\r\n        this.checkDestroyed();\r\n        return this._config;\r\n    }\r\n    get container() {\r\n        return this._container;\r\n    }\r\n    get isDeleted() {\r\n        return this._isDeleted;\r\n    }\r\n    set isDeleted(val) {\r\n        this._isDeleted = val;\r\n    }\r\n    /**\r\n     * This function will throw an Error if the App has already been deleted -\r\n     * use before performing API actions on the App.\r\n     */\r\n    checkDestroyed() {\r\n        if (this.isDeleted) {\r\n            throw ERROR_FACTORY.create(\"app-deleted\" /* AppError.APP_DELETED */, { appName: this._name });\r\n        }\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * The current SDK version.\r\n *\r\n * @public\r\n */\r\nconst SDK_VERSION = version;\r\nfunction initializeApp(_options, rawConfig = {}) {\r\n    let options = _options;\r\n    if (typeof rawConfig !== 'object') {\r\n        const name = rawConfig;\r\n        rawConfig = { name };\r\n    }\r\n    const config = Object.assign({ name: DEFAULT_ENTRY_NAME, automaticDataCollectionEnabled: false }, rawConfig);\r\n    const name = config.name;\r\n    if (typeof name !== 'string' || !name) {\r\n        throw ERROR_FACTORY.create(\"bad-app-name\" /* AppError.BAD_APP_NAME */, {\r\n            appName: String(name)\r\n        });\r\n    }\r\n    options || (options = getDefaultAppConfig());\r\n    if (!options) {\r\n        throw ERROR_FACTORY.create(\"no-options\" /* AppError.NO_OPTIONS */);\r\n    }\r\n    const existingApp = _apps.get(name);\r\n    if (existingApp) {\r\n        // return the existing app if options and config deep equal the ones in the existing app.\r\n        if (deepEqual(options, existingApp.options) &&\r\n            deepEqual(config, existingApp.config)) {\r\n            return existingApp;\r\n        }\r\n        else {\r\n            throw ERROR_FACTORY.create(\"duplicate-app\" /* AppError.DUPLICATE_APP */, { appName: name });\r\n        }\r\n    }\r\n    const container = new ComponentContainer(name);\r\n    for (const component of _components.values()) {\r\n        container.addComponent(component);\r\n    }\r\n    const newApp = new FirebaseAppImpl(options, config, container);\r\n    _apps.set(name, newApp);\r\n    return newApp;\r\n}\r\n/**\r\n * Retrieves a {@link @firebase/app#FirebaseApp} instance.\r\n *\r\n * When called with no arguments, the default app is returned. When an app name\r\n * is provided, the app corresponding to that name is returned.\r\n *\r\n * An exception is thrown if the app being retrieved has not yet been\r\n * initialized.\r\n *\r\n * @example\r\n * ```javascript\r\n * // Return the default app\r\n * const app = getApp();\r\n * ```\r\n *\r\n * @example\r\n * ```javascript\r\n * // Return a named app\r\n * const otherApp = getApp(\"otherApp\");\r\n * ```\r\n *\r\n * @param name - Optional name of the app to return. If no name is\r\n *   provided, the default is `\"[DEFAULT]\"`.\r\n *\r\n * @returns The app corresponding to the provided app name.\r\n *   If no app name is provided, the default app is returned.\r\n *\r\n * @public\r\n */\r\nfunction getApp(name = DEFAULT_ENTRY_NAME) {\r\n    const app = _apps.get(name);\r\n    if (!app && name === DEFAULT_ENTRY_NAME && getDefaultAppConfig()) {\r\n        return initializeApp();\r\n    }\r\n    if (!app) {\r\n        throw ERROR_FACTORY.create(\"no-app\" /* AppError.NO_APP */, { appName: name });\r\n    }\r\n    return app;\r\n}\r\n/**\r\n * A (read-only) array of all initialized apps.\r\n * @public\r\n */\r\nfunction getApps() {\r\n    return Array.from(_apps.values());\r\n}\r\n/**\r\n * Renders this app unusable and frees the resources of all associated\r\n * services.\r\n *\r\n * @example\r\n * ```javascript\r\n * deleteApp(app)\r\n *   .then(function() {\r\n *     console.log(\"App deleted successfully\");\r\n *   })\r\n *   .catch(function(error) {\r\n *     console.log(\"Error deleting app:\", error);\r\n *   });\r\n * ```\r\n *\r\n * @public\r\n */\r\nasync function deleteApp(app) {\r\n    const name = app.name;\r\n    if (_apps.has(name)) {\r\n        _apps.delete(name);\r\n        await Promise.all(app.container\r\n            .getProviders()\r\n            .map(provider => provider.delete()));\r\n        app.isDeleted = true;\r\n    }\r\n}\r\n/**\r\n * Registers a library's name and version for platform logging purposes.\r\n * @param library - Name of 1p or 3p library (e.g. firestore, angularfire)\r\n * @param version - Current version of that library.\r\n * @param variant - Bundle variant, e.g., node, rn, etc.\r\n *\r\n * @public\r\n */\r\nfunction registerVersion(libraryKeyOrName, version, variant) {\r\n    var _a;\r\n    // TODO: We can use this check to whitelist strings when/if we set up\r\n    // a good whitelist system.\r\n    let library = (_a = PLATFORM_LOG_STRING[libraryKeyOrName]) !== null && _a !== void 0 ? _a : libraryKeyOrName;\r\n    if (variant) {\r\n        library += `-${variant}`;\r\n    }\r\n    const libraryMismatch = library.match(/\\s|\\//);\r\n    const versionMismatch = version.match(/\\s|\\//);\r\n    if (libraryMismatch || versionMismatch) {\r\n        const warning = [\r\n            `Unable to register library \"${library}\" with version \"${version}\":`\r\n        ];\r\n        if (libraryMismatch) {\r\n            warning.push(`library name \"${library}\" contains illegal characters (whitespace or \"/\")`);\r\n        }\r\n        if (libraryMismatch && versionMismatch) {\r\n            warning.push('and');\r\n        }\r\n        if (versionMismatch) {\r\n            warning.push(`version name \"${version}\" contains illegal characters (whitespace or \"/\")`);\r\n        }\r\n        logger.warn(warning.join(' '));\r\n        return;\r\n    }\r\n    _registerComponent(new Component(`${library}-version`, () => ({ library, version }), \"VERSION\" /* ComponentType.VERSION */));\r\n}\r\n/**\r\n * Sets log handler for all Firebase SDKs.\r\n * @param logCallback - An optional custom log handler that executes user code whenever\r\n * the Firebase SDK makes a logging call.\r\n *\r\n * @public\r\n */\r\nfunction onLog(logCallback, options) {\r\n    if (logCallback !== null && typeof logCallback !== 'function') {\r\n        throw ERROR_FACTORY.create(\"invalid-log-argument\" /* AppError.INVALID_LOG_ARGUMENT */);\r\n    }\r\n    setUserLogHandler(logCallback, options);\r\n}\r\n/**\r\n * Sets log level for all Firebase SDKs.\r\n *\r\n * All of the log types above the current log level are captured (i.e. if\r\n * you set the log level to `info`, errors are logged, but `debug` and\r\n * `verbose` logs are not).\r\n *\r\n * @public\r\n */\r\nfunction setLogLevel(logLevel) {\r\n    setLogLevel$1(logLevel);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DB_NAME = 'firebase-heartbeat-database';\r\nconst DB_VERSION = 1;\r\nconst STORE_NAME = 'firebase-heartbeat-store';\r\nlet dbPromise = null;\r\nfunction getDbPromise() {\r\n    if (!dbPromise) {\r\n        dbPromise = openDB(DB_NAME, DB_VERSION, {\r\n            upgrade: (db, oldVersion) => {\r\n                // We don't use 'break' in this switch statement, the fall-through\r\n                // behavior is what we want, because if there are multiple versions between\r\n                // the old version and the current version, we want ALL the migrations\r\n                // that correspond to those versions to run, not only the last one.\r\n                // eslint-disable-next-line default-case\r\n                switch (oldVersion) {\r\n                    case 0:\r\n                        db.createObjectStore(STORE_NAME);\r\n                }\r\n            }\r\n        }).catch(e => {\r\n            throw ERROR_FACTORY.create(\"idb-open\" /* AppError.IDB_OPEN */, {\r\n                originalErrorMessage: e.message\r\n            });\r\n        });\r\n    }\r\n    return dbPromise;\r\n}\r\nasync function readHeartbeatsFromIndexedDB(app) {\r\n    try {\r\n        const db = await getDbPromise();\r\n        const result = await db\r\n            .transaction(STORE_NAME)\r\n            .objectStore(STORE_NAME)\r\n            .get(computeKey(app));\r\n        return result;\r\n    }\r\n    catch (e) {\r\n        if (e instanceof FirebaseError) {\r\n            logger.warn(e.message);\r\n        }\r\n        else {\r\n            const idbGetError = ERROR_FACTORY.create(\"idb-get\" /* AppError.IDB_GET */, {\r\n                originalErrorMessage: e === null || e === void 0 ? void 0 : e.message\r\n            });\r\n            logger.warn(idbGetError.message);\r\n        }\r\n    }\r\n}\r\nasync function writeHeartbeatsToIndexedDB(app, heartbeatObject) {\r\n    try {\r\n        const db = await getDbPromise();\r\n        const tx = db.transaction(STORE_NAME, 'readwrite');\r\n        const objectStore = tx.objectStore(STORE_NAME);\r\n        await objectStore.put(heartbeatObject, computeKey(app));\r\n        await tx.done;\r\n    }\r\n    catch (e) {\r\n        if (e instanceof FirebaseError) {\r\n            logger.warn(e.message);\r\n        }\r\n        else {\r\n            const idbGetError = ERROR_FACTORY.create(\"idb-set\" /* AppError.IDB_WRITE */, {\r\n                originalErrorMessage: e === null || e === void 0 ? void 0 : e.message\r\n            });\r\n            logger.warn(idbGetError.message);\r\n        }\r\n    }\r\n}\r\nfunction computeKey(app) {\r\n    return `${app.name}!${app.options.appId}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst MAX_HEADER_BYTES = 1024;\r\n// 30 days\r\nconst STORED_HEARTBEAT_RETENTION_MAX_MILLIS = 30 * 24 * 60 * 60 * 1000;\r\nclass HeartbeatServiceImpl {\r\n    constructor(container) {\r\n        this.container = container;\r\n        /**\r\n         * In-memory cache for heartbeats, used by getHeartbeatsHeader() to generate\r\n         * the header string.\r\n         * Stores one record per date. This will be consolidated into the standard\r\n         * format of one record per user agent string before being sent as a header.\r\n         * Populated from indexedDB when the controller is instantiated and should\r\n         * be kept in sync with indexedDB.\r\n         * Leave public for easier testing.\r\n         */\r\n        this._heartbeatsCache = null;\r\n        const app = this.container.getProvider('app').getImmediate();\r\n        this._storage = new HeartbeatStorageImpl(app);\r\n        this._heartbeatsCachePromise = this._storage.read().then(result => {\r\n            this._heartbeatsCache = result;\r\n            return result;\r\n        });\r\n    }\r\n    /**\r\n     * Called to report a heartbeat. The function will generate\r\n     * a HeartbeatsByUserAgent object, update heartbeatsCache, and persist it\r\n     * to IndexedDB.\r\n     * Note that we only store one heartbeat per day. So if a heartbeat for today is\r\n     * already logged, subsequent calls to this function in the same day will be ignored.\r\n     */\r\n    async triggerHeartbeat() {\r\n        const platformLogger = this.container\r\n            .getProvider('platform-logger')\r\n            .getImmediate();\r\n        // This is the \"Firebase user agent\" string from the platform logger\r\n        // service, not the browser user agent.\r\n        const agent = platformLogger.getPlatformInfoString();\r\n        const date = getUTCDateString();\r\n        if (this._heartbeatsCache === null) {\r\n            this._heartbeatsCache = await this._heartbeatsCachePromise;\r\n        }\r\n        // Do not store a heartbeat if one is already stored for this day\r\n        // or if a header has already been sent today.\r\n        if (this._heartbeatsCache.lastSentHeartbeatDate === date ||\r\n            this._heartbeatsCache.heartbeats.some(singleDateHeartbeat => singleDateHeartbeat.date === date)) {\r\n            return;\r\n        }\r\n        else {\r\n            // There is no entry for this date. Create one.\r\n            this._heartbeatsCache.heartbeats.push({ date, agent });\r\n        }\r\n        // Remove entries older than 30 days.\r\n        this._heartbeatsCache.heartbeats = this._heartbeatsCache.heartbeats.filter(singleDateHeartbeat => {\r\n            const hbTimestamp = new Date(singleDateHeartbeat.date).valueOf();\r\n            const now = Date.now();\r\n            return now - hbTimestamp <= STORED_HEARTBEAT_RETENTION_MAX_MILLIS;\r\n        });\r\n        return this._storage.overwrite(this._heartbeatsCache);\r\n    }\r\n    /**\r\n     * Returns a base64 encoded string which can be attached to the heartbeat-specific header directly.\r\n     * It also clears all heartbeats from memory as well as in IndexedDB.\r\n     *\r\n     * NOTE: Consuming product SDKs should not send the header if this method\r\n     * returns an empty string.\r\n     */\r\n    async getHeartbeatsHeader() {\r\n        if (this._heartbeatsCache === null) {\r\n            await this._heartbeatsCachePromise;\r\n        }\r\n        // If it's still null or the array is empty, there is no data to send.\r\n        if (this._heartbeatsCache === null ||\r\n            this._heartbeatsCache.heartbeats.length === 0) {\r\n            return '';\r\n        }\r\n        const date = getUTCDateString();\r\n        // Extract as many heartbeats from the cache as will fit under the size limit.\r\n        const { heartbeatsToSend, unsentEntries } = extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats);\r\n        const headerString = base64urlEncodeWithoutPadding(JSON.stringify({ version: 2, heartbeats: heartbeatsToSend }));\r\n        // Store last sent date to prevent another being logged/sent for the same day.\r\n        this._heartbeatsCache.lastSentHeartbeatDate = date;\r\n        if (unsentEntries.length > 0) {\r\n            // Store any unsent entries if they exist.\r\n            this._heartbeatsCache.heartbeats = unsentEntries;\r\n            // This seems more likely than emptying the array (below) to lead to some odd state\r\n            // since the cache isn't empty and this will be called again on the next request,\r\n            // and is probably safest if we await it.\r\n            await this._storage.overwrite(this._heartbeatsCache);\r\n        }\r\n        else {\r\n            this._heartbeatsCache.heartbeats = [];\r\n            // Do not wait for this, to reduce latency.\r\n            void this._storage.overwrite(this._heartbeatsCache);\r\n        }\r\n        return headerString;\r\n    }\r\n}\r\nfunction getUTCDateString() {\r\n    const today = new Date();\r\n    // Returns date format 'YYYY-MM-DD'\r\n    return today.toISOString().substring(0, 10);\r\n}\r\nfunction extractHeartbeatsForHeader(heartbeatsCache, maxSize = MAX_HEADER_BYTES) {\r\n    // Heartbeats grouped by user agent in the standard format to be sent in\r\n    // the header.\r\n    const heartbeatsToSend = [];\r\n    // Single date format heartbeats that are not sent.\r\n    let unsentEntries = heartbeatsCache.slice();\r\n    for (const singleDateHeartbeat of heartbeatsCache) {\r\n        // Look for an existing entry with the same user agent.\r\n        const heartbeatEntry = heartbeatsToSend.find(hb => hb.agent === singleDateHeartbeat.agent);\r\n        if (!heartbeatEntry) {\r\n            // If no entry for this user agent exists, create one.\r\n            heartbeatsToSend.push({\r\n                agent: singleDateHeartbeat.agent,\r\n                dates: [singleDateHeartbeat.date]\r\n            });\r\n            if (countBytes(heartbeatsToSend) > maxSize) {\r\n                // If the header would exceed max size, remove the added heartbeat\r\n                // entry and stop adding to the header.\r\n                heartbeatsToSend.pop();\r\n                break;\r\n            }\r\n        }\r\n        else {\r\n            heartbeatEntry.dates.push(singleDateHeartbeat.date);\r\n            // If the header would exceed max size, remove the added date\r\n            // and stop adding to the header.\r\n            if (countBytes(heartbeatsToSend) > maxSize) {\r\n                heartbeatEntry.dates.pop();\r\n                break;\r\n            }\r\n        }\r\n        // Pop unsent entry from queue. (Skipped if adding the entry exceeded\r\n        // quota and the loop breaks early.)\r\n        unsentEntries = unsentEntries.slice(1);\r\n    }\r\n    return {\r\n        heartbeatsToSend,\r\n        unsentEntries\r\n    };\r\n}\r\nclass HeartbeatStorageImpl {\r\n    constructor(app) {\r\n        this.app = app;\r\n        this._canUseIndexedDBPromise = this.runIndexedDBEnvironmentCheck();\r\n    }\r\n    async runIndexedDBEnvironmentCheck() {\r\n        if (!isIndexedDBAvailable()) {\r\n            return false;\r\n        }\r\n        else {\r\n            return validateIndexedDBOpenable()\r\n                .then(() => true)\r\n                .catch(() => false);\r\n        }\r\n    }\r\n    /**\r\n     * Read all heartbeats.\r\n     */\r\n    async read() {\r\n        const canUseIndexedDB = await this._canUseIndexedDBPromise;\r\n        if (!canUseIndexedDB) {\r\n            return { heartbeats: [] };\r\n        }\r\n        else {\r\n            const idbHeartbeatObject = await readHeartbeatsFromIndexedDB(this.app);\r\n            return idbHeartbeatObject || { heartbeats: [] };\r\n        }\r\n    }\r\n    // overwrite the storage with the provided heartbeats\r\n    async overwrite(heartbeatsObject) {\r\n        var _a;\r\n        const canUseIndexedDB = await this._canUseIndexedDBPromise;\r\n        if (!canUseIndexedDB) {\r\n            return;\r\n        }\r\n        else {\r\n            const existingHeartbeatsObject = await this.read();\r\n            return writeHeartbeatsToIndexedDB(this.app, {\r\n                lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,\r\n                heartbeats: heartbeatsObject.heartbeats\r\n            });\r\n        }\r\n    }\r\n    // add heartbeats\r\n    async add(heartbeatsObject) {\r\n        var _a;\r\n        const canUseIndexedDB = await this._canUseIndexedDBPromise;\r\n        if (!canUseIndexedDB) {\r\n            return;\r\n        }\r\n        else {\r\n            const existingHeartbeatsObject = await this.read();\r\n            return writeHeartbeatsToIndexedDB(this.app, {\r\n                lastSentHeartbeatDate: (_a = heartbeatsObject.lastSentHeartbeatDate) !== null && _a !== void 0 ? _a : existingHeartbeatsObject.lastSentHeartbeatDate,\r\n                heartbeats: [\r\n                    ...existingHeartbeatsObject.heartbeats,\r\n                    ...heartbeatsObject.heartbeats\r\n                ]\r\n            });\r\n        }\r\n    }\r\n}\r\n/**\r\n * Calculate bytes of a HeartbeatsByUserAgent array after being wrapped\r\n * in a platform logging header JSON object, stringified, and converted\r\n * to base 64.\r\n */\r\nfunction countBytes(heartbeatsCache) {\r\n    // base64 has a restricted set of characters, all of which should be 1 byte.\r\n    return base64urlEncodeWithoutPadding(\r\n    // heartbeatsCache wrapper properties\r\n    JSON.stringify({ version: 2, heartbeats: heartbeatsCache })).length;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction registerCoreComponents(variant) {\r\n    _registerComponent(new Component('platform-logger', container => new PlatformLoggerServiceImpl(container), \"PRIVATE\" /* ComponentType.PRIVATE */));\r\n    _registerComponent(new Component('heartbeat', container => new HeartbeatServiceImpl(container), \"PRIVATE\" /* ComponentType.PRIVATE */));\r\n    // Register `app` package.\r\n    registerVersion(name$o, version$1, variant);\r\n    // BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\n    registerVersion(name$o, version$1, 'esm2017');\r\n    // Register platform SDK identifier (no version).\r\n    registerVersion('fire-js', '');\r\n}\n\n/**\r\n * Firebase App\r\n *\r\n * @remarks This package coordinates the communication between the different Firebase components\r\n * @packageDocumentation\r\n */\r\nregisterCoreComponents('');\n\nexport { SDK_VERSION, DEFAULT_ENTRY_NAME as _DEFAULT_ENTRY_NAME, _addComponent, _addOrOverwriteComponent, _apps, _clearComponents, _components, _getProvider, _registerComponent, _removeServiceInstance, deleteApp, getApp, getApps, initializeApp, onLog, registerVersion, setLogLevel };\n//# sourceMappingURL=index.esm2017.js.map\n","import { registerVersion } from '@firebase/app';\nexport * from '@firebase/app';\n\nvar name = \"firebase\";\nvar version = \"10.3.1\";\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nregisterVersion(name, version, 'app');\n//# sourceMappingURL=index.esm.js.map\n","const instanceOfAny = (object, constructors) => constructors.some((c) => object instanceof c);\n\nlet idbProxyableTypes;\nlet cursorAdvanceMethods;\n// This is a function to prevent it throwing up in node environments.\nfunction getIdbProxyableTypes() {\n    return (idbProxyableTypes ||\n        (idbProxyableTypes = [\n            IDBDatabase,\n            IDBObjectStore,\n            IDBIndex,\n            IDBCursor,\n            IDBTransaction,\n        ]));\n}\n// This is a function to prevent it throwing up in node environments.\nfunction getCursorAdvanceMethods() {\n    return (cursorAdvanceMethods ||\n        (cursorAdvanceMethods = [\n            IDBCursor.prototype.advance,\n            IDBCursor.prototype.continue,\n            IDBCursor.prototype.continuePrimaryKey,\n        ]));\n}\nconst cursorRequestMap = new WeakMap();\nconst transactionDoneMap = new WeakMap();\nconst transactionStoreNamesMap = new WeakMap();\nconst transformCache = new WeakMap();\nconst reverseTransformCache = new WeakMap();\nfunction promisifyRequest(request) {\n    const promise = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            request.removeEventListener('success', success);\n            request.removeEventListener('error', error);\n        };\n        const success = () => {\n            resolve(wrap(request.result));\n            unlisten();\n        };\n        const error = () => {\n            reject(request.error);\n            unlisten();\n        };\n        request.addEventListener('success', success);\n        request.addEventListener('error', error);\n    });\n    promise\n        .then((value) => {\n        // Since cursoring reuses the IDBRequest (*sigh*), we cache it for later retrieval\n        // (see wrapFunction).\n        if (value instanceof IDBCursor) {\n            cursorRequestMap.set(value, request);\n        }\n        // Catching to avoid \"Uncaught Promise exceptions\"\n    })\n        .catch(() => { });\n    // This mapping exists in reverseTransformCache but doesn't doesn't exist in transformCache. This\n    // is because we create many promises from a single IDBRequest.\n    reverseTransformCache.set(promise, request);\n    return promise;\n}\nfunction cacheDonePromiseForTransaction(tx) {\n    // Early bail if we've already created a done promise for this transaction.\n    if (transactionDoneMap.has(tx))\n        return;\n    const done = new Promise((resolve, reject) => {\n        const unlisten = () => {\n            tx.removeEventListener('complete', complete);\n            tx.removeEventListener('error', error);\n            tx.removeEventListener('abort', error);\n        };\n        const complete = () => {\n            resolve();\n            unlisten();\n        };\n        const error = () => {\n            reject(tx.error || new DOMException('AbortError', 'AbortError'));\n            unlisten();\n        };\n        tx.addEventListener('complete', complete);\n        tx.addEventListener('error', error);\n        tx.addEventListener('abort', error);\n    });\n    // Cache it for later retrieval.\n    transactionDoneMap.set(tx, done);\n}\nlet idbProxyTraps = {\n    get(target, prop, receiver) {\n        if (target instanceof IDBTransaction) {\n            // Special handling for transaction.done.\n            if (prop === 'done')\n                return transactionDoneMap.get(target);\n            // Polyfill for objectStoreNames because of Edge.\n            if (prop === 'objectStoreNames') {\n                return target.objectStoreNames || transactionStoreNamesMap.get(target);\n            }\n            // Make tx.store return the only store in the transaction, or undefined if there are many.\n            if (prop === 'store') {\n                return receiver.objectStoreNames[1]\n                    ? undefined\n                    : receiver.objectStore(receiver.objectStoreNames[0]);\n            }\n        }\n        // Else transform whatever we get back.\n        return wrap(target[prop]);\n    },\n    set(target, prop, value) {\n        target[prop] = value;\n        return true;\n    },\n    has(target, prop) {\n        if (target instanceof IDBTransaction &&\n            (prop === 'done' || prop === 'store')) {\n            return true;\n        }\n        return prop in target;\n    },\n};\nfunction replaceTraps(callback) {\n    idbProxyTraps = callback(idbProxyTraps);\n}\nfunction wrapFunction(func) {\n    // Due to expected object equality (which is enforced by the caching in `wrap`), we\n    // only create one new func per func.\n    // Edge doesn't support objectStoreNames (booo), so we polyfill it here.\n    if (func === IDBDatabase.prototype.transaction &&\n        !('objectStoreNames' in IDBTransaction.prototype)) {\n        return function (storeNames, ...args) {\n            const tx = func.call(unwrap(this), storeNames, ...args);\n            transactionStoreNamesMap.set(tx, storeNames.sort ? storeNames.sort() : [storeNames]);\n            return wrap(tx);\n        };\n    }\n    // Cursor methods are special, as the behaviour is a little more different to standard IDB. In\n    // IDB, you advance the cursor and wait for a new 'success' on the IDBRequest that gave you the\n    // cursor. It's kinda like a promise that can resolve with many values. That doesn't make sense\n    // with real promises, so each advance methods returns a new promise for the cursor object, or\n    // undefined if the end of the cursor has been reached.\n    if (getCursorAdvanceMethods().includes(func)) {\n        return function (...args) {\n            // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n            // the original object.\n            func.apply(unwrap(this), args);\n            return wrap(cursorRequestMap.get(this));\n        };\n    }\n    return function (...args) {\n        // Calling the original function with the proxy as 'this' causes ILLEGAL INVOCATION, so we use\n        // the original object.\n        return wrap(func.apply(unwrap(this), args));\n    };\n}\nfunction transformCachableValue(value) {\n    if (typeof value === 'function')\n        return wrapFunction(value);\n    // This doesn't return, it just creates a 'done' promise for the transaction,\n    // which is later returned for transaction.done (see idbObjectHandler).\n    if (value instanceof IDBTransaction)\n        cacheDonePromiseForTransaction(value);\n    if (instanceOfAny(value, getIdbProxyableTypes()))\n        return new Proxy(value, idbProxyTraps);\n    // Return the same value back if we're not going to transform it.\n    return value;\n}\nfunction wrap(value) {\n    // We sometimes generate multiple promises from a single IDBRequest (eg when cursoring), because\n    // IDB is weird and a single IDBRequest can yield many responses, so these can't be cached.\n    if (value instanceof IDBRequest)\n        return promisifyRequest(value);\n    // If we've already transformed this value before, reuse the transformed value.\n    // This is faster, but it also provides object equality.\n    if (transformCache.has(value))\n        return transformCache.get(value);\n    const newValue = transformCachableValue(value);\n    // Not all types are transformed.\n    // These may be primitive types, so they can't be WeakMap keys.\n    if (newValue !== value) {\n        transformCache.set(value, newValue);\n        reverseTransformCache.set(newValue, value);\n    }\n    return newValue;\n}\nconst unwrap = (value) => reverseTransformCache.get(value);\n\nexport { reverseTransformCache as a, instanceOfAny as i, replaceTraps as r, unwrap as u, wrap as w };\n","import { w as wrap, r as replaceTraps } from './wrap-idb-value.js';\nexport { u as unwrap, w as wrap } from './wrap-idb-value.js';\n\n/**\n * Open a database.\n *\n * @param name Name of the database.\n * @param version Schema version.\n * @param callbacks Additional callbacks.\n */\nfunction openDB(name, version, { blocked, upgrade, blocking, terminated } = {}) {\n    const request = indexedDB.open(name, version);\n    const openPromise = wrap(request);\n    if (upgrade) {\n        request.addEventListener('upgradeneeded', (event) => {\n            upgrade(wrap(request.result), event.oldVersion, event.newVersion, wrap(request.transaction));\n        });\n    }\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    openPromise\n        .then((db) => {\n        if (terminated)\n            db.addEventListener('close', () => terminated());\n        if (blocking)\n            db.addEventListener('versionchange', () => blocking());\n    })\n        .catch(() => { });\n    return openPromise;\n}\n/**\n * Delete a database.\n *\n * @param name Name of the database.\n */\nfunction deleteDB(name, { blocked } = {}) {\n    const request = indexedDB.deleteDatabase(name);\n    if (blocked)\n        request.addEventListener('blocked', () => blocked());\n    return wrap(request).then(() => undefined);\n}\n\nconst readMethods = ['get', 'getKey', 'getAll', 'getAllKeys', 'count'];\nconst writeMethods = ['put', 'add', 'delete', 'clear'];\nconst cachedMethods = new Map();\nfunction getMethod(target, prop) {\n    if (!(target instanceof IDBDatabase &&\n        !(prop in target) &&\n        typeof prop === 'string')) {\n        return;\n    }\n    if (cachedMethods.get(prop))\n        return cachedMethods.get(prop);\n    const targetFuncName = prop.replace(/FromIndex$/, '');\n    const useIndex = prop !== targetFuncName;\n    const isWrite = writeMethods.includes(targetFuncName);\n    if (\n    // Bail if the target doesn't exist on the target. Eg, getAll isn't in Edge.\n    !(targetFuncName in (useIndex ? IDBIndex : IDBObjectStore).prototype) ||\n        !(isWrite || readMethods.includes(targetFuncName))) {\n        return;\n    }\n    const method = async function (storeName, ...args) {\n        // isWrite ? 'readwrite' : undefined gzipps better, but fails in Edge :(\n        const tx = this.transaction(storeName, isWrite ? 'readwrite' : 'readonly');\n        let target = tx.store;\n        if (useIndex)\n            target = target.index(args.shift());\n        // Must reject if op rejects.\n        // If it's a write operation, must reject if tx.done rejects.\n        // Must reject with op rejection first.\n        // Must resolve with op value.\n        // Must handle both promises (no unhandled rejections)\n        return (await Promise.all([\n            target[targetFuncName](...args),\n            isWrite && tx.done,\n        ]))[0];\n    };\n    cachedMethods.set(prop, method);\n    return method;\n}\nreplaceTraps((oldTraps) => ({\n    ...oldTraps,\n    get: (target, prop, receiver) => getMethod(target, prop) || oldTraps.get(target, prop, receiver),\n    has: (target, prop) => !!getMethod(target, prop) || oldTraps.has(target, prop),\n}));\n\nexport { deleteDB, openDB };\n","import { _getProvider, getApp, _registerComponent, registerVersion } from '@firebase/app';\nimport { Component } from '@firebase/component';\nimport { ErrorFactory, FirebaseError } from '@firebase/util';\nimport { openDB } from 'idb';\n\nconst name = \"@firebase/installations\";\nconst version = \"0.6.4\";\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst PENDING_TIMEOUT_MS = 10000;\r\nconst PACKAGE_VERSION = `w:${version}`;\r\nconst INTERNAL_AUTH_VERSION = 'FIS_v2';\r\nconst INSTALLATIONS_API_URL = 'https://firebaseinstallations.googleapis.com/v1';\r\nconst TOKEN_EXPIRATION_BUFFER = 60 * 60 * 1000; // One hour\r\nconst SERVICE = 'installations';\r\nconst SERVICE_NAME = 'Installations';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERROR_DESCRIPTION_MAP = {\r\n    [\"missing-app-config-values\" /* ErrorCode.MISSING_APP_CONFIG_VALUES */]: 'Missing App configuration value: \"{$valueName}\"',\r\n    [\"not-registered\" /* ErrorCode.NOT_REGISTERED */]: 'Firebase Installation is not registered.',\r\n    [\"installation-not-found\" /* ErrorCode.INSTALLATION_NOT_FOUND */]: 'Firebase Installation not found.',\r\n    [\"request-failed\" /* ErrorCode.REQUEST_FAILED */]: '{$requestName} request failed with error \"{$serverCode} {$serverStatus}: {$serverMessage}\"',\r\n    [\"app-offline\" /* ErrorCode.APP_OFFLINE */]: 'Could not process request. Application offline.',\r\n    [\"delete-pending-registration\" /* ErrorCode.DELETE_PENDING_REGISTRATION */]: \"Can't delete installation while there is a pending registration request.\"\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory(SERVICE, SERVICE_NAME, ERROR_DESCRIPTION_MAP);\r\n/** Returns true if error is a FirebaseError that is based on an error from the server. */\r\nfunction isServerError(error) {\r\n    return (error instanceof FirebaseError &&\r\n        error.code.includes(\"request-failed\" /* ErrorCode.REQUEST_FAILED */));\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction getInstallationsEndpoint({ projectId }) {\r\n    return `${INSTALLATIONS_API_URL}/projects/${projectId}/installations`;\r\n}\r\nfunction extractAuthTokenInfoFromResponse(response) {\r\n    return {\r\n        token: response.token,\r\n        requestStatus: 2 /* RequestStatus.COMPLETED */,\r\n        expiresIn: getExpiresInFromResponseExpiresIn(response.expiresIn),\r\n        creationTime: Date.now()\r\n    };\r\n}\r\nasync function getErrorFromResponse(requestName, response) {\r\n    const responseJson = await response.json();\r\n    const errorData = responseJson.error;\r\n    return ERROR_FACTORY.create(\"request-failed\" /* ErrorCode.REQUEST_FAILED */, {\r\n        requestName,\r\n        serverCode: errorData.code,\r\n        serverMessage: errorData.message,\r\n        serverStatus: errorData.status\r\n    });\r\n}\r\nfunction getHeaders({ apiKey }) {\r\n    return new Headers({\r\n        'Content-Type': 'application/json',\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': apiKey\r\n    });\r\n}\r\nfunction getHeadersWithAuth(appConfig, { refreshToken }) {\r\n    const headers = getHeaders(appConfig);\r\n    headers.append('Authorization', getAuthorizationHeader(refreshToken));\r\n    return headers;\r\n}\r\n/**\r\n * Calls the passed in fetch wrapper and returns the response.\r\n * If the returned response has a status of 5xx, re-runs the function once and\r\n * returns the response.\r\n */\r\nasync function retryIfServerError(fn) {\r\n    const result = await fn();\r\n    if (result.status >= 500 && result.status < 600) {\r\n        // Internal Server Error. Retry request.\r\n        return fn();\r\n    }\r\n    return result;\r\n}\r\nfunction getExpiresInFromResponseExpiresIn(responseExpiresIn) {\r\n    // This works because the server will never respond with fractions of a second.\r\n    return Number(responseExpiresIn.replace('s', '000'));\r\n}\r\nfunction getAuthorizationHeader(refreshToken) {\r\n    return `${INTERNAL_AUTH_VERSION} ${refreshToken}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function createInstallationRequest({ appConfig, heartbeatServiceProvider }, { fid }) {\r\n    const endpoint = getInstallationsEndpoint(appConfig);\r\n    const headers = getHeaders(appConfig);\r\n    // If heartbeat service exists, add the heartbeat string to the header.\r\n    const heartbeatService = heartbeatServiceProvider.getImmediate({\r\n        optional: true\r\n    });\r\n    if (heartbeatService) {\r\n        const heartbeatsHeader = await heartbeatService.getHeartbeatsHeader();\r\n        if (heartbeatsHeader) {\r\n            headers.append('x-firebase-client', heartbeatsHeader);\r\n        }\r\n    }\r\n    const body = {\r\n        fid,\r\n        authVersion: INTERNAL_AUTH_VERSION,\r\n        appId: appConfig.appId,\r\n        sdkVersion: PACKAGE_VERSION\r\n    };\r\n    const request = {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (response.ok) {\r\n        const responseValue = await response.json();\r\n        const registeredInstallationEntry = {\r\n            fid: responseValue.fid || fid,\r\n            registrationStatus: 2 /* RequestStatus.COMPLETED */,\r\n            refreshToken: responseValue.refreshToken,\r\n            authToken: extractAuthTokenInfoFromResponse(responseValue.authToken)\r\n        };\r\n        return registeredInstallationEntry;\r\n    }\r\n    else {\r\n        throw await getErrorFromResponse('Create Installation', response);\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a promise that resolves after given time passes. */\r\nfunction sleep(ms) {\r\n    return new Promise(resolve => {\r\n        setTimeout(resolve, ms);\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction bufferToBase64UrlSafe(array) {\r\n    const b64 = btoa(String.fromCharCode(...array));\r\n    return b64.replace(/\\+/g, '-').replace(/\\//g, '_');\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst VALID_FID_PATTERN = /^[cdef][\\w-]{21}$/;\r\nconst INVALID_FID = '';\r\n/**\r\n * Generates a new FID using random values from Web Crypto API.\r\n * Returns an empty string if FID generation fails for any reason.\r\n */\r\nfunction generateFid() {\r\n    try {\r\n        // A valid FID has exactly 22 base64 characters, which is 132 bits, or 16.5\r\n        // bytes. our implementation generates a 17 byte array instead.\r\n        const fidByteArray = new Uint8Array(17);\r\n        const crypto = self.crypto || self.msCrypto;\r\n        crypto.getRandomValues(fidByteArray);\r\n        // Replace the first 4 random bits with the constant FID header of 0b0111.\r\n        fidByteArray[0] = 0b01110000 + (fidByteArray[0] % 0b00010000);\r\n        const fid = encode(fidByteArray);\r\n        return VALID_FID_PATTERN.test(fid) ? fid : INVALID_FID;\r\n    }\r\n    catch (_a) {\r\n        // FID generation errored\r\n        return INVALID_FID;\r\n    }\r\n}\r\n/** Converts a FID Uint8Array to a base64 string representation. */\r\nfunction encode(fidByteArray) {\r\n    const b64String = bufferToBase64UrlSafe(fidByteArray);\r\n    // Remove the 23rd character that was added because of the extra 4 bits at the\r\n    // end of our 17 byte array, and the '=' padding.\r\n    return b64String.substr(0, 22);\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/** Returns a string key that can be used to identify the app. */\r\nfunction getKey(appConfig) {\r\n    return `${appConfig.appName}!${appConfig.appId}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst fidChangeCallbacks = new Map();\r\n/**\r\n * Calls the onIdChange callbacks with the new FID value, and broadcasts the\r\n * change to other tabs.\r\n */\r\nfunction fidChanged(appConfig, fid) {\r\n    const key = getKey(appConfig);\r\n    callFidChangeCallbacks(key, fid);\r\n    broadcastFidChange(key, fid);\r\n}\r\nfunction addCallback(appConfig, callback) {\r\n    // Open the broadcast channel if it's not already open,\r\n    // to be able to listen to change events from other tabs.\r\n    getBroadcastChannel();\r\n    const key = getKey(appConfig);\r\n    let callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        callbackSet = new Set();\r\n        fidChangeCallbacks.set(key, callbackSet);\r\n    }\r\n    callbackSet.add(callback);\r\n}\r\nfunction removeCallback(appConfig, callback) {\r\n    const key = getKey(appConfig);\r\n    const callbackSet = fidChangeCallbacks.get(key);\r\n    if (!callbackSet) {\r\n        return;\r\n    }\r\n    callbackSet.delete(callback);\r\n    if (callbackSet.size === 0) {\r\n        fidChangeCallbacks.delete(key);\r\n    }\r\n    // Close broadcast channel if there are no more callbacks.\r\n    closeBroadcastChannel();\r\n}\r\nfunction callFidChangeCallbacks(key, fid) {\r\n    const callbacks = fidChangeCallbacks.get(key);\r\n    if (!callbacks) {\r\n        return;\r\n    }\r\n    for (const callback of callbacks) {\r\n        callback(fid);\r\n    }\r\n}\r\nfunction broadcastFidChange(key, fid) {\r\n    const channel = getBroadcastChannel();\r\n    if (channel) {\r\n        channel.postMessage({ key, fid });\r\n    }\r\n    closeBroadcastChannel();\r\n}\r\nlet broadcastChannel = null;\r\n/** Opens and returns a BroadcastChannel if it is supported by the browser. */\r\nfunction getBroadcastChannel() {\r\n    if (!broadcastChannel && 'BroadcastChannel' in self) {\r\n        broadcastChannel = new BroadcastChannel('[Firebase] FID Change');\r\n        broadcastChannel.onmessage = e => {\r\n            callFidChangeCallbacks(e.data.key, e.data.fid);\r\n        };\r\n    }\r\n    return broadcastChannel;\r\n}\r\nfunction closeBroadcastChannel() {\r\n    if (fidChangeCallbacks.size === 0 && broadcastChannel) {\r\n        broadcastChannel.close();\r\n        broadcastChannel = null;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst DATABASE_NAME = 'firebase-installations-database';\r\nconst DATABASE_VERSION = 1;\r\nconst OBJECT_STORE_NAME = 'firebase-installations-store';\r\nlet dbPromise = null;\r\nfunction getDbPromise() {\r\n    if (!dbPromise) {\r\n        dbPromise = openDB(DATABASE_NAME, DATABASE_VERSION, {\r\n            upgrade: (db, oldVersion) => {\r\n                // We don't use 'break' in this switch statement, the fall-through\r\n                // behavior is what we want, because if there are multiple versions between\r\n                // the old version and the current version, we want ALL the migrations\r\n                // that correspond to those versions to run, not only the last one.\r\n                // eslint-disable-next-line default-case\r\n                switch (oldVersion) {\r\n                    case 0:\r\n                        db.createObjectStore(OBJECT_STORE_NAME);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return dbPromise;\r\n}\r\n/** Assigns or overwrites the record for the given key with the given value. */\r\nasync function set(appConfig, value) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    const objectStore = tx.objectStore(OBJECT_STORE_NAME);\r\n    const oldValue = (await objectStore.get(key));\r\n    await objectStore.put(value, key);\r\n    await tx.done;\r\n    if (!oldValue || oldValue.fid !== value.fid) {\r\n        fidChanged(appConfig, value.fid);\r\n    }\r\n    return value;\r\n}\r\n/** Removes record(s) from the objectStore that match the given key. */\r\nasync function remove(appConfig) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    await tx.objectStore(OBJECT_STORE_NAME).delete(key);\r\n    await tx.done;\r\n}\r\n/**\r\n * Atomically updates a record with the result of updateFn, which gets\r\n * called with the current value. If newValue is undefined, the record is\r\n * deleted instead.\r\n * @return Updated value\r\n */\r\nasync function update(appConfig, updateFn) {\r\n    const key = getKey(appConfig);\r\n    const db = await getDbPromise();\r\n    const tx = db.transaction(OBJECT_STORE_NAME, 'readwrite');\r\n    const store = tx.objectStore(OBJECT_STORE_NAME);\r\n    const oldValue = (await store.get(key));\r\n    const newValue = updateFn(oldValue);\r\n    if (newValue === undefined) {\r\n        await store.delete(key);\r\n    }\r\n    else {\r\n        await store.put(newValue, key);\r\n    }\r\n    await tx.done;\r\n    if (newValue && (!oldValue || oldValue.fid !== newValue.fid)) {\r\n        fidChanged(appConfig, newValue.fid);\r\n    }\r\n    return newValue;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Updates and returns the InstallationEntry from the database.\r\n * Also triggers a registration request if it is necessary and possible.\r\n */\r\nasync function getInstallationEntry(installations) {\r\n    let registrationPromise;\r\n    const installationEntry = await update(installations.appConfig, oldEntry => {\r\n        const installationEntry = updateOrCreateInstallationEntry(oldEntry);\r\n        const entryWithPromise = triggerRegistrationIfNecessary(installations, installationEntry);\r\n        registrationPromise = entryWithPromise.registrationPromise;\r\n        return entryWithPromise.installationEntry;\r\n    });\r\n    if (installationEntry.fid === INVALID_FID) {\r\n        // FID generation failed. Waiting for the FID from the server.\r\n        return { installationEntry: await registrationPromise };\r\n    }\r\n    return {\r\n        installationEntry,\r\n        registrationPromise\r\n    };\r\n}\r\n/**\r\n * Creates a new Installation Entry if one does not exist.\r\n * Also clears timed out pending requests.\r\n */\r\nfunction updateOrCreateInstallationEntry(oldEntry) {\r\n    const entry = oldEntry || {\r\n        fid: generateFid(),\r\n        registrationStatus: 0 /* RequestStatus.NOT_STARTED */\r\n    };\r\n    return clearTimedOutRequest(entry);\r\n}\r\n/**\r\n * If the Firebase Installation is not registered yet, this will trigger the\r\n * registration and return an InProgressInstallationEntry.\r\n *\r\n * If registrationPromise does not exist, the installationEntry is guaranteed\r\n * to be registered.\r\n */\r\nfunction triggerRegistrationIfNecessary(installations, installationEntry) {\r\n    if (installationEntry.registrationStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n        if (!navigator.onLine) {\r\n            // Registration required but app is offline.\r\n            const registrationPromiseWithError = Promise.reject(ERROR_FACTORY.create(\"app-offline\" /* ErrorCode.APP_OFFLINE */));\r\n            return {\r\n                installationEntry,\r\n                registrationPromise: registrationPromiseWithError\r\n            };\r\n        }\r\n        // Try registering. Change status to IN_PROGRESS.\r\n        const inProgressEntry = {\r\n            fid: installationEntry.fid,\r\n            registrationStatus: 1 /* RequestStatus.IN_PROGRESS */,\r\n            registrationTime: Date.now()\r\n        };\r\n        const registrationPromise = registerInstallation(installations, inProgressEntry);\r\n        return { installationEntry: inProgressEntry, registrationPromise };\r\n    }\r\n    else if (installationEntry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n        return {\r\n            installationEntry,\r\n            registrationPromise: waitUntilFidRegistration(installations)\r\n        };\r\n    }\r\n    else {\r\n        return { installationEntry };\r\n    }\r\n}\r\n/** This will be executed only once for each new Firebase Installation. */\r\nasync function registerInstallation(installations, installationEntry) {\r\n    try {\r\n        const registeredInstallationEntry = await createInstallationRequest(installations, installationEntry);\r\n        return set(installations.appConfig, registeredInstallationEntry);\r\n    }\r\n    catch (e) {\r\n        if (isServerError(e) && e.customData.serverCode === 409) {\r\n            // Server returned a \"FID can not be used\" error.\r\n            // Generate a new ID next time.\r\n            await remove(installations.appConfig);\r\n        }\r\n        else {\r\n            // Registration failed. Set FID as not registered.\r\n            await set(installations.appConfig, {\r\n                fid: installationEntry.fid,\r\n                registrationStatus: 0 /* RequestStatus.NOT_STARTED */\r\n            });\r\n        }\r\n        throw e;\r\n    }\r\n}\r\n/** Call if FID registration is pending in another request. */\r\nasync function waitUntilFidRegistration(installations) {\r\n    // Unfortunately, there is no way of reliably observing when a value in\r\n    // IndexedDB changes (yet, see https://github.com/WICG/indexed-db-observers),\r\n    // so we need to poll.\r\n    let entry = await updateInstallationRequest(installations.appConfig);\r\n    while (entry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n        // createInstallation request still in progress.\r\n        await sleep(100);\r\n        entry = await updateInstallationRequest(installations.appConfig);\r\n    }\r\n    if (entry.registrationStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n        // The request timed out or failed in a different call. Try again.\r\n        const { installationEntry, registrationPromise } = await getInstallationEntry(installations);\r\n        if (registrationPromise) {\r\n            return registrationPromise;\r\n        }\r\n        else {\r\n            // if there is no registrationPromise, entry is registered.\r\n            return installationEntry;\r\n        }\r\n    }\r\n    return entry;\r\n}\r\n/**\r\n * Called only if there is a CreateInstallation request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * CreateInstallation request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateInstallationRequest(appConfig) {\r\n    return update(appConfig, oldEntry => {\r\n        if (!oldEntry) {\r\n            throw ERROR_FACTORY.create(\"installation-not-found\" /* ErrorCode.INSTALLATION_NOT_FOUND */);\r\n        }\r\n        return clearTimedOutRequest(oldEntry);\r\n    });\r\n}\r\nfunction clearTimedOutRequest(entry) {\r\n    if (hasInstallationRequestTimedOut(entry)) {\r\n        return {\r\n            fid: entry.fid,\r\n            registrationStatus: 0 /* RequestStatus.NOT_STARTED */\r\n        };\r\n    }\r\n    return entry;\r\n}\r\nfunction hasInstallationRequestTimedOut(installationEntry) {\r\n    return (installationEntry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */ &&\r\n        installationEntry.registrationTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function generateAuthTokenRequest({ appConfig, heartbeatServiceProvider }, installationEntry) {\r\n    const endpoint = getGenerateAuthTokenEndpoint(appConfig, installationEntry);\r\n    const headers = getHeadersWithAuth(appConfig, installationEntry);\r\n    // If heartbeat service exists, add the heartbeat string to the header.\r\n    const heartbeatService = heartbeatServiceProvider.getImmediate({\r\n        optional: true\r\n    });\r\n    if (heartbeatService) {\r\n        const heartbeatsHeader = await heartbeatService.getHeartbeatsHeader();\r\n        if (heartbeatsHeader) {\r\n            headers.append('x-firebase-client', heartbeatsHeader);\r\n        }\r\n    }\r\n    const body = {\r\n        installation: {\r\n            sdkVersion: PACKAGE_VERSION,\r\n            appId: appConfig.appId\r\n        }\r\n    };\r\n    const request = {\r\n        method: 'POST',\r\n        headers,\r\n        body: JSON.stringify(body)\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (response.ok) {\r\n        const responseValue = await response.json();\r\n        const completedAuthToken = extractAuthTokenInfoFromResponse(responseValue);\r\n        return completedAuthToken;\r\n    }\r\n    else {\r\n        throw await getErrorFromResponse('Generate Auth Token', response);\r\n    }\r\n}\r\nfunction getGenerateAuthTokenEndpoint(appConfig, { fid }) {\r\n    return `${getInstallationsEndpoint(appConfig)}/${fid}/authTokens:generate`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a valid authentication token for the installation. Generates a new\r\n * token if one doesn't exist, is expired or about to expire.\r\n *\r\n * Should only be called if the Firebase Installation is registered.\r\n */\r\nasync function refreshAuthToken(installations, forceRefresh = false) {\r\n    let tokenPromise;\r\n    const entry = await update(installations.appConfig, oldEntry => {\r\n        if (!isEntryRegistered(oldEntry)) {\r\n            throw ERROR_FACTORY.create(\"not-registered\" /* ErrorCode.NOT_REGISTERED */);\r\n        }\r\n        const oldAuthToken = oldEntry.authToken;\r\n        if (!forceRefresh && isAuthTokenValid(oldAuthToken)) {\r\n            // There is a valid token in the DB.\r\n            return oldEntry;\r\n        }\r\n        else if (oldAuthToken.requestStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n            // There already is a token request in progress.\r\n            tokenPromise = waitUntilAuthTokenRequest(installations, forceRefresh);\r\n            return oldEntry;\r\n        }\r\n        else {\r\n            // No token or token expired.\r\n            if (!navigator.onLine) {\r\n                throw ERROR_FACTORY.create(\"app-offline\" /* ErrorCode.APP_OFFLINE */);\r\n            }\r\n            const inProgressEntry = makeAuthTokenRequestInProgressEntry(oldEntry);\r\n            tokenPromise = fetchAuthTokenFromServer(installations, inProgressEntry);\r\n            return inProgressEntry;\r\n        }\r\n    });\r\n    const authToken = tokenPromise\r\n        ? await tokenPromise\r\n        : entry.authToken;\r\n    return authToken;\r\n}\r\n/**\r\n * Call only if FID is registered and Auth Token request is in progress.\r\n *\r\n * Waits until the current pending request finishes. If the request times out,\r\n * tries once in this thread as well.\r\n */\r\nasync function waitUntilAuthTokenRequest(installations, forceRefresh) {\r\n    // Unfortunately, there is no way of reliably observing when a value in\r\n    // IndexedDB changes (yet, see https://github.com/WICG/indexed-db-observers),\r\n    // so we need to poll.\r\n    let entry = await updateAuthTokenRequest(installations.appConfig);\r\n    while (entry.authToken.requestStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n        // generateAuthToken still in progress.\r\n        await sleep(100);\r\n        entry = await updateAuthTokenRequest(installations.appConfig);\r\n    }\r\n    const authToken = entry.authToken;\r\n    if (authToken.requestStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n        // The request timed out or failed in a different call. Try again.\r\n        return refreshAuthToken(installations, forceRefresh);\r\n    }\r\n    else {\r\n        return authToken;\r\n    }\r\n}\r\n/**\r\n * Called only if there is a GenerateAuthToken request in progress.\r\n *\r\n * Updates the InstallationEntry in the DB based on the status of the\r\n * GenerateAuthToken request.\r\n *\r\n * Returns the updated InstallationEntry.\r\n */\r\nfunction updateAuthTokenRequest(appConfig) {\r\n    return update(appConfig, oldEntry => {\r\n        if (!isEntryRegistered(oldEntry)) {\r\n            throw ERROR_FACTORY.create(\"not-registered\" /* ErrorCode.NOT_REGISTERED */);\r\n        }\r\n        const oldAuthToken = oldEntry.authToken;\r\n        if (hasAuthTokenRequestTimedOut(oldAuthToken)) {\r\n            return Object.assign(Object.assign({}, oldEntry), { authToken: { requestStatus: 0 /* RequestStatus.NOT_STARTED */ } });\r\n        }\r\n        return oldEntry;\r\n    });\r\n}\r\nasync function fetchAuthTokenFromServer(installations, installationEntry) {\r\n    try {\r\n        const authToken = await generateAuthTokenRequest(installations, installationEntry);\r\n        const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken });\r\n        await set(installations.appConfig, updatedInstallationEntry);\r\n        return authToken;\r\n    }\r\n    catch (e) {\r\n        if (isServerError(e) &&\r\n            (e.customData.serverCode === 401 || e.customData.serverCode === 404)) {\r\n            // Server returned a \"FID not found\" or a \"Invalid authentication\" error.\r\n            // Generate a new ID next time.\r\n            await remove(installations.appConfig);\r\n        }\r\n        else {\r\n            const updatedInstallationEntry = Object.assign(Object.assign({}, installationEntry), { authToken: { requestStatus: 0 /* RequestStatus.NOT_STARTED */ } });\r\n            await set(installations.appConfig, updatedInstallationEntry);\r\n        }\r\n        throw e;\r\n    }\r\n}\r\nfunction isEntryRegistered(installationEntry) {\r\n    return (installationEntry !== undefined &&\r\n        installationEntry.registrationStatus === 2 /* RequestStatus.COMPLETED */);\r\n}\r\nfunction isAuthTokenValid(authToken) {\r\n    return (authToken.requestStatus === 2 /* RequestStatus.COMPLETED */ &&\r\n        !isAuthTokenExpired(authToken));\r\n}\r\nfunction isAuthTokenExpired(authToken) {\r\n    const now = Date.now();\r\n    return (now < authToken.creationTime ||\r\n        authToken.creationTime + authToken.expiresIn < now + TOKEN_EXPIRATION_BUFFER);\r\n}\r\n/** Returns an updated InstallationEntry with an InProgressAuthToken. */\r\nfunction makeAuthTokenRequestInProgressEntry(oldEntry) {\r\n    const inProgressAuthToken = {\r\n        requestStatus: 1 /* RequestStatus.IN_PROGRESS */,\r\n        requestTime: Date.now()\r\n    };\r\n    return Object.assign(Object.assign({}, oldEntry), { authToken: inProgressAuthToken });\r\n}\r\nfunction hasAuthTokenRequestTimedOut(authToken) {\r\n    return (authToken.requestStatus === 1 /* RequestStatus.IN_PROGRESS */ &&\r\n        authToken.requestTime + PENDING_TIMEOUT_MS < Date.now());\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Creates a Firebase Installation if there isn't one for the app and\r\n * returns the Installation ID.\r\n * @param installations - The `Installations` instance.\r\n *\r\n * @public\r\n */\r\nasync function getId(installations) {\r\n    const installationsImpl = installations;\r\n    const { installationEntry, registrationPromise } = await getInstallationEntry(installationsImpl);\r\n    if (registrationPromise) {\r\n        registrationPromise.catch(console.error);\r\n    }\r\n    else {\r\n        // If the installation is already registered, update the authentication\r\n        // token if needed.\r\n        refreshAuthToken(installationsImpl).catch(console.error);\r\n    }\r\n    return installationEntry.fid;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns a Firebase Installations auth token, identifying the current\r\n * Firebase Installation.\r\n * @param installations - The `Installations` instance.\r\n * @param forceRefresh - Force refresh regardless of token expiration.\r\n *\r\n * @public\r\n */\r\nasync function getToken(installations, forceRefresh = false) {\r\n    const installationsImpl = installations;\r\n    await completeInstallationRegistration(installationsImpl);\r\n    // At this point we either have a Registered Installation in the DB, or we've\r\n    // already thrown an error.\r\n    const authToken = await refreshAuthToken(installationsImpl, forceRefresh);\r\n    return authToken.token;\r\n}\r\nasync function completeInstallationRegistration(installations) {\r\n    const { registrationPromise } = await getInstallationEntry(installations);\r\n    if (registrationPromise) {\r\n        // A createInstallation request is in progress. Wait until it finishes.\r\n        await registrationPromise;\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function deleteInstallationRequest(appConfig, installationEntry) {\r\n    const endpoint = getDeleteEndpoint(appConfig, installationEntry);\r\n    const headers = getHeadersWithAuth(appConfig, installationEntry);\r\n    const request = {\r\n        method: 'DELETE',\r\n        headers\r\n    };\r\n    const response = await retryIfServerError(() => fetch(endpoint, request));\r\n    if (!response.ok) {\r\n        throw await getErrorFromResponse('Delete Installation', response);\r\n    }\r\n}\r\nfunction getDeleteEndpoint(appConfig, { fid }) {\r\n    return `${getInstallationsEndpoint(appConfig)}/${fid}`;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Deletes the Firebase Installation and all associated data.\r\n * @param installations - The `Installations` instance.\r\n *\r\n * @public\r\n */\r\nasync function deleteInstallations(installations) {\r\n    const { appConfig } = installations;\r\n    const entry = await update(appConfig, oldEntry => {\r\n        if (oldEntry && oldEntry.registrationStatus === 0 /* RequestStatus.NOT_STARTED */) {\r\n            // Delete the unregistered entry without sending a deleteInstallation request.\r\n            return undefined;\r\n        }\r\n        return oldEntry;\r\n    });\r\n    if (entry) {\r\n        if (entry.registrationStatus === 1 /* RequestStatus.IN_PROGRESS */) {\r\n            // Can't delete while trying to register.\r\n            throw ERROR_FACTORY.create(\"delete-pending-registration\" /* ErrorCode.DELETE_PENDING_REGISTRATION */);\r\n        }\r\n        else if (entry.registrationStatus === 2 /* RequestStatus.COMPLETED */) {\r\n            if (!navigator.onLine) {\r\n                throw ERROR_FACTORY.create(\"app-offline\" /* ErrorCode.APP_OFFLINE */);\r\n            }\r\n            else {\r\n                await deleteInstallationRequest(appConfig, entry);\r\n                await remove(appConfig);\r\n            }\r\n        }\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Sets a new callback that will get called when Installation ID changes.\r\n * Returns an unsubscribe function that will remove the callback when called.\r\n * @param installations - The `Installations` instance.\r\n * @param callback - The callback function that is invoked when FID changes.\r\n * @returns A function that can be called to unsubscribe.\r\n *\r\n * @public\r\n */\r\nfunction onIdChange(installations, callback) {\r\n    const { appConfig } = installations;\r\n    addCallback(appConfig, callback);\r\n    return () => {\r\n        removeCallback(appConfig, callback);\r\n    };\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Returns an instance of {@link Installations} associated with the given\r\n * {@link @firebase/app#FirebaseApp} instance.\r\n * @param app - The {@link @firebase/app#FirebaseApp} instance.\r\n *\r\n * @public\r\n */\r\nfunction getInstallations(app = getApp()) {\r\n    const installationsImpl = _getProvider(app, 'installations').getImmediate();\r\n    return installationsImpl;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction extractAppConfig(app) {\r\n    if (!app || !app.options) {\r\n        throw getMissingValueError('App Configuration');\r\n    }\r\n    if (!app.name) {\r\n        throw getMissingValueError('App Name');\r\n    }\r\n    // Required app config keys\r\n    const configKeys = [\r\n        'projectId',\r\n        'apiKey',\r\n        'appId'\r\n    ];\r\n    for (const keyName of configKeys) {\r\n        if (!app.options[keyName]) {\r\n            throw getMissingValueError(keyName);\r\n        }\r\n    }\r\n    return {\r\n        appName: app.name,\r\n        projectId: app.options.projectId,\r\n        apiKey: app.options.apiKey,\r\n        appId: app.options.appId\r\n    };\r\n}\r\nfunction getMissingValueError(valueName) {\r\n    return ERROR_FACTORY.create(\"missing-app-config-values\" /* ErrorCode.MISSING_APP_CONFIG_VALUES */, {\r\n        valueName\r\n    });\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst INSTALLATIONS_NAME = 'installations';\r\nconst INSTALLATIONS_NAME_INTERNAL = 'installations-internal';\r\nconst publicFactory = (container) => {\r\n    const app = container.getProvider('app').getImmediate();\r\n    // Throws if app isn't configured properly.\r\n    const appConfig = extractAppConfig(app);\r\n    const heartbeatServiceProvider = _getProvider(app, 'heartbeat');\r\n    const installationsImpl = {\r\n        app,\r\n        appConfig,\r\n        heartbeatServiceProvider,\r\n        _delete: () => Promise.resolve()\r\n    };\r\n    return installationsImpl;\r\n};\r\nconst internalFactory = (container) => {\r\n    const app = container.getProvider('app').getImmediate();\r\n    // Internal FIS instance relies on public FIS instance.\r\n    const installations = _getProvider(app, INSTALLATIONS_NAME).getImmediate();\r\n    const installationsInternal = {\r\n        getId: () => getId(installations),\r\n        getToken: (forceRefresh) => getToken(installations, forceRefresh)\r\n    };\r\n    return installationsInternal;\r\n};\r\nfunction registerInstallations() {\r\n    _registerComponent(new Component(INSTALLATIONS_NAME, publicFactory, \"PUBLIC\" /* ComponentType.PUBLIC */));\r\n    _registerComponent(new Component(INSTALLATIONS_NAME_INTERNAL, internalFactory, \"PRIVATE\" /* ComponentType.PRIVATE */));\r\n}\n\n/**\r\n * Firebase Installations\r\n *\r\n * @packageDocumentation\r\n */\r\nregisterInstallations();\r\nregisterVersion(name, version);\r\n// BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\nregisterVersion(name, version, 'esm2017');\n\nexport { deleteInstallations, getId, getInstallations, getToken, onIdChange };\n//# sourceMappingURL=index.esm2017.js.map\n","import { _getProvider, getApp, _registerComponent, registerVersion } from '@firebase/app';\nimport { Logger } from '@firebase/logger';\nimport { ErrorFactory, calculateBackoffMillis, FirebaseError, isIndexedDBAvailable, validateIndexedDBOpenable, isBrowserExtension, areCookiesEnabled, getModularInstance, deepEqual } from '@firebase/util';\nimport { Component } from '@firebase/component';\nimport '@firebase/installations';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Type constant for Firebase Analytics.\r\n */\r\nconst ANALYTICS_TYPE = 'analytics';\r\n// Key to attach FID to in gtag params.\r\nconst GA_FID_KEY = 'firebase_id';\r\nconst ORIGIN_KEY = 'origin';\r\nconst FETCH_TIMEOUT_MILLIS = 60 * 1000;\r\nconst DYNAMIC_CONFIG_URL = 'https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig';\r\nconst GTAG_URL = 'https://www.googletagmanager.com/gtag/js';\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst logger = new Logger('@firebase/analytics');\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nconst ERRORS = {\r\n    [\"already-exists\" /* AnalyticsError.ALREADY_EXISTS */]: 'A Firebase Analytics instance with the appId {$id} ' +\r\n        ' already exists. ' +\r\n        'Only one Firebase Analytics instance can be created for each appId.',\r\n    [\"already-initialized\" /* AnalyticsError.ALREADY_INITIALIZED */]: 'initializeAnalytics() cannot be called again with different options than those ' +\r\n        'it was initially called with. It can be called again with the same options to ' +\r\n        'return the existing instance, or getAnalytics() can be used ' +\r\n        'to get a reference to the already-intialized instance.',\r\n    [\"already-initialized-settings\" /* AnalyticsError.ALREADY_INITIALIZED_SETTINGS */]: 'Firebase Analytics has already been initialized.' +\r\n        'settings() must be called before initializing any Analytics instance' +\r\n        'or it will have no effect.',\r\n    [\"interop-component-reg-failed\" /* AnalyticsError.INTEROP_COMPONENT_REG_FAILED */]: 'Firebase Analytics Interop Component failed to instantiate: {$reason}',\r\n    [\"invalid-analytics-context\" /* AnalyticsError.INVALID_ANALYTICS_CONTEXT */]: 'Firebase Analytics is not supported in this environment. ' +\r\n        'Wrap initialization of analytics in analytics.isSupported() ' +\r\n        'to prevent initialization in unsupported environments. Details: {$errorInfo}',\r\n    [\"indexeddb-unavailable\" /* AnalyticsError.INDEXEDDB_UNAVAILABLE */]: 'IndexedDB unavailable or restricted in this environment. ' +\r\n        'Wrap initialization of analytics in analytics.isSupported() ' +\r\n        'to prevent initialization in unsupported environments. Details: {$errorInfo}',\r\n    [\"fetch-throttle\" /* AnalyticsError.FETCH_THROTTLE */]: 'The config fetch request timed out while in an exponential backoff state.' +\r\n        ' Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',\r\n    [\"config-fetch-failed\" /* AnalyticsError.CONFIG_FETCH_FAILED */]: 'Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}',\r\n    [\"no-api-key\" /* AnalyticsError.NO_API_KEY */]: 'The \"apiKey\" field is empty in the local Firebase config. Firebase Analytics requires this field to' +\r\n        'contain a valid API key.',\r\n    [\"no-app-id\" /* AnalyticsError.NO_APP_ID */]: 'The \"appId\" field is empty in the local Firebase config. Firebase Analytics requires this field to' +\r\n        'contain a valid app ID.',\r\n    [\"no-client-id\" /* AnalyticsError.NO_CLIENT_ID */]: 'The \"client_id\" field is empty.',\r\n    [\"invalid-gtag-resource\" /* AnalyticsError.INVALID_GTAG_RESOURCE */]: 'Trusted Types detected an invalid gtag resource: {$gtagURL}.'\r\n};\r\nconst ERROR_FACTORY = new ErrorFactory('analytics', 'Analytics', ERRORS);\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Verifies and creates a TrustedScriptURL.\r\n */\r\nfunction createGtagTrustedTypesScriptURL(url) {\r\n    if (!url.startsWith(GTAG_URL)) {\r\n        const err = ERROR_FACTORY.create(\"invalid-gtag-resource\" /* AnalyticsError.INVALID_GTAG_RESOURCE */, {\r\n            gtagURL: url\r\n        });\r\n        logger.warn(err.message);\r\n        return '';\r\n    }\r\n    return url;\r\n}\r\n/**\r\n * Makeshift polyfill for Promise.allSettled(). Resolves when all promises\r\n * have either resolved or rejected.\r\n *\r\n * @param promises Array of promises to wait for.\r\n */\r\nfunction promiseAllSettled(promises) {\r\n    return Promise.all(promises.map(promise => promise.catch(e => e)));\r\n}\r\n/**\r\n * Creates a TrustedTypePolicy object that implements the rules passed as policyOptions.\r\n *\r\n * @param policyName A string containing the name of the policy\r\n * @param policyOptions Object containing implementations of instance methods for TrustedTypesPolicy, see {@link https://developer.mozilla.org/en-US/docs/Web/API/TrustedTypePolicy#instance_methods\r\n * | the TrustedTypePolicy reference documentation}.\r\n */\r\nfunction createTrustedTypesPolicy(policyName, policyOptions) {\r\n    // Create a TrustedTypes policy that we can use for updating src\r\n    // properties\r\n    let trustedTypesPolicy;\r\n    if (window.trustedTypes) {\r\n        trustedTypesPolicy = window.trustedTypes.createPolicy(policyName, policyOptions);\r\n    }\r\n    return trustedTypesPolicy;\r\n}\r\n/**\r\n * Inserts gtag script tag into the page to asynchronously download gtag.\r\n * @param dataLayerName Name of datalayer (most often the default, \"_dataLayer\").\r\n */\r\nfunction insertScriptTag(dataLayerName, measurementId) {\r\n    const trustedTypesPolicy = createTrustedTypesPolicy('firebase-js-sdk-policy', {\r\n        createScriptURL: createGtagTrustedTypesScriptURL\r\n    });\r\n    const script = document.createElement('script');\r\n    // We are not providing an analyticsId in the URL because it would trigger a `page_view`\r\n    // without fid. We will initialize ga-id using gtag (config) command together with fid.\r\n    const gtagScriptURL = `${GTAG_URL}?l=${dataLayerName}&id=${measurementId}`;\r\n    script.src = trustedTypesPolicy\r\n        ? trustedTypesPolicy === null || trustedTypesPolicy === void 0 ? void 0 : trustedTypesPolicy.createScriptURL(gtagScriptURL)\r\n        : gtagScriptURL;\r\n    script.async = true;\r\n    document.head.appendChild(script);\r\n}\r\n/**\r\n * Get reference to, or create, global datalayer.\r\n * @param dataLayerName Name of datalayer (most often the default, \"_dataLayer\").\r\n */\r\nfunction getOrCreateDataLayer(dataLayerName) {\r\n    // Check for existing dataLayer and create if needed.\r\n    let dataLayer = [];\r\n    if (Array.isArray(window[dataLayerName])) {\r\n        dataLayer = window[dataLayerName];\r\n    }\r\n    else {\r\n        window[dataLayerName] = dataLayer;\r\n    }\r\n    return dataLayer;\r\n}\r\n/**\r\n * Wrapped gtag logic when gtag is called with 'config' command.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n * @param measurementId GA Measurement ID to set config for.\r\n * @param gtagParams Gtag config params to set.\r\n */\r\nasync function gtagOnConfig(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, measurementId, gtagParams) {\r\n    // If config is already fetched, we know the appId and can use it to look up what FID promise we\r\n    /// are waiting for, and wait only on that one.\r\n    const correspondingAppId = measurementIdToAppId[measurementId];\r\n    try {\r\n        if (correspondingAppId) {\r\n            await initializationPromisesMap[correspondingAppId];\r\n        }\r\n        else {\r\n            // If config is not fetched yet, wait for all configs (we don't know which one we need) and\r\n            // find the appId (if any) corresponding to this measurementId. If there is one, wait on\r\n            // that appId's initialization promise. If there is none, promise resolves and gtag\r\n            // call goes through.\r\n            const dynamicConfigResults = await promiseAllSettled(dynamicConfigPromisesList);\r\n            const foundConfig = dynamicConfigResults.find(config => config.measurementId === measurementId);\r\n            if (foundConfig) {\r\n                await initializationPromisesMap[foundConfig.appId];\r\n            }\r\n        }\r\n    }\r\n    catch (e) {\r\n        logger.error(e);\r\n    }\r\n    gtagCore(\"config\" /* GtagCommand.CONFIG */, measurementId, gtagParams);\r\n}\r\n/**\r\n * Wrapped gtag logic when gtag is called with 'event' command.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementId GA Measurement ID to log event to.\r\n * @param gtagParams Params to log with this event.\r\n */\r\nasync function gtagOnEvent(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementId, gtagParams) {\r\n    try {\r\n        let initializationPromisesToWaitFor = [];\r\n        // If there's a 'send_to' param, check if any ID specified matches\r\n        // an initializeIds() promise we are waiting for.\r\n        if (gtagParams && gtagParams['send_to']) {\r\n            let gaSendToList = gtagParams['send_to'];\r\n            // Make it an array if is isn't, so it can be dealt with the same way.\r\n            if (!Array.isArray(gaSendToList)) {\r\n                gaSendToList = [gaSendToList];\r\n            }\r\n            // Checking 'send_to' fields requires having all measurement ID results back from\r\n            // the dynamic config fetch.\r\n            const dynamicConfigResults = await promiseAllSettled(dynamicConfigPromisesList);\r\n            for (const sendToId of gaSendToList) {\r\n                // Any fetched dynamic measurement ID that matches this 'send_to' ID\r\n                const foundConfig = dynamicConfigResults.find(config => config.measurementId === sendToId);\r\n                const initializationPromise = foundConfig && initializationPromisesMap[foundConfig.appId];\r\n                if (initializationPromise) {\r\n                    initializationPromisesToWaitFor.push(initializationPromise);\r\n                }\r\n                else {\r\n                    // Found an item in 'send_to' that is not associated\r\n                    // directly with an FID, possibly a group.  Empty this array,\r\n                    // exit the loop early, and let it get populated below.\r\n                    initializationPromisesToWaitFor = [];\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        // This will be unpopulated if there was no 'send_to' field , or\r\n        // if not all entries in the 'send_to' field could be mapped to\r\n        // a FID. In these cases, wait on all pending initialization promises.\r\n        if (initializationPromisesToWaitFor.length === 0) {\r\n            initializationPromisesToWaitFor = Object.values(initializationPromisesMap);\r\n        }\r\n        // Run core gtag function with args after all relevant initialization\r\n        // promises have been resolved.\r\n        await Promise.all(initializationPromisesToWaitFor);\r\n        // Workaround for http://b/141370449 - third argument cannot be undefined.\r\n        gtagCore(\"event\" /* GtagCommand.EVENT */, measurementId, gtagParams || {});\r\n    }\r\n    catch (e) {\r\n        logger.error(e);\r\n    }\r\n}\r\n/**\r\n * Wraps a standard gtag function with extra code to wait for completion of\r\n * relevant initialization promises before sending requests.\r\n *\r\n * @param gtagCore Basic gtag function that just appends to dataLayer.\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n */\r\nfunction wrapGtag(gtagCore, \r\n/**\r\n * Allows wrapped gtag calls to wait on whichever intialization promises are required,\r\n * depending on the contents of the gtag params' `send_to` field, if any.\r\n */\r\ninitializationPromisesMap, \r\n/**\r\n * Wrapped gtag calls sometimes require all dynamic config fetches to have returned\r\n * before determining what initialization promises (which include FIDs) to wait for.\r\n */\r\ndynamicConfigPromisesList, \r\n/**\r\n * Wrapped gtag config calls can narrow down which initialization promise (with FID)\r\n * to wait for if the measurementId is already fetched, by getting the corresponding appId,\r\n * which is the key for the initialization promises map.\r\n */\r\nmeasurementIdToAppId) {\r\n    /**\r\n     * Wrapper around gtag that ensures FID is sent with gtag calls.\r\n     * @param command Gtag command type.\r\n     * @param idOrNameOrParams Measurement ID if command is EVENT/CONFIG, params if command is SET.\r\n     * @param gtagParams Params if event is EVENT/CONFIG.\r\n     */\r\n    async function gtagWrapper(command, ...args) {\r\n        try {\r\n            // If event, check that relevant initialization promises have completed.\r\n            if (command === \"event\" /* GtagCommand.EVENT */) {\r\n                const [measurementId, gtagParams] = args;\r\n                // If EVENT, second arg must be measurementId.\r\n                await gtagOnEvent(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementId, gtagParams);\r\n            }\r\n            else if (command === \"config\" /* GtagCommand.CONFIG */) {\r\n                const [measurementId, gtagParams] = args;\r\n                // If CONFIG, second arg must be measurementId.\r\n                await gtagOnConfig(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, measurementId, gtagParams);\r\n            }\r\n            else if (command === \"consent\" /* GtagCommand.CONSENT */) {\r\n                const [gtagParams] = args;\r\n                gtagCore(\"consent\" /* GtagCommand.CONSENT */, 'update', gtagParams);\r\n            }\r\n            else if (command === \"get\" /* GtagCommand.GET */) {\r\n                const [measurementId, fieldName, callback] = args;\r\n                gtagCore(\"get\" /* GtagCommand.GET */, measurementId, fieldName, callback);\r\n            }\r\n            else if (command === \"set\" /* GtagCommand.SET */) {\r\n                const [customParams] = args;\r\n                // If SET, second arg must be params.\r\n                gtagCore(\"set\" /* GtagCommand.SET */, customParams);\r\n            }\r\n            else {\r\n                gtagCore(command, ...args);\r\n            }\r\n        }\r\n        catch (e) {\r\n            logger.error(e);\r\n        }\r\n    }\r\n    return gtagWrapper;\r\n}\r\n/**\r\n * Creates global gtag function or wraps existing one if found.\r\n * This wrapped function attaches Firebase instance ID (FID) to gtag 'config' and\r\n * 'event' calls that belong to the GAID associated with this Firebase instance.\r\n *\r\n * @param initializationPromisesMap Map of appIds to their initialization promises.\r\n * @param dynamicConfigPromisesList Array of dynamic config fetch promises.\r\n * @param measurementIdToAppId Map of GA measurementIDs to corresponding Firebase appId.\r\n * @param dataLayerName Name of global GA datalayer array.\r\n * @param gtagFunctionName Name of global gtag function (\"gtag\" if not user-specified).\r\n */\r\nfunction wrapOrCreateGtag(initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, dataLayerName, gtagFunctionName) {\r\n    // Create a basic core gtag function\r\n    let gtagCore = function (..._args) {\r\n        // Must push IArguments object, not an array.\r\n        window[dataLayerName].push(arguments);\r\n    };\r\n    // Replace it with existing one if found\r\n    if (window[gtagFunctionName] &&\r\n        typeof window[gtagFunctionName] === 'function') {\r\n        // @ts-ignore\r\n        gtagCore = window[gtagFunctionName];\r\n    }\r\n    window[gtagFunctionName] = wrapGtag(gtagCore, initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId);\r\n    return {\r\n        gtagCore,\r\n        wrappedGtag: window[gtagFunctionName]\r\n    };\r\n}\r\n/**\r\n * Returns the script tag in the DOM matching both the gtag url pattern\r\n * and the provided data layer name.\r\n */\r\nfunction findGtagScriptOnPage(dataLayerName) {\r\n    const scriptTags = window.document.getElementsByTagName('script');\r\n    for (const tag of Object.values(scriptTags)) {\r\n        if (tag.src &&\r\n            tag.src.includes(GTAG_URL) &&\r\n            tag.src.includes(dataLayerName)) {\r\n            return tag;\r\n        }\r\n    }\r\n    return null;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Backoff factor for 503 errors, which we want to be conservative about\r\n * to avoid overloading servers. Each retry interval will be\r\n * BASE_INTERVAL_MILLIS * LONG_RETRY_FACTOR ^ retryCount, so the second one\r\n * will be ~30 seconds (with fuzzing).\r\n */\r\nconst LONG_RETRY_FACTOR = 30;\r\n/**\r\n * Base wait interval to multiplied by backoffFactor^backoffCount.\r\n */\r\nconst BASE_INTERVAL_MILLIS = 1000;\r\n/**\r\n * Stubbable retry data storage class.\r\n */\r\nclass RetryData {\r\n    constructor(throttleMetadata = {}, intervalMillis = BASE_INTERVAL_MILLIS) {\r\n        this.throttleMetadata = throttleMetadata;\r\n        this.intervalMillis = intervalMillis;\r\n    }\r\n    getThrottleMetadata(appId) {\r\n        return this.throttleMetadata[appId];\r\n    }\r\n    setThrottleMetadata(appId, metadata) {\r\n        this.throttleMetadata[appId] = metadata;\r\n    }\r\n    deleteThrottleMetadata(appId) {\r\n        delete this.throttleMetadata[appId];\r\n    }\r\n}\r\nconst defaultRetryData = new RetryData();\r\n/**\r\n * Set GET request headers.\r\n * @param apiKey App API key.\r\n */\r\nfunction getHeaders(apiKey) {\r\n    return new Headers({\r\n        Accept: 'application/json',\r\n        'x-goog-api-key': apiKey\r\n    });\r\n}\r\n/**\r\n * Fetches dynamic config from backend.\r\n * @param app Firebase app to fetch config for.\r\n */\r\nasync function fetchDynamicConfig(appFields) {\r\n    var _a;\r\n    const { appId, apiKey } = appFields;\r\n    const request = {\r\n        method: 'GET',\r\n        headers: getHeaders(apiKey)\r\n    };\r\n    const appUrl = DYNAMIC_CONFIG_URL.replace('{app-id}', appId);\r\n    const response = await fetch(appUrl, request);\r\n    if (response.status !== 200 && response.status !== 304) {\r\n        let errorMessage = '';\r\n        try {\r\n            // Try to get any error message text from server response.\r\n            const jsonResponse = (await response.json());\r\n            if ((_a = jsonResponse.error) === null || _a === void 0 ? void 0 : _a.message) {\r\n                errorMessage = jsonResponse.error.message;\r\n            }\r\n        }\r\n        catch (_ignored) { }\r\n        throw ERROR_FACTORY.create(\"config-fetch-failed\" /* AnalyticsError.CONFIG_FETCH_FAILED */, {\r\n            httpStatus: response.status,\r\n            responseMessage: errorMessage\r\n        });\r\n    }\r\n    return response.json();\r\n}\r\n/**\r\n * Fetches dynamic config from backend, retrying if failed.\r\n * @param app Firebase app to fetch config for.\r\n */\r\nasync function fetchDynamicConfigWithRetry(app, \r\n// retryData and timeoutMillis are parameterized to allow passing a different value for testing.\r\nretryData = defaultRetryData, timeoutMillis) {\r\n    const { appId, apiKey, measurementId } = app.options;\r\n    if (!appId) {\r\n        throw ERROR_FACTORY.create(\"no-app-id\" /* AnalyticsError.NO_APP_ID */);\r\n    }\r\n    if (!apiKey) {\r\n        if (measurementId) {\r\n            return {\r\n                measurementId,\r\n                appId\r\n            };\r\n        }\r\n        throw ERROR_FACTORY.create(\"no-api-key\" /* AnalyticsError.NO_API_KEY */);\r\n    }\r\n    const throttleMetadata = retryData.getThrottleMetadata(appId) || {\r\n        backoffCount: 0,\r\n        throttleEndTimeMillis: Date.now()\r\n    };\r\n    const signal = new AnalyticsAbortSignal();\r\n    setTimeout(async () => {\r\n        // Note a very low delay, eg < 10ms, can elapse before listeners are initialized.\r\n        signal.abort();\r\n    }, timeoutMillis !== undefined ? timeoutMillis : FETCH_TIMEOUT_MILLIS);\r\n    return attemptFetchDynamicConfigWithRetry({ appId, apiKey, measurementId }, throttleMetadata, signal, retryData);\r\n}\r\n/**\r\n * Runs one retry attempt.\r\n * @param appFields Necessary app config fields.\r\n * @param throttleMetadata Ongoing metadata to determine throttling times.\r\n * @param signal Abort signal.\r\n */\r\nasync function attemptFetchDynamicConfigWithRetry(appFields, { throttleEndTimeMillis, backoffCount }, signal, retryData = defaultRetryData // for testing\r\n) {\r\n    var _a;\r\n    const { appId, measurementId } = appFields;\r\n    // Starts with a (potentially zero) timeout to support resumption from stored state.\r\n    // Ensures the throttle end time is honored if the last attempt timed out.\r\n    // Note the SDK will never make a request if the fetch timeout expires at this point.\r\n    try {\r\n        await setAbortableTimeout(signal, throttleEndTimeMillis);\r\n    }\r\n    catch (e) {\r\n        if (measurementId) {\r\n            logger.warn(`Timed out fetching this Firebase app's measurement ID from the server.` +\r\n                ` Falling back to the measurement ID ${measurementId}` +\r\n                ` provided in the \"measurementId\" field in the local Firebase config. [${e === null || e === void 0 ? void 0 : e.message}]`);\r\n            return { appId, measurementId };\r\n        }\r\n        throw e;\r\n    }\r\n    try {\r\n        const response = await fetchDynamicConfig(appFields);\r\n        // Note the SDK only clears throttle state if response is success or non-retriable.\r\n        retryData.deleteThrottleMetadata(appId);\r\n        return response;\r\n    }\r\n    catch (e) {\r\n        const error = e;\r\n        if (!isRetriableError(error)) {\r\n            retryData.deleteThrottleMetadata(appId);\r\n            if (measurementId) {\r\n                logger.warn(`Failed to fetch this Firebase app's measurement ID from the server.` +\r\n                    ` Falling back to the measurement ID ${measurementId}` +\r\n                    ` provided in the \"measurementId\" field in the local Firebase config. [${error === null || error === void 0 ? void 0 : error.message}]`);\r\n                return { appId, measurementId };\r\n            }\r\n            else {\r\n                throw e;\r\n            }\r\n        }\r\n        const backoffMillis = Number((_a = error === null || error === void 0 ? void 0 : error.customData) === null || _a === void 0 ? void 0 : _a.httpStatus) === 503\r\n            ? calculateBackoffMillis(backoffCount, retryData.intervalMillis, LONG_RETRY_FACTOR)\r\n            : calculateBackoffMillis(backoffCount, retryData.intervalMillis);\r\n        // Increments backoff state.\r\n        const throttleMetadata = {\r\n            throttleEndTimeMillis: Date.now() + backoffMillis,\r\n            backoffCount: backoffCount + 1\r\n        };\r\n        // Persists state.\r\n        retryData.setThrottleMetadata(appId, throttleMetadata);\r\n        logger.debug(`Calling attemptFetch again in ${backoffMillis} millis`);\r\n        return attemptFetchDynamicConfigWithRetry(appFields, throttleMetadata, signal, retryData);\r\n    }\r\n}\r\n/**\r\n * Supports waiting on a backoff by:\r\n *\r\n * <ul>\r\n *   <li>Promisifying setTimeout, so we can set a timeout in our Promise chain</li>\r\n *   <li>Listening on a signal bus for abort events, just like the Fetch API</li>\r\n *   <li>Failing in the same way the Fetch API fails, so timing out a live request and a throttled\r\n *       request appear the same.</li>\r\n * </ul>\r\n *\r\n * <p>Visible for testing.\r\n */\r\nfunction setAbortableTimeout(signal, throttleEndTimeMillis) {\r\n    return new Promise((resolve, reject) => {\r\n        // Derives backoff from given end time, normalizing negative numbers to zero.\r\n        const backoffMillis = Math.max(throttleEndTimeMillis - Date.now(), 0);\r\n        const timeout = setTimeout(resolve, backoffMillis);\r\n        // Adds listener, rather than sets onabort, because signal is a shared object.\r\n        signal.addEventListener(() => {\r\n            clearTimeout(timeout);\r\n            // If the request completes before this timeout, the rejection has no effect.\r\n            reject(ERROR_FACTORY.create(\"fetch-throttle\" /* AnalyticsError.FETCH_THROTTLE */, {\r\n                throttleEndTimeMillis\r\n            }));\r\n        });\r\n    });\r\n}\r\n/**\r\n * Returns true if the {@link Error} indicates a fetch request may succeed later.\r\n */\r\nfunction isRetriableError(e) {\r\n    if (!(e instanceof FirebaseError) || !e.customData) {\r\n        return false;\r\n    }\r\n    // Uses string index defined by ErrorData, which FirebaseError implements.\r\n    const httpStatus = Number(e.customData['httpStatus']);\r\n    return (httpStatus === 429 ||\r\n        httpStatus === 500 ||\r\n        httpStatus === 503 ||\r\n        httpStatus === 504);\r\n}\r\n/**\r\n * Shims a minimal AbortSignal (copied from Remote Config).\r\n *\r\n * <p>AbortController's AbortSignal conveniently decouples fetch timeout logic from other aspects\r\n * of networking, such as retries. Firebase doesn't use AbortController enough to justify a\r\n * polyfill recommendation, like we do with the Fetch API, but this minimal shim can easily be\r\n * swapped out if/when we do.\r\n */\r\nclass AnalyticsAbortSignal {\r\n    constructor() {\r\n        this.listeners = [];\r\n    }\r\n    addEventListener(listener) {\r\n        this.listeners.push(listener);\r\n    }\r\n    abort() {\r\n        this.listeners.forEach(listener => listener());\r\n    }\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Event parameters to set on 'gtag' during initialization.\r\n */\r\nlet defaultEventParametersForInit;\r\n/**\r\n * Logs an analytics event through the Firebase SDK.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param eventName Google Analytics event name, choose from standard list or use a custom string.\r\n * @param eventParams Analytics event parameters.\r\n */\r\nasync function logEvent$1(gtagFunction, initializationPromise, eventName, eventParams, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(\"event\" /* GtagCommand.EVENT */, eventName, eventParams);\r\n        return;\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        const params = Object.assign(Object.assign({}, eventParams), { 'send_to': measurementId });\r\n        gtagFunction(\"event\" /* GtagCommand.EVENT */, eventName, params);\r\n    }\r\n}\r\n/**\r\n * Set screen_name parameter for this Google Analytics ID.\r\n *\r\n * @deprecated Use {@link logEvent} with `eventName` as 'screen_view' and add relevant `eventParams`.\r\n * See {@link https://firebase.google.com/docs/analytics/screenviews | Track Screenviews}.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param screenName Screen name string to set.\r\n */\r\nasync function setCurrentScreen$1(gtagFunction, initializationPromise, screenName, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(\"set\" /* GtagCommand.SET */, { 'screen_name': screenName });\r\n        return Promise.resolve();\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        gtagFunction(\"config\" /* GtagCommand.CONFIG */, measurementId, {\r\n            update: true,\r\n            'screen_name': screenName\r\n        });\r\n    }\r\n}\r\n/**\r\n * Set user_id parameter for this Google Analytics ID.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param id User ID string to set\r\n */\r\nasync function setUserId$1(gtagFunction, initializationPromise, id, options) {\r\n    if (options && options.global) {\r\n        gtagFunction(\"set\" /* GtagCommand.SET */, { 'user_id': id });\r\n        return Promise.resolve();\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        gtagFunction(\"config\" /* GtagCommand.CONFIG */, measurementId, {\r\n            update: true,\r\n            'user_id': id\r\n        });\r\n    }\r\n}\r\n/**\r\n * Set all other user properties other than user_id and screen_name.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n * @param properties Map of user properties to set\r\n */\r\nasync function setUserProperties$1(gtagFunction, initializationPromise, properties, options) {\r\n    if (options && options.global) {\r\n        const flatProperties = {};\r\n        for (const key of Object.keys(properties)) {\r\n            // use dot notation for merge behavior in gtag.js\r\n            flatProperties[`user_properties.${key}`] = properties[key];\r\n        }\r\n        gtagFunction(\"set\" /* GtagCommand.SET */, flatProperties);\r\n        return Promise.resolve();\r\n    }\r\n    else {\r\n        const measurementId = await initializationPromise;\r\n        gtagFunction(\"config\" /* GtagCommand.CONFIG */, measurementId, {\r\n            update: true,\r\n            'user_properties': properties\r\n        });\r\n    }\r\n}\r\n/**\r\n * Retrieves a unique Google Analytics identifier for the web client.\r\n * See {@link https://developers.google.com/analytics/devguides/collection/ga4/reference/config#client_id | client_id}.\r\n *\r\n * @param gtagFunction Wrapped gtag function that waits for fid to be set before sending an event\r\n */\r\nasync function internalGetGoogleAnalyticsClientId(gtagFunction, initializationPromise) {\r\n    const measurementId = await initializationPromise;\r\n    return new Promise((resolve, reject) => {\r\n        gtagFunction(\"get\" /* GtagCommand.GET */, measurementId, 'client_id', (clientId) => {\r\n            if (!clientId) {\r\n                reject(ERROR_FACTORY.create(\"no-client-id\" /* AnalyticsError.NO_CLIENT_ID */));\r\n            }\r\n            resolve(clientId);\r\n        });\r\n    });\r\n}\r\n/**\r\n * Set whether collection is enabled for this ID.\r\n *\r\n * @param enabled If true, collection is enabled for this ID.\r\n */\r\nasync function setAnalyticsCollectionEnabled$1(initializationPromise, enabled) {\r\n    const measurementId = await initializationPromise;\r\n    window[`ga-disable-${measurementId}`] = !enabled;\r\n}\r\n/**\r\n * Consent parameters to default to during 'gtag' initialization.\r\n */\r\nlet defaultConsentSettingsForInit;\r\n/**\r\n * Sets the variable {@link defaultConsentSettingsForInit} for use in the initialization of\r\n * analytics.\r\n *\r\n * @param consentSettings Maps the applicable end user consent state for gtag.js.\r\n */\r\nfunction _setConsentDefaultForInit(consentSettings) {\r\n    defaultConsentSettingsForInit = consentSettings;\r\n}\r\n/**\r\n * Sets the variable `defaultEventParametersForInit` for use in the initialization of\r\n * analytics.\r\n *\r\n * @param customParams Any custom params the user may pass to gtag.js.\r\n */\r\nfunction _setDefaultEventParametersForInit(customParams) {\r\n    defaultEventParametersForInit = customParams;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nasync function validateIndexedDB() {\r\n    if (!isIndexedDBAvailable()) {\r\n        logger.warn(ERROR_FACTORY.create(\"indexeddb-unavailable\" /* AnalyticsError.INDEXEDDB_UNAVAILABLE */, {\r\n            errorInfo: 'IndexedDB is not available in this environment.'\r\n        }).message);\r\n        return false;\r\n    }\r\n    else {\r\n        try {\r\n            await validateIndexedDBOpenable();\r\n        }\r\n        catch (e) {\r\n            logger.warn(ERROR_FACTORY.create(\"indexeddb-unavailable\" /* AnalyticsError.INDEXEDDB_UNAVAILABLE */, {\r\n                errorInfo: e === null || e === void 0 ? void 0 : e.toString()\r\n            }).message);\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * Initialize the analytics instance in gtag.js by calling config command with fid.\r\n *\r\n * NOTE: We combine analytics initialization and setting fid together because we want fid to be\r\n * part of the `page_view` event that's sent during the initialization\r\n * @param app Firebase app\r\n * @param gtagCore The gtag function that's not wrapped.\r\n * @param dynamicConfigPromisesList Array of all dynamic config promises.\r\n * @param measurementIdToAppId Maps measurementID to appID.\r\n * @param installations _FirebaseInstallationsInternal instance.\r\n *\r\n * @returns Measurement ID.\r\n */\r\nasync function _initializeAnalytics(app, dynamicConfigPromisesList, measurementIdToAppId, installations, gtagCore, dataLayerName, options) {\r\n    var _a;\r\n    const dynamicConfigPromise = fetchDynamicConfigWithRetry(app);\r\n    // Once fetched, map measurementIds to appId, for ease of lookup in wrapped gtag function.\r\n    dynamicConfigPromise\r\n        .then(config => {\r\n        measurementIdToAppId[config.measurementId] = config.appId;\r\n        if (app.options.measurementId &&\r\n            config.measurementId !== app.options.measurementId) {\r\n            logger.warn(`The measurement ID in the local Firebase config (${app.options.measurementId})` +\r\n                ` does not match the measurement ID fetched from the server (${config.measurementId}).` +\r\n                ` To ensure analytics events are always sent to the correct Analytics property,` +\r\n                ` update the` +\r\n                ` measurement ID field in the local config or remove it from the local config.`);\r\n        }\r\n    })\r\n        .catch(e => logger.error(e));\r\n    // Add to list to track state of all dynamic config promises.\r\n    dynamicConfigPromisesList.push(dynamicConfigPromise);\r\n    const fidPromise = validateIndexedDB().then(envIsValid => {\r\n        if (envIsValid) {\r\n            return installations.getId();\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    });\r\n    const [dynamicConfig, fid] = await Promise.all([\r\n        dynamicConfigPromise,\r\n        fidPromise\r\n    ]);\r\n    // Detect if user has already put the gtag <script> tag on this page with the passed in\r\n    // data layer name.\r\n    if (!findGtagScriptOnPage(dataLayerName)) {\r\n        insertScriptTag(dataLayerName, dynamicConfig.measurementId);\r\n    }\r\n    // Detects if there are consent settings that need to be configured.\r\n    if (defaultConsentSettingsForInit) {\r\n        gtagCore(\"consent\" /* GtagCommand.CONSENT */, 'default', defaultConsentSettingsForInit);\r\n        _setConsentDefaultForInit(undefined);\r\n    }\r\n    // This command initializes gtag.js and only needs to be called once for the entire web app,\r\n    // but since it is idempotent, we can call it multiple times.\r\n    // We keep it together with other initialization logic for better code structure.\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    gtagCore('js', new Date());\r\n    // User config added first. We don't want users to accidentally overwrite\r\n    // base Firebase config properties.\r\n    const configProperties = (_a = options === null || options === void 0 ? void 0 : options.config) !== null && _a !== void 0 ? _a : {};\r\n    // guard against developers accidentally setting properties with prefix `firebase_`\r\n    configProperties[ORIGIN_KEY] = 'firebase';\r\n    configProperties.update = true;\r\n    if (fid != null) {\r\n        configProperties[GA_FID_KEY] = fid;\r\n    }\r\n    // It should be the first config command called on this GA-ID\r\n    // Initialize this GA-ID and set FID on it using the gtag config API.\r\n    // Note: This will trigger a page_view event unless 'send_page_view' is set to false in\r\n    // `configProperties`.\r\n    gtagCore(\"config\" /* GtagCommand.CONFIG */, dynamicConfig.measurementId, configProperties);\r\n    // Detects if there is data that will be set on every event logged from the SDK.\r\n    if (defaultEventParametersForInit) {\r\n        gtagCore(\"set\" /* GtagCommand.SET */, defaultEventParametersForInit);\r\n        _setDefaultEventParametersForInit(undefined);\r\n    }\r\n    return dynamicConfig.measurementId;\r\n}\n\n/**\r\n * @license\r\n * Copyright 2019 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n/**\r\n * Analytics Service class.\r\n */\r\nclass AnalyticsService {\r\n    constructor(app) {\r\n        this.app = app;\r\n    }\r\n    _delete() {\r\n        delete initializationPromisesMap[this.app.options.appId];\r\n        return Promise.resolve();\r\n    }\r\n}\r\n/**\r\n * Maps appId to full initialization promise. Wrapped gtag calls must wait on\r\n * all or some of these, depending on the call's `send_to` param and the status\r\n * of the dynamic config fetches (see below).\r\n */\r\nlet initializationPromisesMap = {};\r\n/**\r\n * List of dynamic config fetch promises. In certain cases, wrapped gtag calls\r\n * wait on all these to be complete in order to determine if it can selectively\r\n * wait for only certain initialization (FID) promises or if it must wait for all.\r\n */\r\nlet dynamicConfigPromisesList = [];\r\n/**\r\n * Maps fetched measurementIds to appId. Populated when the app's dynamic config\r\n * fetch completes. If already populated, gtag config calls can use this to\r\n * selectively wait for only this app's initialization promise (FID) instead of all\r\n * initialization promises.\r\n */\r\nconst measurementIdToAppId = {};\r\n/**\r\n * Name for window global data layer array used by GA: defaults to 'dataLayer'.\r\n */\r\nlet dataLayerName = 'dataLayer';\r\n/**\r\n * Name for window global gtag function used by GA: defaults to 'gtag'.\r\n */\r\nlet gtagName = 'gtag';\r\n/**\r\n * Reproduction of standard gtag function or reference to existing\r\n * gtag function on window object.\r\n */\r\nlet gtagCoreFunction;\r\n/**\r\n * Wrapper around gtag function that ensures FID is sent with all\r\n * relevant event and config calls.\r\n */\r\nlet wrappedGtagFunction;\r\n/**\r\n * Flag to ensure page initialization steps (creation or wrapping of\r\n * dataLayer and gtag script) are only run once per page load.\r\n */\r\nlet globalInitDone = false;\r\n/**\r\n * Configures Firebase Analytics to use custom `gtag` or `dataLayer` names.\r\n * Intended to be used if `gtag.js` script has been installed on\r\n * this page independently of Firebase Analytics, and is using non-default\r\n * names for either the `gtag` function or for `dataLayer`.\r\n * Must be called before calling `getAnalytics()` or it won't\r\n * have any effect.\r\n *\r\n * @public\r\n *\r\n * @param options - Custom gtag and dataLayer names.\r\n */\r\nfunction settings(options) {\r\n    if (globalInitDone) {\r\n        throw ERROR_FACTORY.create(\"already-initialized\" /* AnalyticsError.ALREADY_INITIALIZED */);\r\n    }\r\n    if (options.dataLayerName) {\r\n        dataLayerName = options.dataLayerName;\r\n    }\r\n    if (options.gtagName) {\r\n        gtagName = options.gtagName;\r\n    }\r\n}\r\n/**\r\n * Returns true if no environment mismatch is found.\r\n * If environment mismatches are found, throws an INVALID_ANALYTICS_CONTEXT\r\n * error that also lists details for each mismatch found.\r\n */\r\nfunction warnOnBrowserContextMismatch() {\r\n    const mismatchedEnvMessages = [];\r\n    if (isBrowserExtension()) {\r\n        mismatchedEnvMessages.push('This is a browser extension environment.');\r\n    }\r\n    if (!areCookiesEnabled()) {\r\n        mismatchedEnvMessages.push('Cookies are not available.');\r\n    }\r\n    if (mismatchedEnvMessages.length > 0) {\r\n        const details = mismatchedEnvMessages\r\n            .map((message, index) => `(${index + 1}) ${message}`)\r\n            .join(' ');\r\n        const err = ERROR_FACTORY.create(\"invalid-analytics-context\" /* AnalyticsError.INVALID_ANALYTICS_CONTEXT */, {\r\n            errorInfo: details\r\n        });\r\n        logger.warn(err.message);\r\n    }\r\n}\r\n/**\r\n * Analytics instance factory.\r\n * @internal\r\n */\r\nfunction factory(app, installations, options) {\r\n    warnOnBrowserContextMismatch();\r\n    const appId = app.options.appId;\r\n    if (!appId) {\r\n        throw ERROR_FACTORY.create(\"no-app-id\" /* AnalyticsError.NO_APP_ID */);\r\n    }\r\n    if (!app.options.apiKey) {\r\n        if (app.options.measurementId) {\r\n            logger.warn(`The \"apiKey\" field is empty in the local Firebase config. This is needed to fetch the latest` +\r\n                ` measurement ID for this Firebase app. Falling back to the measurement ID ${app.options.measurementId}` +\r\n                ` provided in the \"measurementId\" field in the local Firebase config.`);\r\n        }\r\n        else {\r\n            throw ERROR_FACTORY.create(\"no-api-key\" /* AnalyticsError.NO_API_KEY */);\r\n        }\r\n    }\r\n    if (initializationPromisesMap[appId] != null) {\r\n        throw ERROR_FACTORY.create(\"already-exists\" /* AnalyticsError.ALREADY_EXISTS */, {\r\n            id: appId\r\n        });\r\n    }\r\n    if (!globalInitDone) {\r\n        // Steps here should only be done once per page: creation or wrapping\r\n        // of dataLayer and global gtag function.\r\n        getOrCreateDataLayer(dataLayerName);\r\n        const { wrappedGtag, gtagCore } = wrapOrCreateGtag(initializationPromisesMap, dynamicConfigPromisesList, measurementIdToAppId, dataLayerName, gtagName);\r\n        wrappedGtagFunction = wrappedGtag;\r\n        gtagCoreFunction = gtagCore;\r\n        globalInitDone = true;\r\n    }\r\n    // Async but non-blocking.\r\n    // This map reflects the completion state of all promises for each appId.\r\n    initializationPromisesMap[appId] = _initializeAnalytics(app, dynamicConfigPromisesList, measurementIdToAppId, installations, gtagCoreFunction, dataLayerName, options);\r\n    const analyticsInstance = new AnalyticsService(app);\r\n    return analyticsInstance;\r\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/**\r\n * Returns an {@link Analytics} instance for the given app.\r\n *\r\n * @public\r\n *\r\n * @param app - The {@link @firebase/app#FirebaseApp} to use.\r\n */\r\nfunction getAnalytics(app = getApp()) {\r\n    app = getModularInstance(app);\r\n    // Dependencies\r\n    const analyticsProvider = _getProvider(app, ANALYTICS_TYPE);\r\n    if (analyticsProvider.isInitialized()) {\r\n        return analyticsProvider.getImmediate();\r\n    }\r\n    return initializeAnalytics(app);\r\n}\r\n/**\r\n * Returns an {@link Analytics} instance for the given app.\r\n *\r\n * @public\r\n *\r\n * @param app - The {@link @firebase/app#FirebaseApp} to use.\r\n */\r\nfunction initializeAnalytics(app, options = {}) {\r\n    // Dependencies\r\n    const analyticsProvider = _getProvider(app, ANALYTICS_TYPE);\r\n    if (analyticsProvider.isInitialized()) {\r\n        const existingInstance = analyticsProvider.getImmediate();\r\n        if (deepEqual(options, analyticsProvider.getOptions())) {\r\n            return existingInstance;\r\n        }\r\n        else {\r\n            throw ERROR_FACTORY.create(\"already-initialized\" /* AnalyticsError.ALREADY_INITIALIZED */);\r\n        }\r\n    }\r\n    const analyticsInstance = analyticsProvider.initialize({ options });\r\n    return analyticsInstance;\r\n}\r\n/**\r\n * This is a public static method provided to users that wraps four different checks:\r\n *\r\n * 1. Check if it's not a browser extension environment.\r\n * 2. Check if cookies are enabled in current browser.\r\n * 3. Check if IndexedDB is supported by the browser environment.\r\n * 4. Check if the current browser context is valid for using `IndexedDB.open()`.\r\n *\r\n * @public\r\n *\r\n */\r\nasync function isSupported() {\r\n    if (isBrowserExtension()) {\r\n        return false;\r\n    }\r\n    if (!areCookiesEnabled()) {\r\n        return false;\r\n    }\r\n    if (!isIndexedDBAvailable()) {\r\n        return false;\r\n    }\r\n    try {\r\n        const isDBOpenable = await validateIndexedDBOpenable();\r\n        return isDBOpenable;\r\n    }\r\n    catch (error) {\r\n        return false;\r\n    }\r\n}\r\n/**\r\n * Use gtag `config` command to set `screen_name`.\r\n *\r\n * @public\r\n *\r\n * @deprecated Use {@link logEvent} with `eventName` as 'screen_view' and add relevant `eventParams`.\r\n * See {@link https://firebase.google.com/docs/analytics/screenviews | Track Screenviews}.\r\n *\r\n * @param analyticsInstance - The {@link Analytics} instance.\r\n * @param screenName - Screen name to set.\r\n */\r\nfunction setCurrentScreen(analyticsInstance, screenName, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setCurrentScreen$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], screenName, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Retrieves a unique Google Analytics identifier for the web client.\r\n * See {@link https://developers.google.com/analytics/devguides/collection/ga4/reference/config#client_id | client_id}.\r\n *\r\n * @public\r\n *\r\n * @param app - The {@link @firebase/app#FirebaseApp} to use.\r\n */\r\nasync function getGoogleAnalyticsClientId(analyticsInstance) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    return internalGetGoogleAnalyticsClientId(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId]);\r\n}\r\n/**\r\n * Use gtag `config` command to set `user_id`.\r\n *\r\n * @public\r\n *\r\n * @param analyticsInstance - The {@link Analytics} instance.\r\n * @param id - User ID to set.\r\n */\r\nfunction setUserId(analyticsInstance, id, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setUserId$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], id, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Use gtag `config` command to set all params specified.\r\n *\r\n * @public\r\n */\r\nfunction setUserProperties(analyticsInstance, properties, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setUserProperties$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], properties, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Sets whether Google Analytics collection is enabled for this app on this device.\r\n * Sets global `window['ga-disable-analyticsId'] = true;`\r\n *\r\n * @public\r\n *\r\n * @param analyticsInstance - The {@link Analytics} instance.\r\n * @param enabled - If true, enables collection, if false, disables it.\r\n */\r\nfunction setAnalyticsCollectionEnabled(analyticsInstance, enabled) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    setAnalyticsCollectionEnabled$1(initializationPromisesMap[analyticsInstance.app.options.appId], enabled).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Adds data that will be set on every event logged from the SDK, including automatic ones.\r\n * With gtag's \"set\" command, the values passed persist on the current page and are passed with\r\n * all subsequent events.\r\n * @public\r\n * @param customParams - Any custom params the user may pass to gtag.js.\r\n */\r\nfunction setDefaultEventParameters(customParams) {\r\n    // Check if reference to existing gtag function on window object exists\r\n    if (wrappedGtagFunction) {\r\n        wrappedGtagFunction(\"set\" /* GtagCommand.SET */, customParams);\r\n    }\r\n    else {\r\n        _setDefaultEventParametersForInit(customParams);\r\n    }\r\n}\r\n/**\r\n * Sends a Google Analytics event with given `eventParams`. This method\r\n * automatically associates this logged event with this Firebase web\r\n * app instance on this device.\r\n * List of official event parameters can be found in the gtag.js\r\n * reference documentation:\r\n * {@link https://developers.google.com/gtagjs/reference/ga4-events\r\n * | the GA4 reference documentation}.\r\n *\r\n * @public\r\n */\r\nfunction logEvent(analyticsInstance, eventName, eventParams, options) {\r\n    analyticsInstance = getModularInstance(analyticsInstance);\r\n    logEvent$1(wrappedGtagFunction, initializationPromisesMap[analyticsInstance.app.options.appId], eventName, eventParams, options).catch(e => logger.error(e));\r\n}\r\n/**\r\n * Sets the applicable end user consent state for this web app across all gtag references once\r\n * Firebase Analytics is initialized.\r\n *\r\n * Use the {@link ConsentSettings} to specify individual consent type values. By default consent\r\n * types are set to \"granted\".\r\n * @public\r\n * @param consentSettings - Maps the applicable end user consent state for gtag.js.\r\n */\r\nfunction setConsent(consentSettings) {\r\n    // Check if reference to existing gtag function on window object exists\r\n    if (wrappedGtagFunction) {\r\n        wrappedGtagFunction(\"consent\" /* GtagCommand.CONSENT */, 'update', consentSettings);\r\n    }\r\n    else {\r\n        _setConsentDefaultForInit(consentSettings);\r\n    }\r\n}\n\nconst name = \"@firebase/analytics\";\nconst version = \"0.10.0\";\n\n/**\r\n * Firebase Analytics\r\n *\r\n * @packageDocumentation\r\n */\r\nfunction registerAnalytics() {\r\n    _registerComponent(new Component(ANALYTICS_TYPE, (container, { options: analyticsOptions }) => {\r\n        // getImmediate for FirebaseApp will always succeed\r\n        const app = container.getProvider('app').getImmediate();\r\n        const installations = container\r\n            .getProvider('installations-internal')\r\n            .getImmediate();\r\n        return factory(app, installations, analyticsOptions);\r\n    }, \"PUBLIC\" /* ComponentType.PUBLIC */));\r\n    _registerComponent(new Component('analytics-internal', internalFactory, \"PRIVATE\" /* ComponentType.PRIVATE */));\r\n    registerVersion(name, version);\r\n    // BUILD_TARGET will be replaced by values like esm5, esm2017, cjs5, etc during the compilation\r\n    registerVersion(name, version, 'esm2017');\r\n    function internalFactory(container) {\r\n        try {\r\n            const analytics = container.getProvider(ANALYTICS_TYPE).getImmediate();\r\n            return {\r\n                logEvent: (eventName, eventParams, options) => logEvent(analytics, eventName, eventParams, options)\r\n            };\r\n        }\r\n        catch (e) {\r\n            throw ERROR_FACTORY.create(\"interop-component-reg-failed\" /* AnalyticsError.INTEROP_COMPONENT_REG_FAILED */, {\r\n                reason: e\r\n            });\r\n        }\r\n    }\r\n}\r\nregisterAnalytics();\n\nexport { getAnalytics, getGoogleAnalyticsClientId, initializeAnalytics, isSupported, logEvent, setAnalyticsCollectionEnabled, setConsent, setCurrentScreen, setDefaultEventParameters, setUserId, setUserProperties, settings };\n//# sourceMappingURL=index.esm2017.js.map\n","import Deck, { VERSION } from './reveal.js'\n// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\nconst firebaseConfig = {\n  apiKey: \"AIzaSyA0KvJny_cIQJzwMYObPwy-8kfXkib0I6A\",\n  authDomain: \"uno-ai-presentation.firebaseapp.com\",\n  projectId: \"uno-ai-presentation\",\n  storageBucket: \"uno-ai-presentation.appspot.com\",\n  messagingSenderId: \"1083706179645\",\n  appId: \"1:1083706179645:web:ebf31932c812030a1b2a54\",\n  measurementId: \"G-LWMP8JX4B5\"\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst analytics = getAnalytics(app);\n/**\n * Expose the Reveal class to the window. To create a\n * new instance:\n * let deck = new Reveal( document.querySelector( '.reveal' ), {\n *   controls: false\n * } );\n * deck.initialize().then(() => {\n *   // reveal.js is ready\n * });\n */\nlet Reveal = Deck;\n\n\n/**\n * The below is a thin shell that mimics the pre 4.0\n * reveal.js API and ensures backwards compatibility.\n * This API only allows for one Reveal instance per\n * page, whereas the new API above lets you run many\n * presentations on the same page.\n *\n * Reveal.initialize( { controls: false } ).then(() => {\n *   // reveal.js is ready\n * });\n */\n\nlet enqueuedAPICalls = [];\n\nReveal.initialize = options => {\n\n\t// Create our singleton reveal.js instance\n\tObject.assign( Reveal, new Deck( document.querySelector( '.reveal' ), options ) );\n\n\t// Invoke any enqueued API calls\n\tenqueuedAPICalls.map( method => method( Reveal ) );\n\n\treturn Reveal.initialize();\n\n}\n\n/**\n * The pre 4.0 API let you add event listener before\n * initializing. We maintain the same behavior by\n * queuing up premature API calls and invoking all\n * of them when Reveal.initialize is called.\n */\n[ 'configure', 'on', 'off', 'addEventListener', 'removeEventListener', 'registerPlugin' ].forEach( method => {\n\tReveal[method] = ( ...args ) => {\n\t\tenqueuedAPICalls.push( deck => deck[method].call( null, ...args ) );\n\t}\n} );\n\nReveal.isReady = () => false;\n\nReveal.VERSION = VERSION;\n\nexport default Reveal;"],"names":["extend","a","b","i","queryAll","el","selector","Array","from","querySelectorAll","toggleClass","className","value","classList","add","remove","deserialize","match","parseFloat","transformElement","element","transform","style","matches","target","matchesMethod","matchesSelector","msMatchesSelector","call","closest","parentNode","createSingletonNode","container","tagname","classname","innerHTML","nodes","length","testNode","node","document","createElement","appendChild","createStyleSheet","tag","type","styleSheet","cssText","createTextNode","head","getQueryHash","query","location","search","replace","split","shift","pop","unescape","getRemainingHeight","height","newHeight","oldHeight","offsetHeight","removeProperty","fileExtensionToMimeMap","mp4","m4a","ogv","mpeg","webm","UA","navigator","userAgent","isMobile","test","platform","maxTouchPoints","isAndroid","Object","defineProperty","fitty_module","_extends","assign","arguments","source","key","prototype","hasOwnProperty","_default","default","w","toArray","nl","slice","DrawState","fitties","redrawFrame","requestRedraw","cancelAnimationFrame","requestAnimationFrame","redraw","filter","f","dirty","active","redrawAll","forEach","styleComputed","computeStyle","shouldPreStyle","applyStyle","fittiesToRedraw","shouldRedraw","calculateStyles","markAsClean","dispatchFitEvent","availableWidth","clientWidth","currentWidth","scrollWidth","previousFontSize","currentFontSize","Math","min","max","minSize","maxSize","whiteSpace","multiLine","getComputedStyle","getPropertyValue","display","preStyle","preStyleTestCompleted","fontSize","dispatchEvent","CustomEvent","detail","oldValue","newValue","scaleFactor","fit","destroy","_","observeMutations","observer","disconnect","originalStyle","subscribe","unsubscribe","MutationObserver","observe","defaultOptions","subtree","childList","characterData","resizeDebounce","onWindowResized","clearTimeout","setTimeout","fitty","observeWindowDelay","events","set","enabled","method","e","observeWindow","fitAll","fittyCreate","elements","options","fittyOptions","publicFitties","map","newbie","push","init","unfreeze","freeze","undefined","window","SlideContent","constructor","Reveal","startEmbeddedIframe","this","bind","shouldPreload","preload","getConfig","preloadIframes","hasAttribute","load","slide","tagName","setAttribute","getAttribute","removeAttribute","media","sources","background","slideBackgroundElement","backgroundContent","slideBackgroundContentElement","backgroundIframe","backgroundImage","backgroundVideo","backgroundVideoLoop","backgroundVideoMuted","trim","url","encodeURI","c","charCodeAt","toString","toUpperCase","encodeRFC3986URI","decodeURI","join","isSpeakerNotes","video","muted","filename","getMimeTypeFromFile","excludeIframes","iframe","width","maxHeight","maxWidth","backgroundIframeElement","querySelector","layout","scopeElement","unload","getSlideBackground","formatEmbeddedContent","_appendParamToIframeSource","sourceAttribute","sourceURL","param","getSlidesElement","src","indexOf","startEmbeddedContent","autoplay","autoPlayMedia","play","readyState","startEmbeddedMedia","promise","catch","controls","addEventListener","removeEventListener","event","isAttachedToDOM","isVisible","currentTime","contentWindow","postMessage","stopEmbeddedContent","unloadIframes","pause","SlideNumber","render","getRevealElement","configure","config","oldConfig","slideNumberDisplay","slideNumber","isPrintingPDF","showSlideNumber","update","getSlideNumber","getCurrentSlide","format","getHorizontalSlides","horizontalOffset","dataset","visibility","getSlidePastCount","getTotalSlides","indices","getIndices","h","sep","isVerticalSlide","v","getHash","formatNumber","delimiter","isNaN","JumpToSlide","onInput","onBlur","onKeyDown","jumpInput","placeholder","show","indicesOnShow","focus","hide","jumpTimeout","jump","getIndicesFromHash","oneBasedIndex","jumpAfter","delay","regex","RegExp","getSlides","find","innerText","cancel","confirm","keyCode","stopImmediatePropagation","colorToRgb","color","hex3","r","parseInt","charAt","g","hex6","rgb","rgba","Backgrounds","create","slideh","backgroundStack","createBackground","slidev","parallaxBackgroundImage","backgroundSize","parallaxBackgroundSize","backgroundRepeat","parallaxBackgroundRepeat","backgroundPosition","parallaxBackgroundPosition","contentElement","sync","data","backgroundColor","backgroundGradient","backgroundTransition","backgroundOpacity","dataPreload","opacity","contrastColor","computedBackgroundStyle","includeAll","currentSlide","currentBackground","horizontalPast","rtl","horizontalFuture","childNodes","backgroundh","backgroundv","previousBackground","slideContent","currentBackgroundContent","backgroundImageURL","previousBackgroundHash","currentBackgroundHash","classToBubble","contains","updateParallax","backgroundWidth","backgroundHeight","horizontalSlides","verticalSlides","getVerticalSlides","horizontalOffsetMultiplier","slideWidth","offsetWidth","horizontalSlideCount","parallaxBackgroundHorizontal","verticalOffsetMultiplier","verticalOffset","slideHeight","verticalSlideCount","parallaxBackgroundVertical","SLIDES_SELECTOR","HORIZONTAL_SLIDES_SELECTOR","VERTICAL_SLIDES_SELECTOR","POST_MESSAGE_METHOD_BLACKLIST","FRAGMENT_STYLE_REGEX","autoAnimateCounter","AutoAnimate","run","fromSlide","toSlide","reset","allSlides","toSlideIndex","fromSlideIndex","autoAnimateStyleSheet","animationOptions","getAutoAnimateOptions","autoAnimate","slideDirection","fromSlideIsHidden","css","getAutoAnimatableElements","autoAnimateElements","to","autoAnimateUnmatched","defaultUnmatchedDuration","duration","defaultUnmatchedDelay","getUnmatchedAutoAnimateElements","unmatchedElement","unmatchedOptions","id","autoAnimateTarget","fontWeight","sheet","removeChild","elementOptions","easing","fromProps","getAutoAnimatableProperties","toProps","styles","translate","scale","presentationScale","getScale","delta","x","y","scaleX","scaleY","round","propertyName","toValue","fromValue","explicitValue","toStyleProperties","keys","inheritedOptions","autoAnimateEasing","autoAnimateDuration","autoAnimatedParent","autoAnimateDelay","direction","properties","bounds","measure","center","getBoundingClientRect","offsetLeft","offsetTop","computedStyles","autoAnimateStyles","property","matcher","pairs","autoAnimateMatcher","getAutoAnimatePairs","reserved","pair","index","codeNodes","textNodes","findAutoAnimateMatches","nodeName","textContent","getLocalBoundingBox","fromScope","toScope","serializer","fromMatches","toMatches","fromElement","primaryIndex","secondaryIndex","rootElement","children","reduce","result","containsAnimatedElements","concat","Fragments","fragments","disable","enable","availableRoutes","hiddenFragments","prev","next","sort","grouped","ordered","unordered","sorted","fragment","group","sortAll","horizontalSlide","verticalSlide","changedFragments","shown","hidden","maxIndex","currentFragment","wasVisible","announceStatus","getStatusText","bubbles","goto","offset","lastVisibleFragment","progress","fragmentInURL","writeURL","Overview","onSlideClicked","activate","overview","isActive","cancelAutoSlide","getBackgroundsElement","margin","slideSize","getComputedSlideSize","overviewSlideWidth","overviewSlideHeight","updateSlidesVisibility","hslide","vslide","hbackground","vbackground","vmin","innerWidth","innerHeight","transformSlides","deactivate","cueAutoSlide","toggle","override","preventDefault","Keyboard","shortcuts","bindings","onDocumentKeyDown","onDocumentKeyPress","navigationMode","unbind","addKeyBinding","binding","callback","description","removeKeyBinding","triggerKey","registerKeyboardShortcut","getShortcuts","getBindings","shiftKey","charCode","toggleHelp","keyboardCondition","isFocused","autoSlideWasPaused","isAutoSliding","onUserInput","activeElementIsCE","activeElement","isContentEditable","activeElementIsInput","activeElementIsNotes","unusedModifier","altKey","ctrlKey","metaKey","resumeKeyCodes","keyboard","isPaused","useLinearMode","hasHorizontalSlides","hasVerticalSlides","triggered","apply","action","skipFragments","left","right","up","Number","MAX_VALUE","down","togglePause","requestMethod","documentElement","requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","enterFullscreen","embedded","getViewportElement","autoSlideStoppable","toggleAutoSlide","jumpToSlide","toggleJumpToSlide","closeOverlay","Location","writeURLTimeout","replaceStateTimestamp","onWindowHashChange","hash","name","bits","hashIndexBase","hashOneBasedIndex","getElementById","decodeURIComponent","error","readURL","currentIndices","newIndices","history","debouncedReplaceState","pathname","replaceState","Date","now","replaceStateTimeout","MAX_REPLACE_STATE_FREQUENCY","s","encodeURIComponent","Controls","onNavigateLeftClicked","onNavigateRightClicked","onNavigateUpClicked","onNavigateDownClicked","onNavigatePrevClicked","onNavigateNextClicked","revealElement","controlsLeft","controlsRight","controlsUp","controlsDown","controlsPrev","controlsNext","controlsRightArrow","controlsLeftArrow","controlsDownArrow","controlsLayout","controlsBackArrows","pointerEvents","eventName","routes","fragmentsRoutes","controlsTutorial","hasNavigatedVertically","hasNavigatedHorizontally","Progress","onProgressClicked","bar","getProgress","getMaxWidth","slides","slidesTotal","slideIndex","floor","clientX","targetIndices","Pointer","lastMouseWheelStep","cursorHidden","cursorInactiveTimeout","onDocumentCursorActive","onDocumentMouseScroll","mouseWheel","hideInactiveCursor","showCursor","cursor","hideCursor","hideCursorTime","wheelDelta","loadScript","script","async","defer","onload","onreadystatechange","onerror","err","Error","insertBefore","lastChild","Plugins","reveal","state","registeredPlugins","asyncDependencies","plugins","dependencies","registerPlugin","Promise","resolve","scripts","scriptsToLoad","condition","scriptLoadedCallback","initPlugins","then","console","warn","pluginValues","values","pluginsToInitialize","loadAsync","initNextPlugin","afterPlugInitialized","plugin","hasPlugin","getPlugin","getRegisteredPlugins","Print","injectPageNumbers","pageWidth","pageHeight","body","viewportElement","presentationBackground","viewportStyles","layoutSlideContents","slideScrollHeights","scrollHeight","pages","pageContainer","top","contentHeight","numberOfPages","ceil","pdfMaxPagesPerSlide","page","pdfPageHeightOffset","showNotes","notes","getSlideNotes","notesSpacing","notesLayout","notesElement","bottom","numberElement","pdfSeparateFragments","fragmentGroups","previousFragmentStep","clonedPage","cloneNode","fragmentNumber","Touch","touchStartX","touchStartY","touchStartCount","touchCaptured","onPointerDown","onPointerMove","onPointerUp","onTouchStart","onTouchMove","onTouchEnd","msPointerEnabled","isSwipePrevented","touches","clientY","currentX","currentY","includeFragments","deltaX","deltaY","abs","pointerType","MSPOINTER_TYPE_TOUCH","STATE_FOCUS","STATE_BLUR","Focus","onRevealPointerDown","onDocumentPointerDown","blur","Notes","print","updateVisibility","hasNotes","isSpeakerNotesWindow","notesElements","Playback","progressCheck","diameter","diameter2","thickness","playing","progressOffset","canvas","context","getContext","setPlaying","wasPlaying","animate","progressBefore","radius","iconSize","endAngle","PI","startAngle","save","clearRect","beginPath","arc","fillStyle","fill","lineWidth","strokeStyle","stroke","fillRect","moveTo","lineTo","restore","on","listener","off","defaultConfig","minScale","maxScale","respondToHashChanges","disableLayout","touch","loop","shuffle","help","showHiddenSlides","autoSlide","autoSlideMethod","defaultTiming","previewLinks","postMessageEvents","focusBodyOnPageVisibilityChange","transition","transitionSpeed","POSITIVE_INFINITY","viewDistance","mobileViewDistance","sortFragmentsOnSync","VERSION","Deck","indexh","indexv","previousSlide","autoSlidePlayer","ready","navigationHistory","slidesTransform","dom","autoSlideTimeout","autoSlideStartTime","autoSlidePaused","backgrounds","pointer","initialize","initOptions","wrapper","Util","setViewport","start","viewport","removeHiddenSlides","setupDOM","setupPostMessage","setupScrollPrevention","setupFullscreen","resetVerticalSlides","removeEventListeners","setupPDF","Device","pauseOverlay","statusElement","createStatusElement","position","overflow","clip","text","nodeType","isAriaHidden","isDisplayHidden","child","setInterval","scrollTop","scrollLeft","onFullscreenChange","onPostMessage","isReady","numberOfSlides","setProperty","resume","enablePreviewLinks","disablePreviewLinks","onAutoSlidePlayerClick","addEventListeners","onWindowResize","onSlidesClicked","onTransitionEnd","onPageVisibilityChange","useCapture","transforms","createEvent","initEvent","dispatchPostMessage","parent","self","message","namespace","getState","JSON","stringify","onPreviewLinkClicked","showPreview","overlay","showHelp","html","size","oldScale","presentationWidth","presentationHeight","zoom","len","remainingHeight","nw","naturalWidth","videoWidth","nh","naturalHeight","videoHeight","es","setPreviousVerticalIndex","stack","getPreviousVerticalIndex","attributeName","isLastVerticalSlide","nextElementSibling","isFirstSlide","isLastSlide","wasPaused","resumeAutoSlide","pauseAutoSlide","origin","defaultPrevented","stateBefore","indexhBefore","indexvBefore","updateSlides","slideChanged","currentHorizontalSlide","currentVerticalSlides","autoAnimateTransition","getVerticalStacks","stateLoop","j","splice","syncSlide","beforeSlide","random","slidesLength","printMode","loopedForwards","loopedBackwards","reverse","showFragmentsIn","hideFragmentsIn","wasPresent","slideState","distanceX","distanceY","horizontalSlidesLength","verticalSlidesLength","oy","fragmentRoutes","pastCount","mainLoop","totalCount","allFragments","visibleFragments","fragmentWeight","isVertical","getSlidesAttributes","attributes","attribute","getSlide","indexf","paused","setState","pausedFlag","overviewFlag","fragmentAutoSlide","parentAutoSlide","slideAutoSlide","playbackRate","navigateNext","navigateLeft","navigateRight","navigateUp","navigateDown","navigatePrev","parse","args","anchor","fullscreenElement","webkitFullscreenElement","currentTarget","API","syncFragments","navigateFragment","prevFragment","nextFragment","availableFragments","toggleOverview","isOverview","loadSlide","unloadSlide","hidePreview","getPreviousSlide","getSlidePath","getPlugins","stringToByteArray$1","str","out","p","base64","byteToCharMap_","charToByteMap_","byteToCharMapWebSafe_","charToByteMapWebSafe_","ENCODED_VALS_BASE","ENCODED_VALS","ENCODED_VALS_WEBSAFE","HAS_NATIVE_SUPPORT","atob","encodeByteArray","input","webSafe","isArray","init_","byteToCharMap","output","byte1","haveByte2","byte2","haveByte3","byte3","outByte1","outByte2","outByte3","outByte4","encodeString","btoa","decodeString","bytes","pos","c1","String","fromCharCode","c2","u","c3","byteArrayToString","decodeStringToByteArray","charToByteMap","byte4","DecodeBase64StringError","super","base64urlEncodeWithoutPadding","utf8Bytes","base64Encode","getDefaultsFromGlobal","global","getGlobal","__FIREBASE_DEFAULTS__","getDefaultsFromCookie","cookie","decoded","base64Decode","getDefaults","process","env","defaultsJsonString","getDefaultsFromEnvVariable","info","getDefaultAppConfig","_a","Deferred","reject","wrapCallback","isIndexedDBAvailable","indexedDB","validateIndexedDBOpenable","preExist","DB_CHECK_NAME","request","open","onsuccess","close","deleteDatabase","onupgradeneeded","FirebaseError","code","customData","setPrototypeOf","captureStackTrace","ErrorFactory","service","serviceName","errors","fullCode","template","PATTERN","replaceTemplate","fullMessage","deepEqual","aKeys","bKeys","k","includes","aProp","bProp","isObject","thing","calculateBackoffMillis","backoffCount","intervalMillis","backoffFactor","currBaseValue","pow","randomWait","getModularInstance","_delegate","Component","instanceFactory","multipleInstances","serviceProps","instantiationMode","onInstanceCreated","setInstantiationMode","mode","setMultipleInstances","setServiceProps","props","setInstanceCreatedCallback","DEFAULT_ENTRY_NAME","Provider","component","instances","Map","instancesDeferred","instancesOptions","onInitCallbacks","get","identifier","normalizedIdentifier","normalizeInstanceIdentifier","has","deferred","isInitialized","shouldAutoInitialize","instance","getOrInitializeService","instanceIdentifier","getImmediate","optional","getComponent","setComponent","isComponentEager","instanceDeferred","entries","clearInstance","delete","services","all","INTERNAL","_delete","isComponentSet","getOptions","opts","onInit","existingCallbacks","Set","existingInstance","invokeOnInitCallbacks","callbacks","ComponentContainer","providers","addComponent","provider","getProvider","addOrOverwriteComponent","getProviders","LogLevel","levelStringToEnum","debug","DEBUG","verbose","VERBOSE","INFO","WARN","ERROR","silent","SILENT","defaultLogLevel","ConsoleMethod","defaultLogHandler","logType","logLevel","toISOString","Logger","_logLevel","_logHandler","_userLogHandler","val","TypeError","setLogLevel","logHandler","userLogHandler","log","idbProxyableTypes","cursorAdvanceMethods","cursorRequestMap","WeakMap","transactionDoneMap","transactionStoreNamesMap","transformCache","reverseTransformCache","idbProxyTraps","prop","receiver","IDBTransaction","objectStoreNames","objectStore","wrap","wrapFunction","func","IDBDatabase","transaction","IDBCursor","advance","continue","continuePrimaryKey","unwrap","storeNames","tx","transformCachableValue","done","unlisten","complete","DOMException","cacheDonePromiseForTransaction","object","IDBObjectStore","IDBIndex","some","Proxy","IDBRequest","success","promisifyRequest","readMethods","writeMethods","cachedMethods","getMethod","targetFuncName","useIndex","isWrite","storeName","store","oldTraps","PlatformLoggerServiceImpl","getPlatformInfoString","isVersionServiceProvider","library","version","logString","name$o","version$1","logger","PLATFORM_LOG_STRING","firebase","_apps","_components","_addComponent","app","_registerComponent","componentName","_getProvider","heartbeatController","triggerHeartbeat","ERROR_FACTORY","FirebaseAppImpl","_isDeleted","_options","_config","_name","_automaticDataCollectionEnabled","automaticDataCollectionEnabled","_container","checkDestroyed","isDeleted","appName","initializeApp","rawConfig","existingApp","newApp","registerVersion","libraryKeyOrName","variant","libraryMismatch","versionMismatch","warning","STORE_NAME","dbPromise","getDbPromise","blocked","upgrade","blocking","terminated","openPromise","oldVersion","newVersion","db","openDB","createObjectStore","originalErrorMessage","writeHeartbeatsToIndexedDB","heartbeatObject","put","computeKey","idbGetError","appId","HeartbeatServiceImpl","_heartbeatsCache","_storage","HeartbeatStorageImpl","_heartbeatsCachePromise","read","agent","date","getUTCDateString","lastSentHeartbeatDate","heartbeats","singleDateHeartbeat","hbTimestamp","valueOf","overwrite","heartbeatsToSend","unsentEntries","heartbeatsCache","heartbeatEntry","hb","dates","countBytes","extractHeartbeatsForHeader","headerString","substring","_canUseIndexedDBPromise","runIndexedDBEnvironmentCheck","idbHeartbeatObject","readHeartbeatsFromIndexedDB","heartbeatsObject","existingHeartbeatsObject","replaceTraps","PENDING_TIMEOUT_MS","PACKAGE_VERSION","INTERNAL_AUTH_VERSION","TOKEN_EXPIRATION_BUFFER","isServerError","getInstallationsEndpoint","projectId","extractAuthTokenInfoFromResponse","response","token","requestStatus","expiresIn","responseExpiresIn","creationTime","getErrorFromResponse","requestName","errorData","json","serverCode","serverMessage","serverStatus","status","getHeaders","apiKey","Headers","Accept","getHeadersWithAuth","appConfig","refreshToken","headers","append","getAuthorizationHeader","retryIfServerError","fn","sleep","ms","VALID_FID_PATTERN","generateFid","fidByteArray","Uint8Array","crypto","msCrypto","getRandomValues","fid","b64String","array","substr","encode","getKey","fidChangeCallbacks","fidChanged","callFidChangeCallbacks","channel","broadcastChannel","BroadcastChannel","onmessage","getBroadcastChannel","broadcastFidChange","OBJECT_STORE_NAME","updateFn","getInstallationEntry","installations","registrationPromise","installationEntry","oldEntry","entry","registrationStatus","clearTimedOutRequest","updateOrCreateInstallationEntry","entryWithPromise","onLine","inProgressEntry","registrationTime","registeredInstallationEntry","heartbeatServiceProvider","endpoint","heartbeatService","heartbeatsHeader","getHeartbeatsHeader","authVersion","sdkVersion","fetch","ok","responseValue","authToken","createInstallationRequest","registerInstallation","waitUntilFidRegistration","triggerRegistrationIfNecessary","updateInstallationRequest","generateAuthTokenRequest","getGenerateAuthTokenEndpoint","installation","refreshAuthToken","forceRefresh","tokenPromise","isEntryRegistered","oldAuthToken","isAuthTokenExpired","isAuthTokenValid","updateAuthTokenRequest","waitUntilAuthTokenRequest","inProgressAuthToken","requestTime","makeAuthTokenRequestInProgressEntry","updatedInstallationEntry","fetchAuthTokenFromServer","getToken","installationsImpl","completeInstallationRegistration","getMissingValueError","valueName","INSTALLATIONS_NAME","publicFactory","configKeys","keyName","extractAppConfig","internalFactory","getId","ANALYTICS_TYPE","GTAG_URL","createGtagTrustedTypesScriptURL","startsWith","gtagURL","promiseAllSettled","promises","insertScriptTag","dataLayerName","measurementId","trustedTypesPolicy","policyName","policyOptions","trustedTypes","createPolicy","createTrustedTypesPolicy","createScriptURL","gtagScriptURL","wrapGtag","gtagCore","initializationPromisesMap","dynamicConfigPromisesList","measurementIdToAppId","command","gtagParams","initializationPromisesToWaitFor","gaSendToList","dynamicConfigResults","sendToId","foundConfig","initializationPromise","gtagOnEvent","correspondingAppId","gtagOnConfig","fieldName","customParams","defaultRetryData","throttleMetadata","getThrottleMetadata","setThrottleMetadata","metadata","deleteThrottleMetadata","fetchDynamicConfigWithRetry","retryData","timeoutMillis","throttleEndTimeMillis","signal","AnalyticsAbortSignal","abort","attemptFetchDynamicConfigWithRetry","appFields","backoffMillis","timeout","setAbortableTimeout","appUrl","errorMessage","jsonResponse","_ignored","httpStatus","responseMessage","fetchDynamicConfig","isRetriableError","listeners","_initializeAnalytics","dynamicConfigPromise","fidPromise","errorInfo","validateIndexedDB","envIsValid","dynamicConfig","scriptTags","getElementsByTagName","findGtagScriptOnPage","configProperties","AnalyticsService","gtagCoreFunction","wrappedGtagFunction","globalInitDone","warnOnBrowserContextMismatch","mismatchedEnvMessages","runtime","chrome","browser","isBrowserExtension","cookieEnabled","details","factory","dataLayer","getOrCreateDataLayer","wrappedGtag","gtagFunctionName","_args","wrapOrCreateGtag","logEvent","analyticsInstance","eventParams","gtagFunction","send_to","logEvent$1","analyticsOptions","analytics","reason","getApp","analyticsProvider","initializeAnalytics","getAnalytics","authDomain","storageBucket","messagingSenderId","enqueuedAPICalls","deck"],"mappings":"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"}